!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="1effb564-6ac8-4574-9b4a-edc7ba212045",e._sentryDebugIdIdentifier="sentry-dbid-1effb564-6ac8-4574-9b4a-edc7ba212045")}catch(e){}}();"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2853],{34415:function(e,t,s){s.d(t,{C:function(){return c},L:function(){return d}});var n=s(2899),i=s(34116),r=s(72242),a=s(4694),l=s(70702),o=s(725);function c(e){let{children:t}=e,{t:s}=(0,l.$G)("chat");return(0,n.jsx)("div",{className:(0,r.cn)("relative group flex flex-col justify-center w-full pb-2 lg:max-w-4/5 message-row","items-start"),children:(0,n.jsxs)("div",{className:"w-full",children:[(0,n.jsx)("p",{className:"text-center text-lg font-bold mb-2",children:s("Which response do you prefer?","Which response do you prefer?")}),(0,n.jsx)("p",{className:"text-center mb-4",children:s("This will help make Grok better.","This will help make Grok better.")}),(0,n.jsx)("div",{className:"flex justify-center ",children:t})]})})}function d(e){let{index:t,response:s,isStreaming:c,onClickPrefer:d}=e,{t:u}=(0,l.$G)("chat"),p=(0,a.useCallback)(()=>{d(t,s)},[d]);return(0,n.jsxs)("div",{className:(0,r.cn)("w-1/2 max-w-3xl flex flex-col shrink-0 grow-0 gap-2 justify-between px-6","border-r border-toggle-border last:border-r-0"),children:[(0,n.jsxs)("p",{className:"font-bold text-primary text-sm",children:[u("Response","Response"),t+1]}),(0,n.jsx)("div",{className:(0,r.cn)("flex-1","prose dark:prose-invert","w-full max-w-none","text-sm"),children:(0,n.jsx)(o.i,{response:s,isStreaming:c,showMarkdown:!0})}),(0,n.jsx)(i.zx,{variant:"card",size:"lg",onClick:p,children:u("Prefer this response","Prefer this response")})]},t)}},19903:function(e,t,s){s.d(t,{BO:function(){return l},L2:function(){return c},L5:function(){return u},MH:function(){return h},VD:function(){return f},aX:function(){return i},hz:function(){return p},qy:function(){return a}});var n=s(4694);let i=e=>{let{iframeRef:t}=e,[s,i]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{let e=()=>i(!0);return t.current&&t.current.addEventListener("load",()=>i(!0)),()=>{var s;null===(s=t.current)||void 0===s||s.removeEventListener("load",e)}},[t.current]),{isIframeReady:s,injectHTML:(0,n.useCallback)(e=>{var s;(null===(s=t.current)||void 0===s?void 0:s.contentWindow)&&t.current.contentWindow.postMessage({type:"html",html:e},"https://artifacts.grokusercontent.com")},[])}},r=["text/x-python","text/python"];function a(e){var t;return r.includes(null!==(t=e.contentType)&&void 0!==t?t:"")}function l(e){var t;return a(e)&&(null===(t=e.content)||void 0===t?void 0:t.includes("import pygame"))}let o=["text/cpp","text/c","text/x-c++src","text/javascript","text/typescript","text/bash",...r];function c(e){var t;return!l(e)&&o.includes(null!==(t=e.contentType)&&void 0!==t?t:"")}let d=["text/html"];function u(e){return d.includes(m(e))}function p(e){var t;let s=m(e);return null!==(t=s.split("/")[1])&&void 0!==t?t:s}function m(e){var t,s;return null!==(s=null===(t=e.contentType)||void 0===t?void 0:t.split(";")[0])&&void 0!==s?s:""}let x=["text/plain","text/markdown","text/html"];function h(e){return x.includes(m(e))}function f(e){var t,s;return null!==(s=null===(t=e.contentType)||void 0===t?void 0:t.includes("report"))&&void 0!==s&&s}},50121:function(e,t,s){s.d(t,{i:function(){return u}});var n=s(2899),i=s(34116),r=s(72242),a=s(65671),l=s(13562),o=s(3667),c=s(80893),d=s(70702);function u(e){let{title:t,description:s,onRetry:u,onContinue:p,onCancel:m,supportUrl:x,className:h}=e,{t:f}=(0,d.$G)("chat");return(0,n.jsx)("div",{className:(0,r.cn)("w-full max-w-[48rem]"),children:(0,n.jsx)(o.E.div,{initial:{translateY:5,opacity:0},animate:{translateY:0,opacity:1},exit:{translateY:5,opacity:0},className:(0,r.cn)("w-fit","p-4 bg-card","shadow-sm","border border-input-border rounded-2xl","ml-4 md:mx-4",h),children:(0,n.jsxs)("div",{className:"flex items-center gap-4 flex-wrap",children:[(0,n.jsx)(a.Z,{className:(0,r.cn)("h-5 w-5 flex-shrink-0")}),(0,n.jsxs)("div",{className:"flex-1 max-w-96",children:[(0,n.jsx)("div",{className:"text-primary text-sm",children:t}),s&&(0,n.jsx)("div",{className:"text-secondary text-sm",children:s}),x&&(0,n.jsxs)("div",{className:"text-secondary text-sm",children:[f("Try again or ","Try again or "),(0,n.jsx)(c.default,{href:x,target:"_blank",rel:"noopener noreferrer",className:"text-secondary underline decoration-dotted decoration-secondary/50 underline-offset-4 hover:text-primary",children:f("Contact Support","Contact Support")})]})]}),(u||m||p)&&(0,n.jsxs)("div",{className:"flex items-center gap-2 sm:pl-8",children:[m&&(0,n.jsxs)(i.zx,{variant:"secondary",size:"pill",onClick:m,children:[(0,n.jsx)(l.Z,{className:"mr-2 h-4 w-4"}),f("Cancel","Cancel")]}),u&&(0,n.jsxs)(i.zx,{variant:"secondary",size:"pill",onClick:u,children:[(0,n.jsx)(l.Z,{className:"mr-2 h-4 w-4"}),f("Retry","Retry")]}),p&&(0,n.jsxs)(i.zx,{variant:"secondary",size:"pill",onClick:p,children:[(0,n.jsx)(l.Z,{className:"mr-2 h-4 w-4"}),f("Continue","Continue")]})]})]})})})}},82112:function(e,t,s){s.d(t,{V:function(){return r}});var n=s(2899),i=s(72242);let r=(0,s(4694).forwardRef)((e,t)=>{let{isUser:s,children:r,className:a}=e;return(0,n.jsx)("div",{ref:t,className:(0,i.cn)("relative group flex flex-col justify-center w-full max-w-3xl md:px-4 pb-2 gap-2",s?"items-end":"items-start",a),children:r})})},725:function(e,t,s){s.d(t,{i:function(){return e_}});var n=s(2899),i=s(66319),r=s(81556),a=s(4710),l=s(8781),o=s(64327),c=s(73197),d=s(43701),u=s(3998),p=s(56672),m=s(4694),x=s(70702),h=s(37330),f=s(72242),v=s(41347),g=s(98450);let y=v.fC,j=m.forwardRef((e,t)=>{let{className:s,...i}=e;return(0,n.jsx)(v.ck,{ref:t,className:(0,f.cn)(s),...i})});j.displayName="AccordionItem";let b=m.forwardRef((e,t)=>{let{className:s,children:i,hideChevron:r,...a}=e;return(0,n.jsx)(v.h4,{className:"flex m-0",children:(0,n.jsxs)(v.xz,{ref:t,className:(0,f.cn)("flex flex-1 items-center text-sm font-medium transition-all text-left [&[data-state=open]>svg]:rotate-180",s),...a,children:[i,!r&&(0,n.jsx)(g.v4q,{className:"ml-1 h-4 w-4 shrink-0 text-muted-foreground transition-transform duration-200"})]})})});b.displayName=v.xz.displayName;let w=m.forwardRef((e,t)=>{let{className:s,children:i,hideChevron:r,...a}=e;return(0,n.jsx)(v.h4,{className:"z-20 sticky flex m-0 bg-gradient-to-b from-background via-background via-85% to-transparent group top-12 @[1280px]/mainview:top-0 @[1280px]/mainview:z-40",children:(0,n.jsxs)(v.xz,{ref:t,className:(0,f.cn)("flex flex-1 items-center text-sm font-medium transition-all text-left",s),...a,children:[i,!r&&(0,n.jsx)(g.v4q,{className:"ml-1 h-4 w-4 shrink-0 text-muted-foreground transition-transform duration-200 group-data-[state=open]:rotate-180"})]})})});w.displayName=v.xz.displayName;let N=m.forwardRef((e,t)=>{let{className:s,children:i,...r}=e;return(0,n.jsx)(v.VY,{ref:t,className:"overflow-hidden text-sm data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...r,children:(0,n.jsx)("div",{className:(0,f.cn)("pt-0",s),children:i})})});N.displayName=v.VY.displayName;let I=e=>{let{header:t,responseId:s,index:n}=e,i=t.replace(/[^a-zA-Z0-9\u00C0-\u024F\u0400-\u04FF\u0900-\u097F\u0E00-\u0E7F\u4E00-\u9FFF]/g,"-").toLowerCase();return"".concat(i,"-").concat(s,"-").concat(n)};var S=s(74239),k=s(69492);let C=e=>{var t,s,n;let{uniqueXPosts:i,uniqueWebSearchResults:r,uniqueBrowsedUrls:a}=(0,m.useMemo)(()=>{var t;let{webSearchResults:s,xposts:n,steps:i}=e,r=[...n||[],...(i||[]).flatMap(e=>e.xposts||[])],a=[...s||[],...(i||[]).flatMap(e=>e.webSearchResults||[])],l=new Set,o=r.filter(e=>!(!(null==e?void 0:e.postId)||l.has(e.postId))&&(l.add(e.postId),!0)),c=new Set;return{uniqueXPosts:o,uniqueWebSearchResults:a.filter(e=>!(!(null==e?void 0:e.url)||c.has(e.url))&&(c.add(e.url),!0)),uniqueBrowsedUrls:(null===(t=e.steps)||void 0===t?void 0:t.flatMap(e=>{var t,s,n;if(!(null===(t=e.tags)||void 0===t?void 0:t.includes("decision")))return[];let i=e.tags.indexOf("decision"),r=null===(s=e.text)||void 0===s?void 0:s[i];if(!r)return[];try{let e=JSON.parse(r);if("browse_page"===e.action){let t=null===(n=e.action_input)||void 0===n?void 0:n.url;return t?[t]:[]}}catch(e){}return[]}))||[]}},[null===(t=e.xposts)||void 0===t?void 0:t.length,null===(s=e.webSearchResults)||void 0===s?void 0:s.length,null===(n=e.steps)||void 0===n?void 0:n.length]);return{uniqueXPosts:i,uniqueWebSearchResults:r,uniqueBrowsedUrls:a}};var E=s(34116),_=s(73848),R=s(33600),T=s(73069),z=s(3667),M=s(76270),A=s(2080);let O=e=>{let{post:t}=e;return(0,n.jsxs)("a",{href:"https://x.com/".concat(t.username,"/status/").concat(t.postId),className:"block p-3 flex-shrink-0 w-80 bg-card h-[136px] border not-prose border-card-border hover:border-card-focus hover:bg-card-hover rounded-3xl group/xpost transition-all !no-underline",target:"_blank",rel:"noopener noreferrer",children:[(0,n.jsxs)("div",{className:"flex flex-row items-center gap-2 w-full min-w-0",children:[(0,n.jsx)("img",{className:(0,f.cn)("size-8 rounded-full bg-important border border-card-border"),src:t.profileImageUrl,alt:"".concat(t.name,"'s profile")}),(0,n.jsxs)("div",{className:"flex flex-col overflow-hidden flex-1 min-w-0",children:[(0,n.jsxs)("div",{className:"flex gap-1 items-center min-w-0",children:[(0,n.jsxs)("div",{className:"flex gap-1 items-center flex-1 min-w-0 leading-tight",children:[(0,n.jsx)("span",{className:"m-0 truncate text-primary font-medium min-w-0",children:t.name}),(0,n.jsx)("span",{className:"text-xs text-secondary shrink-0",children:"\xb7"}),"string"==typeof t.createTime&&(0,n.jsx)(M.G,{className:"text-xs whitespace-nowrap shrink-0",date:new Date(t.createTime||""),noTooltip:!0})]}),(0,n.jsx)(A.Z,{className:"mx-1 size-3 text-secondary group-hover/xpost:text-primary transition-all shrink-0"})]}),(0,n.jsxs)("span",{className:"text-xs text-secondary truncate leading-tight",children:["@",t.username]})]})]}),(0,n.jsx)("p",{className:"text-primary text-xs mt-2 line-clamp-3 mb-0",children:t.text})]})},Z=[],U=e=>{var t,s,i;let{isStreaming:r,isOpen:a,step:l,stepIndex:o}=e,{t:c}=(0,x.$G)("chat"),{client:d}=(0,S.useStatsigClient)(),u=(0,k.gK)(p.Z("setSidePanelContent")),f=r?h._I:h.Cn,v=(()=>{if(!l.tags||!l.text)return null;let e=l.tags.indexOf("decision");return -1===e?null:JSON.parse(l.text[e])})(),g=(()=>{if(!l.tags||!l.text)return null;let e=l.tags.indexOf("summary");return -1===e?null:l.text[e]})(),y=(0,m.useMemo)(()=>{var e;return(null!==(e=l.webSearchResults)&&void 0!==e?e:[]).slice(0,5)},[l.webSearchResults]),j=(0,m.useCallback)(()=>{var e;d.logEvent("show_all_research_accordion_search_results",void 0,{location:"searching-step",stepIndex:o.toString()}),l.webSearchResults&&(null===(e=l.webSearchResults)||void 0===e?void 0:e.length)>0&&u({type:"webSearchResults",data:{webSearchResults:l.webSearchResults}})},[l.webSearchResults]),b=(0,m.useCallback)(()=>{var e;l.xposts&&(null===(e=l.xposts)||void 0===e?void 0:e.length)>0&&u({type:"xPosts",data:l.xposts})},[l.xposts]),w=(0,m.useCallback)(()=>{var e,t;(null==v?void 0:v.action)==="browse_page"&&(null===(e=v.action_input)||void 0===e?void 0:e.url)&&window.open(null===(t=v.action_input)||void 0===t?void 0:t.url,"_blank")},[v]);return(0,n.jsxs)(T.M,{children:[a&&(0,n.jsx)(z.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2,ease:"easeIn"},className:"overflow-x-auto [&>ul]:m-0 [&>div]:pb-0",children:(0,n.jsx)(f,{sender:"assistant",webSearchResults:l.webSearchResults||Z,xposts:l.xposts||Z,isNested:!0,children:g||""})},"summary-".concat(o)),l.webSearchResults&&l.webSearchResults.length>0&&(0,n.jsxs)("div",{className:"w-full flex flex-col gap-3 py-3",children:[a&&(0,n.jsx)(z.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2,ease:"easeIn"},className:"flex items-center gap-3",children:(0,n.jsx)("ul",{className:"w-full text-primary m-0",children:(0,n.jsx)("li",{children:(0,n.jsx)(x.cC,{ns:"chat",i18nKey:"super-search-searching-for",defaults:'Searching for <bold>"{{query}}"</bold>',values:{query:null==v?void 0:null===(t=v.action_input)||void 0===t?void 0:t.query},components:{bold:(0,n.jsx)("strong",{})}})})})},"web-search-results-".concat(o)),(0,n.jsxs)("div",{className:"relative w-full h-full -ml-4",children:[(0,n.jsx)("div",{className:"absolute inset-y-0 left-0 w-4 pointer-events-none bg-gradient-to-r from-background to-transparent"}),(0,n.jsx)("div",{className:"absolute inset-y-0 -right-4 w-4 pointer-events-none bg-gradient-to-l from-background to-transparent"}),a&&(0,n.jsxs)("div",{className:"flex flex-col gap-3 w-[calc(100%+16px)] min-h-0 h-full items-stretch px-4 [&:has(:is(*):nth-last-child(1):not(:first-child))]:pb-2",children:[y.map((e,t)=>(0,n.jsx)(z.E.div,{className:"w-full",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2,ease:"easeIn",delay:.05*t},children:(0,n.jsx)("div",{className:"w-full max-w-full overflow-hidden relative",children:(0,n.jsxs)("div",{className:"flex max-w-full items-start",children:[e.favicon?(0,n.jsx)("img",{src:e.favicon,alt:"favicon",className:"m-0 mr-3 w-3 h-3"}):null,(0,n.jsxs)("div",{className:"max-w-full w-full text-primary text-sm whitespace-nowrap overflow-hidden text-ellipsis flex flex-col gap-1 ",children:[(0,n.jsx)("a",{href:e.url,target:"_blank",className:"w-full max-w-full !decoration-transparent leading-4  hover:!decoration-primary text-primary truncate",children:e.title}),(0,n.jsx)("div",{className:"ml-1 text-secondary text-xs leading-4 text-nowrap",children:e.url?(0,_.b)(e.url):void 0})]})]})},e.url)},t)),(0,n.jsx)(E.zx,{onClick:j,variant:"outline",className:"text-secondary hover:text-primary h-auto hover:bg-transparent",children:l.webSearchResults.length<=y.length&&"(".concat(l.webSearchResults.length-y.length,")")?c("See all","See all"):c("See more","See more")+" (".concat(l.webSearchResults.length-y.length,")")})]})]})]}),a&&(null==v?void 0:v.action)==="browse_page"&&v.action_input.url&&(0,n.jsx)(z.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2,ease:"easeIn"},className:"flex items-center gap-3",children:(0,n.jsx)("ul",{className:"text-primary m-0",children:(0,n.jsxs)("li",{children:[(0,n.jsx)("span",{children:(0,n.jsx)(x.cC,{ns:"chat",i18nKey:"super-search-box-step.browse-page",defaults:'Browsing <site>{{url}}</site> for <bold>"{{query}}"</bold>',values:{url:(0,_.b)(v.action_input.url),query:v.action_input.query},components:{site:(0,n.jsx)("a",{href:v.action_input.url,target:"_blank",rel:"noopener noreferrer"}),bold:(0,n.jsx)("strong",{})}})}),(0,n.jsx)(R.Z,{className:"cursor-pointer transition-all inline ml-2 flex-shrink-0 -mt-0.5 size-4 text-secondary hover:text-primary",onClick:w})]})})},"decision-".concat(o)),l.xposts&&l.xposts.length>0&&(0,n.jsxs)("div",{className:"w-full flex flex-col gap-3 py-3",children:[a&&(0,n.jsxs)(z.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2,ease:"easeIn"},className:"flex items-center gap-3",children:[(0,n.jsx)("ul",{className:"w-full text-primary m-0",children:(0,n.jsx)("li",{children:(null==v?void 0:null===(s=v.action_input)||void 0===s?void 0:s.query)?(0,n.jsx)(x.cC,{ns:"chat",i18nKey:"deep-search-box-step.xposts-with-query",defaults:'Searching on X for <bold>"{{query}}"</bold>',values:{query:null==v?void 0:null===(i=v.action_input)||void 0===i?void 0:i.query},components:{bold:(0,n.jsx)("strong",{})}}):c("deep-search-box-step.xposts-without-query","Searching on X for")})}),(0,n.jsx)(E.zx,{variant:"ghostSecondary",size:"sm",className:"rounded-full transition-all mr-0.5",onClick:b,children:c("See all","See all")})]},"xposts-".concat(o)),(0,n.jsxs)("div",{className:"relative w-full h-full -ml-4",children:[(0,n.jsx)("div",{className:"absolute inset-y-0 left-0 w-4 pointer-events-none bg-gradient-to-r from-background to-transparent"}),(0,n.jsx)("div",{className:"absolute inset-y-0 -right-4 w-4 pointer-events-none bg-gradient-to-l from-background to-transparent"}),a&&(0,n.jsx)("div",{className:"flex gap-3 w-[calc(100%+16px)] h-full items-stretch overflow-x-auto px-4 [&:has(:is(*):nth-last-child(1):not(:first-child))]:pb-2",children:l.xposts.map((e,t)=>(0,n.jsx)(z.E.div,{className:"w-full",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2,ease:"easeIn",delay:.05*t},children:(0,n.jsx)(O,{post:e})},t))})]})]})]})};var P=s(37446),H=s(84896);let F=e=>{let{header:t,isComplete:s}=e;return(0,n.jsxs)(b,{className:"flex items-center gap-2",children:[(0,n.jsx)(T.M,{children:s?(0,n.jsx)(z.E.div,{initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},className:"flex-shrink-0 flex items-center",children:(0,n.jsx)(H.Z,{className:"text-secondary size-[22px] flex-shrink-0"})},"check"):(0,n.jsx)(z.E.div,{initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},className:"flex-shrink-0 flex items-center",children:(0,n.jsx)(P.$,{size:"sm"})},"spinner")}),(0,n.jsx)("div",{className:"flex items-center",children:(0,n.jsx)("div",{className:"truncate text-base font-medium max-w-full",children:s?t:(0,n.jsx)(z.E.div,{className:"text-transparent bg-clip-text bg-gradient-to-r from-secondary via-secondary-foreground to-secondary",style:{backgroundSize:"200% 100%"},animate:{backgroundPosition:["100% 0%","-100% 0%"]},transition:{duration:1,ease:"linear",repeat:Number.POSITIVE_INFINITY},children:t})})})]})};var L=s(6087);let G=e=>{let{children:t}=e;return(0,n.jsxs)(z.E.div,{initial:{opacity:0},animate:{opacity:1},className:"min-h-[3.5rem] overflow-y-clip flex flex-col justify-start text-white rounded-2xl relative w-full overflow-clip foucs:outline-none focus-within:outline-none",children:[t,(0,n.jsx)(g.v4q,{className:"absolute right-5 top-5 h-4 w-4 shrink-0 text-muted-foreground transition-transform duration-200 group-data-[state=open]:rotate-180"})]})};function D(e){let{thinkingTrace:t="",className:s}=e,i=t.split(/\r?\n/).filter(Boolean),r=Math.min(i.length,12),a=i.slice(-r);return(0,n.jsx)("div",{className:(0,f.cn)("w-full overflow-hidden relative flex flex-col items-start","h-[180px]",s),children:(0,n.jsxs)(T.M,{mode:"popLayout",children:["(",(0,n.jsx)(z.E.div,{layout:"position",initial:{filter:"blur(8px)"},animate:{filter:"blur(0px)"},transition:{duration:1,ease:"easeOut"},className:(0,f.cn)("w-full flex flex-col items-center justify-center relative px-4 h-full","fade-mask"),children:a.map((e,t)=>(0,n.jsx)(z.E.p,{layout:"position",initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"w-full text-secondary text-[12px] opacity-90 my-0 flex items-center",transition:{duration:.3,ease:"easeOut"},children:e},i.length-a.length+t))}),")"]})})}var B=s(84102),$=s(34489);let W=e=>{let{isThinking:t,startTime:s,endTime:i,sourcesCount:r,open:l,hasError:o,setOpen:c,children:d,thinkingTrace:u,type:p,inlineButtonText:h,onClickShow:v,progressReport:g,deepsearchPreset:b}=e,{t:I}=(0,x.$G)("chat"),[S,k]=(0,m.useState)(void 0),C=(0,m.useCallback)(()=>{c(!l)},[l,c]),E=(0,m.useMemo)(()=>s&&i,[s,i]),_=(0,m.useMemo)(()=>s&&i||u&&!s||!t,[s,i,u,t]),R=(0,m.useMemo)(()=>(0,n.jsxs)(n.Fragment,{children:[" ",S&&(0,n.jsx)("span",{className:"font-mono text-secondary font-medium text-sm",children:I("generationTime","{{duration}}s",{duration:S.toFixed(0)})}),!!r&&!t&&(0,n.jsxs)(n.Fragment,{children:[S&&(0,n.jsx)("span",{className:"font-mono text-secondary font-medium text-sm",children:" \xb7 "}),(0,n.jsxs)("span",{className:"text-secondary font-medium text-sm",children:[(0,n.jsx)("span",{className:"font-mono mx-0.5",children:"•"}),(0,n.jsx)("span",{className:"font-mono mx-0.5",children:r}),I("citation sources","Sources")]})]})]}),[S,r,t,I]);(0,m.useEffect)(()=>{if(!s)return;if(!t){s&&i&&k((i-s)/1e3);return}if(i){k((i-s)/1e3);return}let e=setInterval(()=>{k(((i||Date.now())-s)/1e3)},1e3);return()=>clearInterval(e)},[s,i,t]);let T=(0,m.useCallback)(e=>{e.stopPropagation(),null==v||v()},[v]),M=(0,m.useMemo)(()=>{if((null==g?void 0:g.state)==="PROGRESS_REPORT_STATUS_PENDING"&&(null==g?void 0:g.category))return g.category},[g]);return(0,n.jsx)(y,{className:"mb-2",type:"single",collapsible:!0,onValueChange:C,value:l?"root":"",children:(0,n.jsxs)(j,{className:"md:-mx-4 mb-4 relative border-2 border-toggle-border rounded-3xl overflow-clip",value:"root",children:[(0,n.jsx)(w,{hideChevron:!0,className:"text-base space-x-1 transition-padding z-30 duration-200 pt-0 focus:outline-none focus-within:outline-none transition-none",children:(0,n.jsxs)(G,{children:[(0,n.jsxs)("div",{className:"flex h-full gap-1 w-full items-center justify-start text-primary px-5 pt-4",children:[t&&(0,n.jsxs)(z.E.div,{className:"flex gap-1 overflow-hidden",initial:{width:0},animate:{width:"auto"},exit:{width:0},children:[(0,n.jsx)(a.S,{state:M}),(0,n.jsxs)("div",{className:"flex items-baseline gap-1 overflow-hidden",children:[!M&&(0,n.jsx)("span",{className:"loading-gradient-text whitespace-nowrap",children:"think"===p?I("model is thinking response title","Thinking"):"deeper"===b?I("deeper search response title","DeeperSearch"):I("deep search response title","DeepSearch")}),R]})]}),E&&!o&&(0,n.jsx)(z.E.div,{initial:{width:0},animate:{width:"auto"},exit:{width:0},className:"flex items-center gap-2",children:(0,n.jsxs)("div",{className:"flex items-center gap-1 overflow-hidden",children:["think"===p?(0,n.jsx)(L.WG,{size:16,className:"text-nowrap shrink-0"}):(0,n.jsx)(B.Z,{size:16,className:"text-primary text-nowrap shrink-0"}),(0,n.jsxs)("div",{className:"flex items-baseline gap-1 overflow-hidden",children:[(0,n.jsx)("span",{className:"text-base text-nowrap whitespace-nowrap",children:I("Thought for","Thought for")}),R]})]})}),_&&(!E||o)&&(0,n.jsxs)("div",{className:"flex items-center gap-1 overflow-hidden",children:["think"===p?(0,n.jsx)(L.WG,{size:16,className:"text-primary text-nowrap shrink-0"}):(0,n.jsx)(B.Z,{size:16,className:"text-primary text-nowrap shrink-0"}),(0,n.jsxs)("div",{className:"flex items-baseline gap-1 overflow-hidden",children:[(0,n.jsx)("span",{className:"text-base text-nowrap whitespace-nowrap",children:"think"===p?I("thinking response finished title","Thoughts"):"deeper"===b?I("deeper search response finished title","DeeperSearch"):I("deep search response finished title","DeepSearch")}),R]})]})]}),u&&t&&(0,n.jsx)(z.E.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},children:(0,n.jsx)(D,{className:(0,f.cn)(l&&"h-0"),thinkingTrace:u,showMask:!0})}),!_&&l&&v?(0,n.jsx)("span",{className:"text-secondary text-sm my-0 px-5 pb-4 flex flex-row items-center",children:(0,n.jsxs)("span",{className:"cursor-pointer flex flex-row items-center hover:text-primary",onClick:T,children:[h," ",(0,n.jsx)($.Z,{className:"ml-0.5",size:12})]})}):null,_&&(0,n.jsx)("span",{className:"text-secondary text-sm my-0 px-5 pb-4 flex flex-row items-center",children:l?(0,n.jsxs)(n.Fragment,{children:[I("Collapse details","Collapse details"),v?" • ":"",v?(0,n.jsxs)("span",{className:"cursor-pointer flex flex-row items-center ml-1 hover:text-primary",onClick:T,children:[h," ",(0,n.jsx)($.Z,{className:"ml-0.5",size:12})]}):null]}):I("Expand for details","Expand for details")})]})}),(0,n.jsx)(N,{className:"text-secondary flex flex-col max-w-full overflow-y-clip",children:d})]})})};function q(e){var t,s,i;let{response:r,isStreaming:a}=e,{t:l}=(0,x.$G)("chat"),{client:o}=(0,S.useStatsigClient)(),[c,d]=(0,m.useState)(!1),[u,h]=(0,m.useState)(""),[f,v]=(0,m.useState)(0),[g,b]=(0,m.useState)(!0),w=(0,k.gK)(p.Z("setSidePanelContent")),E=(()=>{if(!r.steps)return[];let e=[];return r.steps.forEach((t,s)=>{var n,i,a,o;if(!t.text.length)return;let c=t.tags.indexOf("header")>-1;if(!c&&0===s){e.push({id:I({header:l("deepsearch-thinking","Thinking"),responseId:null!==(n=r.responseId)&&void 0!==n?n:"",index:s}),header:l("deepsearch-thinking","Thinking"),steps:[t]});return}if(c){let n=(null===(a=t.text)||void 0===a?void 0:a[(null===(i=t.tags)||void 0===i?void 0:i.indexOf("header"))||0])||"";e.push({id:I({header:n,responseId:null!==(o=r.responseId)&&void 0!==o?o:"",index:s}),header:n,steps:[t]});return}0!==e.length&&e[e.length-1].steps.push(t)}),e.filter(e=>!!e.steps.length&&e.steps.some(e=>{var t,s;return(null===(t=e.tags)||void 0===t?void 0:t.includes("decision"))||(null===(s=e.tags)||void 0===s?void 0:s.includes("summary"))}))})(),_=e=>e!==E[E.length-1].id||!!r.searchingEndTime||!a,{uniqueXPosts:R,uniqueWebSearchResults:T,uniqueBrowsedUrls:z}=C(r),M=T.length+R.length+z.length,A=null===(i=r.steps)||void 0===i?void 0:i.map(e=>{var t,s,n;if(!(null===(t=e.tags)||void 0===t?void 0:t.includes("assistant")))return"";let i=null===(s=e.tags)||void 0===s?void 0:s.indexOf("assistant");return(null===(n=e.text)||void 0===n?void 0:n[i])||""}).join(" "),O=(0,k.gK)(p.Z("sidePanelContent")),Z=(null==O?void 0:O.type)==="thinkingTrace"&&O.data.responseId===r.responseId,P=(0,m.useMemo)(()=>{if(null==A?void 0:A.trim())return()=>{var e,t,s,n;if(r.responseId){if(Z){o.logEvent("toggle_research_thinking_trace","hidden",{location:"research-response",responseId:null!==(e=r.responseId)&&void 0!==e?e:"",conversationId:null!==(t=r.conversationId)&&void 0!==t?t:""}),w(void 0);return}o.logEvent("toggle_research_thinking_trace","shown",{location:"research-response",responseId:null!==(s=r.responseId)&&void 0!==s?s:"",conversationId:null!==(n=r.conversationId)&&void 0!==n?n:""}),w({type:"thinkingTrace",data:{responseId:r.responseId}})}}},[r.responseId,O,Z,!A]),H=(0,m.useCallback)(e=>{var t,s;e&&b(!1),o.logEvent("expand_research_step",e||"collapsed-all",{location:"research-response",responseId:null!==(t=r.responseId)&&void 0!==t?t:"",conversationId:null!==(s=r.conversationId)&&void 0!==s?s:""}),h(e)},[b,o,r,h]);return((0,m.useEffect)(()=>{a&&r.searchingStartTime&&d(!0)},[a,r.searchingStartTime]),(0,m.useEffect)(()=>{g&&E.length!==f&&a&&setTimeout(()=>{var e;h(null===(e=E[E.length-1])||void 0===e?void 0:e.id),v(E.length)},800)},[g,f,E,a]),(0,m.useEffect)(()=>{var e;g&&r.searchingEndTime&&u===(null===(e=E[E.length-1])||void 0===e?void 0:e.id)&&h("")},[g,r.searchingEndTime,u,E]),r.hasImages||(!r.searchingStartTime||["closed","error"].includes(null!==(s=r.state)&&void 0!==s?s:""))&&(!r.steps||(null===(t=r.steps)||void 0===t?void 0:t.length)===0))?null:(0,n.jsx)(W,{type:"deepSearch",isThinking:!!(r.searchingStartTime&&!r.searchingEndTime)&&a,startTime:r.searchingStartTime,endTime:r.searchingEndTime,sourcesCount:M,open:c,setOpen:d,hasError:"error"===r.state,thinkingTrace:A,onClickShow:P,inlineButtonText:Z?l("hide thinking trace","Hide Thinking"):l("show thinking trace","Show Thinking"),progressReport:r.progressReport,deepsearchPreset:r.deepsearchPreset,children:(0,n.jsx)(y,{type:"single",collapsible:!0,value:u,onValueChange:H,className:"flex flex-col w-full pb-3",children:E.map(e=>(0,n.jsxs)(j,{value:e.id,className:"px-4 my-3 w-full",children:[(0,n.jsx)(F,{header:e.header,isComplete:_(e.id)}),(0,n.jsx)(N,{className:"flex flex-col pl-7 pt-3",children:e.steps.map((t,s)=>(0,n.jsx)(U,{isStreaming:a,step:t,stepIndex:s,isOpen:u===e.id},s))})]},e.id))})})}var K=s(81211);let V=[];function Y(e){let{response:t,isStreaming:s}=e,i=(0,K.g)(),{client:r}=(0,S.useStatsigClient)(),{sender:a,thinkingTrace:l,webSearchResults:o,xposts:c,thinkingEndTime:d,thinkingStartTime:u,progressReport:p,deepsearchPreset:x}=t,f=s?h._I:h.Cn,[v,g]=(0,m.useState)(!1),y=(0,m.useCallback)(e=>{var s,n;r.logEvent("toggle_thinking_accordion",e?"open":"closed",{location:"thinking-response",responseId:null!==(s=t.responseId)&&void 0!==s?s:"",conversationId:null!==(n=t.conversationId)&&void 0!==n?n:""}),g(e)},[r,g]);return((0,m.useEffect)(()=>{i.THINKING_AUTO_OPEN&&s&&u&&g(!0)},[s,u]),(0,m.useEffect)(()=>{d&&g(!1)},[d]),(l||u)&&(!u||!d||l))?(0,n.jsx)(W,{type:"think",isThinking:!!(u&&!d)&&s,startTime:u,endTime:d,open:v,setOpen:y,hasError:"error"===t.state,thinkingTrace:l,progressReport:p,deepsearchPreset:x,children:(0,n.jsx)(z.E.div,{tabIndex:0,initial:{opacity:0},animate:{opacity:1},transition:{duration:.2,ease:"easeIn"},className:"[&>*:first-child]:mt-0 px-5 h-fit overflow-x-auto w-full focus:outline-none focus-within:outline-none",children:(0,n.jsx)(f,{sender:a||"",webSearchResults:o||V,xposts:c||V,isNested:!0,children:l||""})})}):null}var X=s(38199),J=s(53429),Q=s(53952),ee=s(43010),et=s(25912),es=s(19903);let en=[],ei=[];function er(e){var t,s,i,r,l;let{artifact:c,isStreaming:u,readOnly:h}=e,v=!(0,d.F)(e=>e.userSettings.preferences.hideArtifacts),g=(0,o.dV)(p.Z("inlineSettings")),y=(0,K.g)(),{client:j}=(0,S.useStatsigClient)(),b=!v||null!==(r=c.isInline)&&void 0!==r&&r;v&&c.id&&"boolean"==typeof(null===(t=g[c.id])||void 0===t?void 0:t.isInline)&&(b=g[c.id].isInline);let w=(0,o.dV)(p.Z("setInlineSetting")),{setSidePanelContent:N,sidePanelContent:I}=(0,k.gK)(),{t:C}=(0,x.$G)("chat"),_=(0,m.useCallback)(()=>{!b&&v&&N({type:"artifact",data:{artifact:c,readOnly:h}})},[c,c.content,h,v,N,b]),R=(0,m.useCallback)(async()=>{if(j.logEvent("artifact_show_inline_button_clicked",void 0,{}),c.id&&c.versionId){N(void 0),w(c.id,!0);try{await (0,J.S3)({artifactId:c.id,artifactVersionId:c.versionId,isInline:!0})}catch(e){Q.Tb(e)}}},[c.id,c.versionId]),T=(0,m.useCallback)(async()=>{if(j.logEvent("artifact_show_in_sidebar_button_clicked",void 0,{}),c.id&&c.versionId)try{await (0,J.S3)({artifactId:c.id,artifactVersionId:c.versionId,isInline:!1})&&(N({type:"artifact",data:{readOnly:!1,artifact:c}}),w(c.id,!1))}catch(e){Q.Tb(e)}},[c,w,N,j]),z=(null==I?void 0:I.type)==="artifact"&&c.id===(null==I?void 0:null===(s=I.data)||void 0===s?void 0:s.artifact.id)&&c.versionId===(null==I?void 0:null===(i=I.data)||void 0===i?void 0:i.artifact.versionId);(0,m.useEffect)(()=>{(null==I?void 0:I.type)==="artifact"&&I.data.artifact.responseId===c.responseId&&I.data.artifact.id===c.id&&_()},[null==c?void 0:c.content]),(0,m.useEffect)(()=>{let e=(null==I?void 0:I.type)==="artifact"&&I.data.artifact.responseId===c.responseId&&I.data.artifact.id;u&&c.content&&!e&&_()},[u,!!c.content]);let M=(0,es.hz)(c),A=(0,m.useCallback)(()=>{_(),j.logEvent("artifact_card_clicked",void 0,{})},[_,j]);if(b)return(0,n.jsx)(ea,{type:M,content:null!==(l=c.content)&&void 0!==l?l:"",onShowInASidebar:T});let O=u&&c.incomplete&&!c.title;return(0,n.jsxs)("div",{className:"flex flex-col items-start justify-start gap-2",children:[(0,n.jsx)("div",{className:(0,f.cn)("flex cursor-pointer rounded-2xl border border-border-l1 bg-surface-l2 hover:bg-surface-l4-hover dark:hover:bg-surface-l3",z?"bg-surface-l4-hover dark:bg-surface-l3 hover:bg-surface-l4-hover dark:hover:bg-surface-l3 border-border-l2 cursor-default":void 0,O?"w-[250px]":void 0),onClick:A,id:"artifact_card_".concat(c.versionId),children:O?(0,n.jsxs)("div",{className:"flex w-full items-center space-x-3 p-3",children:[(0,n.jsx)(X.O,{className:"h-8 w-8 rounded-full"}),(0,n.jsxs)("div",{className:"space-y-2 flex-1",children:[(0,n.jsx)(X.O,{className:"h-3.5 w-11/12"}),(0,n.jsx)(X.O,{className:"h-3.5 w-8/12"})]})]}):(0,n.jsxs)("div",{className:"pl-3 pr-5 py-3 flex gap-2",children:[(0,n.jsx)("div",{className:"flex items-center justify-center text-fg-secondary",children:u&&c.incomplete?(0,n.jsx)("div",{className:"flex items-center justify-center w-7 h-8",children:(0,n.jsx)(a.S,{})}):"text/plain"===c.contentType||"text/markdown"===c.contentType?(0,n.jsx)(ee.Z,{size:28,strokeWidth:1.5}):(0,n.jsx)(et.Z,{size:28,strokeWidth:1.5})}),(0,n.jsxs)("div",{className:"leading-[1.3]",children:[(0,n.jsx)("div",{className:"font-medium text-sm",children:c.title}),(0,n.jsx)("div",{className:"text-fg-secondary text-sm",children:M})]})]})}),y.SHOW_ARTIFACTS_INLINE_BUTTON&&!c.incomplete?(0,n.jsx)(E.zx,{variant:"text",size:"none",className:"ml-1 text-fg-secondary hover:text-fg-primary hover:no-underline","aria-label":C("artifact.show.inline.button","Show inline"),onClick:R,children:C("artifact.show.inline.button","Show inline")}):null]})}let ea=e=>{let{type:t,content:s,onShowInASidebar:i}=e,{t:r}=(0,x.$G)("chat"),a=!(0,d.F)(e=>e.userSettings.preferences.hideArtifacts),[l,o]=(0,m.useState)(!1),c="markdown"!==t&&"plain"!==t&&!!s,u=c?"```".concat(t,"\n").concat(s,"\n```"):s,p=(0,m.useCallback)(()=>{o(!0)},[]),v=(0,m.useCallback)(()=>{o(!1)},[]);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:(0,f.cn)("transition-opacity",l?"opacity-70":void 0),children:(0,n.jsx)(h.Cn,{sender:"",xposts:en,webSearchResults:ei,children:u})}),a?(0,n.jsxs)(E.zx,{variant:"secondary",size:"sm",className:"text-fg-secondary hover:text-fg-primary rounded-full mb-2","aria-label":r("artifact.show.in-sidebar.button","Show in sidebar"),onClick:i,onMouseEnter:p,onMouseLeave:v,children:[c?(0,n.jsx)(et.Z,{size:16,strokeWidth:1.5}):(0,n.jsx)(ee.Z,{size:16,strokeWidth:1.5}),r("artifact.show.in-sidebar.button","Show in sidebar"),(0,n.jsx)($.Z,{size:16,strokeWidth:1.5})]}):null]})};var el=s(28116),eo=s(94880),ec=s(37158),ed=s(90280),eu=s(53483),ep=s(48186),em=s(12167);let ex=(0,m.forwardRef)((e,t)=>{let{children:s}=e,i=(0,m.useRef)(null),[r,a]=(0,m.useState)(!0),[l,o]=(0,m.useState)(!1),[c,u]=(0,m.useState)(!0),p=(0,m.useRef)(()=>{}),x=(0,d.F)(e=>e.userSettings.preferences.disableAutoScroll),h=(0,m.useCallback)(e=>{i.current&&(o(!1),i.current.scrollTo({top:i.current.scrollHeight,behavior:e}))},[]),v=(0,m.useCallback)(e=>{if(!e)return;let t=document.querySelector('div[data-scrollid="'.concat(e,'"]'));if(!t||!i.current)return;let{top:s}=eh(t,i.current);i.current.scrollTo({top:s,behavior:"smooth"}),a(!1)},[]),g=(0,m.useCallback)(e=>{p.current=e},[]);(0,m.useEffect)(()=>{h("instant")},[]),(0,m.useImperativeHandle)(t,()=>{var e,t,s;return{scrollToId:v,setScrollToIdHandler:g,el:i.current,scrollHeight:null===(e=i.current)||void 0===e?void 0:e.scrollHeight,scrollTop:null===(t=i.current)||void 0===t?void 0:t.scrollTop,clientHeight:null===(s=i.current)||void 0===s?void 0:s.clientHeight}}),(0,m.useEffect)(()=>{if(!i.current)return;let e=new MutationObserver(()=>{if(!i.current){o(!1);return}let e=i.current.scrollHeight-i.current.scrollTop-i.current.clientHeight,t=e<5;if(t!==c&&u(t),o(!r&&e>15),r&&!t&&!x){h("smooth");let e=i.current.querySelectorAll("div[data-scrollid]"),t=e[e.length-1];if(t){var s;let e=null!==(s=t.getAttribute("data-scrollid"))&&void 0!==s?s:void 0;e&&p.current(e)}}});return e.observe(i.current,{childList:!0,subtree:!0}),()=>{e.disconnect()}},[c,r,x]);let y=(0,m.useCallback)(()=>{a(!1)},[]),j=(0,m.useCallback)(()=>{if(i.current){var e;let t=(e=i.current).scrollHeight<e.scrollTop+e.clientHeight+5;t!==c&&u(t),o(!t)}},[c]),b=(0,m.useCallback)(e=>{if(e.deltaY>0&&i.current&&!r&&i.current.scrollTop+i.current.clientHeight+50>=i.current.scrollHeight&&!x&&a(!0),e.deltaY<0&&r&&y(),!i.current)return;let t=i.current.querySelectorAll("div[data-scrollid]");if(t.length>0){let e;let n=i.current.scrollTop,r=i.current.clientHeight,a=i.current.scrollHeight,l=1/0;if(n<20)e=t[0];else if(n+r>=a-20)e=t[t.length-1];else{let s=n+r/2;for(let n of t){let{top:t}=eh(n,i.current);if(s>t&&s<t+n.clientHeight){e=n;break}let r=Math.abs(s-(t+n.clientHeight/2));r<l&&(e=n,l=r)}}if(e){var s;let t=null!==(s=e.getAttribute("data-scrollid"))&&void 0!==s?s:void 0;p.current(t)}else p.current(void 0)}},[r,x]);return(0,n.jsxs)("div",{ref:i,className:(0,f.cn)("w-full h-full overflow-y-auto overflow-x-hidden scrollbar-gutter-stable no-scrollbar"),onScroll:j,onTouchStart:y,onWheel:b,onDragStart:y,onPointerDown:y,onResize:y,children:[s,l?(0,n.jsx)("div",{className:"absolute flex justify-center w-full h-0 pr-4 mx-auto -top-3",children:(0,n.jsx)("div",{className:(0,f.cn)("h-0 flex items-end justify-end w-full",ep.c,"px-2 z-40"),children:(0,n.jsx)(E.zx,{onClick:()=>a(!0),variant:"outline",size:"icon",className:"rounded-full bg-input backdrop-blur-sm size-8",children:(0,n.jsx)(em.Z,{size:20,className:"-mb-0.5"})})})}):null]})});function eh(e,t){let s=e.getBoundingClientRect(),n=t.getBoundingClientRect();return{top:s.top-n.top+t.scrollTop,left:s.left-n.left+t.scrollLeft}}var ef=s(12707);let ev=e=>{let{header:t,isActive:s,isComplete:i,onClick:r}=e;return(0,n.jsxs)("div",{className:(0,f.cn)("flex items-start gap-2 group/header",s?void 0:"cursor-pointer"),onClick:r,children:[(0,n.jsx)(T.M,{children:i?(0,n.jsx)(z.E.div,{initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},className:"flex items-center bg-surface-base",children:(0,n.jsx)(ef.gwl,{className:(0,f.cn)("text-primary size-[22px] flex-shrink-0",s?void 0:"opacity-60 group-hover/header:opacity-100")})},"check"):(0,n.jsx)(z.E.div,{initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},className:"flex-shrink-0 flex items-center bg-background relative z-30",children:(0,n.jsx)(P.$,{size:"sm"})},"spinner")}),(0,n.jsx)("div",{className:"flex items-center text-white",children:(0,n.jsx)("div",{className:(0,f.cn)("text-sm text-primary font-medium max-w-full leading-6",s?void 0:"opacity-60 group-hover/header:opacity-100"),children:i?t:(0,n.jsx)(z.E.div,{style:{backgroundSize:"200% 100%"},animate:{backgroundPosition:["100% 0%","-100% 0%"]},transition:{duration:1,ease:"linear",repeat:Number.POSITIVE_INFINITY},children:t})})})]})},eg=e=>{let{isThinking:t,startTime:s,endTime:i,sourcesCount:r,deepsearchPreset:l}=e,{t:o}=(0,x.$G)("chat"),[c,d]=(0,m.useState)(void 0),u=s&&i;return(0,m.useEffect)(()=>{if(!s)return;if(!t){s&&i&&d((i-s)/1e3);return}if(i){d((i-s)/1e3);return}let e=setInterval(()=>{d(((i||Date.now())-s)/1e3)},1e3);return()=>clearInterval(e)},[s,i,t]),(0,n.jsxs)("div",{className:"flex flex-col items-start gap-0 text-base space-x-1 transition-padding z-30 duration-200 focus:outline-none focus-within:outline-none transition-none",children:[(0,n.jsx)("div",{className:"flex h-full gap-1 w-full items-center justify-start text-primary px-4",children:(0,n.jsxs)("div",{className:"flex items-center gap-1 overflow-hidden",children:[(0,n.jsx)("div",{className:"w-6 flex items-center justify-center",children:t?(0,n.jsx)(a.S,{}):(0,n.jsx)(B.Z,{size:18,className:"text-primary text-nowrap shrink-0"})}),(0,n.jsx)("span",{className:"text-lg text-nowrap font-medium whitespace-nowrap",children:u?o("Completed","Completed"):"deeper"===l?o("DeeperSearch","DeeperSearch"):o("DeepSearch","DeepSearch")})]})}),(0,n.jsxs)("div",{className:"flex items-center justify-center text-nowrap my-0 pl-10 leading-4 text-xs",children:[c&&(0,n.jsx)("span",{className:"text-secondary font-medium",children:function(e){let t=Math.floor(e/60),s=Math.floor(e%60);return 0===t?"".concat(s,"s"):"".concat(t,"m ").concat(s,"s")}(c)}),!!r&&!t&&(0,n.jsxs)(n.Fragment,{children:[c&&(0,n.jsx)("span",{className:"text-secondary font-medium mx-1",children:"\xb7"}),(0,n.jsx)("span",{className:"text-secondary font-medium",children:o("deepsearch-source-count-label",{count:r,defaultValue_one:"{{count}} source",defaultValue_other:"{{count}} sources"})})]})]})]})},ey=e=>{var t;let{response:s,groups:i,visibleLastStep:r,isStreaming:a,isWide:l,toggleWide:o,scrollToSection:c}=e,{t:d}=(0,x.$G)("chat"),u=(0,k.gK)(p.Z("setSidePanelContent")),h=null===(t=s.steps)||void 0===t?void 0:t.some(e=>{var t;return null===(t=e.tags)||void 0===t?void 0:t.includes("assistant")}),{client:v}=(0,S.useStatsigClient)(),g=(0,m.useCallback)(()=>(v.logEvent("deep_search_trace_click",s.responseId,{location:"super-search-box"}),s.responseId&&u({type:"thinkingTrace",data:{responseId:s.responseId}}),null),[s.responseId]),y=e=>e!==i[i.length-1].id||!!s.searchingEndTime||!a,{uniqueXPosts:j,uniqueWebSearchResults:b,uniqueBrowsedUrls:w}=C(s),N=b.length+j.length+w.length,I=(0,m.useMemo)(()=>i.slice(void 0,-1),[i]),_=(0,m.useMemo)(()=>i[i.length-1],[i]);return(0,n.jsxs)("div",{className:"relative flex flex-col w-2/5 h-full overflow-auto",children:[(0,n.jsxs)("div",{className:"pt-4 pb-2 relative overflow-visible",children:[(0,n.jsx)(eg,{isThinking:!!(s.searchingStartTime&&!s.searchingEndTime)&&a,startTime:s.searchingStartTime,endTime:s.searchingEndTime,sourcesCount:N,hasError:"error"===s.state,deepsearchPreset:s.deepsearchPreset}),(0,n.jsx)("div",{className:"absolute left-0 top-[100%] w-full h-5 bg-gradient-to-b z-40 from-surface-base"})]}),(0,n.jsxs)(ex,{children:[I.length>0?(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("div",{className:"relative z-20 flex flex-col px-4 w-full",children:I.map((e,t)=>(0,n.jsx)("div",{"data-scrollid":"menuitem_".concat(e.id),className:(0,f.cn)("w-full pt-3",t===I.length-1?"pb-6":"pb-3"),children:(0,n.jsx)(ev,{isActive:r===e.id,onClick:()=>c(e.id),header:e.header,isComplete:y(e.id)})},e.id))}),(0,n.jsx)("div",{className:"absolute left-[26px] flex items-center justify-center top-0 pt-6 z-10 h-full",children:(0,n.jsx)("div",{className:"w-0.5 bg-border-l2 h-full"})})]}):null,_?(0,n.jsx)("div",{"data-scrollid":"menuitem_".concat(_.id),className:"w-full px-4 pb-6 relative z-40",children:(0,n.jsx)(ev,{isActive:r===_.id,onClick:()=>c(_.id),header:_.header,isComplete:y(_.id)})},_.id):null]}),(0,n.jsxs)("div",{className:"pt-1 pb-3 px-3 relative overflow-visible",children:[(0,n.jsxs)("div",{className:"flex items-center justify-start",children:[(0,n.jsx)(E.g$,{tooltipContent:(0,n.jsx)("span",{children:d("Expand","Expand")}),tooltipContentProps:{side:"bottom"},tooltipProps:{delayDuration:500},variant:"ghost",size:"iconMd",className:"opacity-20 hover:opacity-100",onClick:o,children:l?(0,n.jsx)(ec.Z,{size:18}):(0,n.jsx)(ed.Z,{size:18})}),h?(0,n.jsx)(E.g$,{tooltipContent:(0,n.jsx)("span",{children:d("Show thinking","Show thinking")}),tooltipContentProps:{side:"bottom"},tooltipProps:{delayDuration:500},variant:"ghost",size:"iconMd",className:"opacity-20 hover:opacity-100",onClick:g,children:(0,n.jsx)(eu.Z,{size:20})}):null]}),(0,n.jsx)("div",{className:"absolute left-0 bottom-[100%] w-full h-5 bg-gradient-to-t z-40 from-surface-base"})]})]})};var ej=s(99456),eb=s(32701);let ew=e=>{var t;let{decision:s,webSearchResults:i}=e,r=(0,k.gK)(p.Z("setSidePanelContent")),{t:a}=(0,x.$G)(["base","chat"]),{client:l}=(0,S.useStatsigClient)(),o=(0,m.useCallback)(()=>{l.logEvent("show_all_research_box_search_results",void 0,{location:"searching-step"}),r({type:"webSearchResults",data:{webSearchResults:i}})},[i]),c=(0,m.useMemo)(()=>i.slice(0,5),[i]);return(0,n.jsxs)("div",{className:"w-full flex flex-col",children:[(0,n.jsx)(z.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2,ease:"easeIn"},className:"flex items-center gap-3 px-5",children:(0,n.jsxs)("div",{className:"text-primary flex justify-start items-start",children:[(0,n.jsx)("div",{className:"min-w-[26px] mt-2",children:(0,n.jsx)(B.Z,{size:12,className:"text-secondary"})}),(0,n.jsx)("span",{children:(0,n.jsx)(x.cC,{ns:"chat",i18nKey:"super-search-searching-for",defaults:'Searching for <bold>"{{query}}"</bold>',values:{query:null==s?void 0:null===(t=s.action_input)||void 0===t?void 0:t.query},components:{bold:(0,n.jsx)("strong",{})}})})]})}),(0,n.jsx)(z.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2,ease:"easeIn"},className:"flex items-center gap-3 px-5",children:(0,n.jsxs)("div",{className:"text-primary flex justify-start items-start",children:[(0,n.jsx)("div",{className:"min-w-[26px] mt-2",children:(0,n.jsx)(eb.Z,{size:12,className:"text-secondary"})}),(0,n.jsx)("span",{children:a("webResultsFound",{count:i.length,ns:"base",defaultValue_one:"one result found",defaultValue_other:"{{count}} results found"})})]})}),(0,n.jsx)("div",{className:"relative w-full h-full pl-12 pr-4 mb-2 mt-3",children:(0,n.jsxs)("div",{className:"flex flex-col",children:[(0,n.jsx)("div",{className:"flex flex-col gap-3",children:c.map((e,t)=>(0,n.jsx)("div",{className:"w-full max-w-full overflow-hidden relative",children:(0,n.jsxs)("div",{className:"flex max-w-full items-start",children:[e.favicon?(0,n.jsx)("img",{src:e.favicon,alt:"favicon",className:"m-0 mr-3 w-3 h-3"}):null,(0,n.jsx)("div",{className:"max-w-full text-primary text-sm h-4 leading-3 whitespace-nowrap overflow-hidden text-ellipsis",children:(0,n.jsx)("a",{href:e.url,target:"_blank",className:"max-w-full !decoration-transparent hover:!decoration-secondary",children:e.title})}),(0,n.jsx)("div",{className:"ml-1 text-secondary text-xs leading-4 text-nowrap",children:e.url?(0,_.b)(e.url):void 0})]})},t+":"+e.url))}),(0,n.jsx)("div",{className:"w-full relative flex justify-start items-start mt-2",children:(0,n.jsx)("div",{className:"text-secondary text-sm ",children:(0,n.jsx)(E.zx,{onClick:o,variant:"ghost",className:"text-secondary hover:text-primary p-0 h-auto hover:bg-transparent",children:i.length<=c.length?a("See all","See all",{ns:"chat"}):a("See more","See more",{ns:"chat"})+" (".concat(i.length-c.length,")")})})})]})}),(0,n.jsx)(z.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2,ease:"easeIn"},className:"flex items-center gap-3 px-5",children:(0,n.jsxs)("div",{className:"text-primary flex justify-start items-start",children:[(0,n.jsx)("div",{className:"min-w-[26px] mt-2",children:(0,n.jsx)(ej.Z,{size:12,className:"text-secondary"})}),(0,n.jsx)(x.cC,{i18nKey:"Browsing results",children:"Browsing results"})]})})]})},eN=[],eI=e=>{var t,s,i,r,a;let{isStreaming:l,step:o,stepId:c}=e,{t:d}=(0,x.$G)("chat"),u=(0,k.gK)(p.Z("setSidePanelContent")),v=(0,m.useRef)(!1),g=l?h._I:h.Cn,y=(()=>{if(!o.tags||!o.text)return null;let e=o.tags.indexOf("decision");if(-1===e)return null;let t=o.text[e];try{return JSON.parse(t)}catch(e){return null}})(),j=(0,m.useRef)(null),b=(()=>{if(!o.tags||!o.text)return null;let e=o.tags.indexOf("summary");return -1===e?null:o.text[e]})();v.current||(j.current=b);let w=(0,m.useCallback)(()=>{var e;o.xposts&&(null===(e=o.xposts)||void 0===e?void 0:e.length)>0&&u({type:"xPosts",data:o.xposts})},[null===(t=o.xposts)||void 0===t?void 0:t.length]);(o.webSearchResults&&o.webSearchResults.length>0||(null==y?void 0:y.action)==="browse_page"||o.xposts&&o.xposts.length>0)&&(v.current=!0);let N=l?{delay:.2,duration:.2,ease:"easeIn"}:{},I=null!==(a=null===(s=j.current)||void 0===s?void 0:s.split("\n").filter(Boolean))&&void 0!==a?a:[];return(0,n.jsx)(T.M,{children:(0,n.jsxs)("div",{className:(0,f.cn)("flex flex-col gap-1 mt-1","[&_ul]:m-0 marker:text-secondary","[&_a]:text-primary [&_a]:decoration-solid [&_a]:decoration-secondary [&_a]:underline","[&_a:hover]:text-secondary [&_a]:underline-offset-2 [&_a]:font-medium"),children:[I.map((e,t)=>(0,n.jsx)(z.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:N,children:(0,n.jsx)("div",{className:"overflow-x-auto px-5 leading-6",children:(0,n.jsx)(g,{sender:"assistant",webSearchResults:o.webSearchResults||eN,xposts:o.xposts||eN,isNested:!0,children:e})})},"summary-".concat(c,"-").concat(t))),o.webSearchResults&&o.webSearchResults.length>0&&(0,n.jsx)(z.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:N,children:(0,n.jsx)(ew,{decision:y,webSearchResults:o.webSearchResults})},"webresults-".concat(c)),(null==y?void 0:y.action)==="browse_page"&&y.action_input.url&&(0,n.jsx)(z.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:N,children:(0,n.jsx)("div",{className:"flex items-center gap-3 px-5",children:(0,n.jsxs)("div",{className:"text-primary flex justify-start items-start",children:[(0,n.jsx)("div",{className:"min-w-[26px] mt-2",children:(0,n.jsx)(ej.Z,{size:12,className:"text-secondary"})}),(0,n.jsx)("span",{children:(0,n.jsx)(x.cC,{ns:"chat",i18nKey:"super-search-box-step.browse-page",defaults:'Browsing <site>{{url}}</site> for <bold>"{{query}}"</bold>',values:{url:(0,_.b)(y.action_input.url),query:y.action_input.query},components:{site:(0,n.jsx)("a",{href:y.action_input.url,target:"_blank",rel:"noopener noreferrer"}),bold:(0,n.jsx)("strong",{})}})})]})})},"browse_page-".concat(c)),o.xposts&&o.xposts.length>0?(0,n.jsx)(z.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:N,children:(0,n.jsxs)("div",{className:"w-full flex flex-col gap-2 pb-2",children:[(0,n.jsxs)("div",{className:"flex items-center gap-3 px-5",children:[(0,n.jsxs)("div",{className:"text-primary flex justify-start items-start",children:[(0,n.jsx)("div",{className:"min-w-[26px] text-sm mt-0.5 text-secondary font-bold",children:"\uD835\uDD4F"}),(0,n.jsx)("span",{children:(null==y?void 0:null===(i=y.action_input)||void 0===i?void 0:i.query)?(0,n.jsx)(x.cC,{ns:"chat",i18nKey:"super-search-box-step.xposts-with-query",defaults:'Searching on X for <bold>"{{query}}"</bold>',values:{query:null==y?void 0:null===(r=y.action_input)||void 0===r?void 0:r.query},components:{bold:(0,n.jsx)("strong",{})}}):d("super-search-box-step.xposts-without-query","Searching on X for")})]}),(0,n.jsx)(E.zx,{variant:"ghostSecondary",size:"sm",className:"rounded-full transition-all mr-0.5",onClick:w,children:d("See all","See all")})]}),(0,n.jsx)("div",{className:"relative w-full h-full",children:(0,n.jsx)("div",{className:"flex gap-3 w-full h-full items-stretch overflow-x-auto pr-4 pb-2 pl-11",children:o.xposts.map((e,t)=>(0,n.jsx)("div",{className:"w-full",children:(0,n.jsx)(O,{post:e})},t))})})]})},"xposts-".concat(c)):null]})})},eS=(0,m.forwardRef)((e,t)=>{let{responseId:s,className:i,groups:r,isStreaming:a=!1}=e;return(0,n.jsx)("div",{className:(0,f.cn)("w-full h-full overflow-hidden relative flex flex-col items-start border-l border-border-l1 bg-surface-l1",i),children:(0,n.jsx)(ex,{ref:t,children:(0,n.jsx)("div",{className:"flex flex-col pb-5 pt-2",children:r.map(e=>(0,n.jsx)(ek,{group:e,responseId:s,isStreaming:a},e.id))})})})}),ek=e=>{let{responseId:t,group:s,isStreaming:i}=e;return(0,n.jsx)(T.M,{children:(0,n.jsxs)("div",{"data-scrollid":s.id,children:[(0,n.jsx)(z.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:i?{delay:.2,duration:.2,ease:"easeIn"}:{},children:(0,n.jsx)("div",{className:"text-md text-primary font-medium px-6 pt-5",children:s.header})},"title-".concat(s.id)),s.steps.map((e,r)=>(0,n.jsx)("div",{id:"".concat(t,"_section_").concat(r),children:(0,n.jsx)(eI,{stepId:"step_".concat(s.id,"_").concat(r),step:e,isStreaming:i},"step_".concat(r))},"".concat(t,"_section_").concat(r)))]})})};function eC(e){var t;let{response:s,isStreaming:i}=e,{t:r}=(0,x.$G)("chat"),{client:a}=(0,S.useStatsigClient)(),[l,o]=(0,m.useState)(!1),c=(0,m.useRef)(null),[d,u]=(0,m.useState)(),p=(()=>{if(!s.steps)return[];let e=[];return s.steps.forEach((t,n)=>{var i,a,l,o;let c=t.tags.indexOf("header")>-1;if(!c&&0===n){e.push({id:I({header:r("deepsearch-thinking","Thinking"),responseId:null!==(i=s.responseId)&&void 0!==i?i:"",index:n}),header:r("deepsearch-thinking","Thinking"),steps:[t]});return}if(c){let i=(null===(l=t.text)||void 0===l?void 0:l[(null===(a=t.tags)||void 0===a?void 0:a.indexOf("header"))||0])||"";e.push({id:I({header:i,responseId:null!==(o=s.responseId)&&void 0!==o?o:"",index:n}),header:i,steps:[t]});return}e[e.length-1].steps.push(t)}),e})(),h=(0,m.useCallback)(e=>{var t,n;c.current&&(a.logEvent("scroll_to_research_box_section",e,{location:"research-box",responseId:null!==(t=s.responseId)&&void 0!==t?t:"",conversationId:null!==(n=s.conversationId)&&void 0!==n?n:""}),c.current.scrollToId(e),u(e))},[a,s.responseId,s.conversationId]),v=(0,m.useCallback)(()=>{var e,t;let n=!l;a.logEvent("toggle_research_box_wide",n?"wide":"narrow",{location:"research-box",responseId:null!==(e=s.responseId)&&void 0!==e?e:"",conversationId:null!==(t=s.conversationId)&&void 0!==t?t:""}),o(n)},[a,l,s.responseId,s.conversationId]),g=(0,m.useMemo)(()=>p[p.length-1],[p]),y=null!=d?d:null==g?void 0:g.id;return((0,m.useLayoutEffect)(()=>{c.current&&c.current.setScrollToIdHandler(e=>{u(e)})},[null==g?void 0:g.id]),(0,m.useLayoutEffect)(()=>{let e=document.querySelector("div[data-scrollid=menuitem_".concat(d,"]"));e&&e.scrollIntoView({block:"nearest",behavior:"smooth"})},[d]),s.hasImages||(!s.searchingStartTime||["closed","error"].includes(null!==(t=s.state)&&void 0!==t?t:""))&&(!s.steps||0===s.steps.length))?null:(0,n.jsx)("div",{className:(0,f.cn)("relative border border-border-l1 bg-surface-base rounded-2xl overflow-clip h-[500px] transition-[height_1000ms,width_1000ms] mb-4",l?"@[1600px]/mainview:-mx-32 @6xl/mainview:-mx-12 @lg/mainview:-mx-32 @md/mainview:-mx-4 h-[70vh]":"@md/mainview:-mx-4  h-[500px]"),children:(0,n.jsxs)("div",{className:"absolute text-secondary w-full h-full overflow-y-clip flex",children:[(0,n.jsx)(ey,{groups:p,isStreaming:i,isWide:l,visibleLastStep:y,response:s,scrollToSection:h,toggleWide:v}),(0,n.jsx)("div",{className:"gap-3 relative min-h-full w-full h-full",children:(0,n.jsx)("div",{className:"absolute w-full transition-colors overflow-hidden group/trace h-full",children:(0,n.jsx)(eS,{ref:c,responseId:s.responseId,groups:p,showMask:!1,className:"",isStreaming:i,linesCount:20})})})]})})}let eE=[];function e_(e){var t,s,f,v;let{response:g,isStreaming:y,showMarkdown:j,readOnly:b,isModerated:w=!1}=e,{t:N}=(0,x.$G)("chat"),I=(0,l.w)(),S=(0,o.nf)(p.Z("upsertArtifact")),k="human"===g.sender,E=(0,d.F)(e=>e.userSettings.preferences.displayUserMessageMarkdown),_=(0,o.dV)(p.Z("inlineSettings")),R=(0,m.useMemo)(()=>Object.keys(_),[_]),{sender:T,message:z,cardAttachmentsJson:M,hasSearches:A,conversationId:O,responseId:Z,progressReport:U}=g,P=function e(t){var s;let{message:n,isFromUser:i,isStreaming:r,createTime:a,conversationId:l,responseId:o}=t;if(!n)return[{type:"text",body:""}];if(i)return[{type:"text",body:n}];let c=[],d=/<xaiArtifact.*([^\/]>|$)/g.exec(n),p=null!==(s=null==d?void 0:d.index)&&void 0!==s?s:-1,m=n.slice(p);if(p>0&&c.push({type:"text",body:n.slice(0,p)}),-1!==p&&function(e){if(0===e.length||"<"!==e[0])return!1;let t="xaiArtifact";return t.startsWith(e.substring(1).slice(0,t.length))}(m)){let t=m.indexOf(">"),s=m.indexOf("</xaiArtifact>");if(l&&o&&-1===t)return c.push({type:"artifact",conversationId:l,responseId:o,incomplete:-1===s,timestamp:a?(0,u.h)(a):void 0}),c;{let{title:t,language:n,id:d,contentType:p,versionId:x,content:h}=(0,el.u)(m);if(l&&o&&-1===s)return c.push({id:null!=d?d:void 0,versionId:x,type:"artifact",conversationId:l,responseId:o,incomplete:-1===s,contentType:null!=p?p:void 0,title:null!=t?t:void 0,content:h,language:null!=n?n:void 0,timestamp:a?(0,u.h)(a):void 0}),c;{let[,...f]=m.split("</xaiArtifact>"),v=f.join("</xaiArtifact>");return(l&&o&&c.push({type:"artifact",id:null!=d?d:void 0,versionId:x,incomplete:-1===s,conversationId:l,responseId:o,content:h,contentType:null!=p?p:void 0,title:null!=t?t:void 0,language:null!=n?n:void 0,timestamp:a?(0,u.h)(a):void 0}),v)?[...c,...e({message:v,isFromUser:i,isStreaming:r,createTime:a,conversationId:l,responseId:o})]:c}}}return[{type:"text",body:n}]}({message:null!=z?z:"",isFromUser:k,isStreaming:y,createTime:g.createTime,responseId:null!==(f=g.inflightResponseId)&&void 0!==f?f:Z,conversationId:O});(0,m.useEffect)(()=>{P.forEach(e=>{"artifact"===e.type&&S(e,null!=O?O:"")})},[P]);let H=y?h._I:h.Cn,F="optimistic"===g.state,L=(0,m.useMemo)(()=>{var e,t,s;return"closed"!==g.state&&"error"!==g.state&&!!g.state&&(null===(e=g.thinkingTrace)||void 0===e||!e.length)&&(null===(t=g.message)||void 0===t||!t.length)&&(null===(s=g.steps)||void 0===s||!s.length)&&!g.hasImages},[g.message,g.hasImages,g.state,g.thinkingTrace,null===(t=g.steps)||void 0===t?void 0:t.length]),G=(0,m.useMemo)(()=>(0,c.V1)(g),[g.thinkingStartTime,g.searchingStartTime]),D=!k||(null!=j?j:E),B=(null===(s=g.generatedImageUrls)||void 0===s?void 0:s.length)||Object.keys(null!==(v=g.streamingImageById)&&void 0!==v?v:{}).length,$=!k&&!!B,{uniqueXPosts:W,uniqueWebSearchResults:K,uniqueBrowsedUrls:V}=C(g),X=(0,m.useMemo)(()=>(null==U?void 0:U.state)==="PROGRESS_REPORT_STATUS_PENDING"&&(null==U?void 0:U.category)?U.category:A?"SEARCHING":void 0,[A,U]);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Y,{response:g,isStreaming:y}),I?(0,n.jsx)(q,{response:g,isStreaming:y},g.responseId):(0,n.jsx)(eC,{response:g,isStreaming:y},g.responseId),(0,n.jsx)(r.sZ,{webSearchResults:K,xPosts:W,browsedUrls:V}),L&&!G&&(0,n.jsx)("div",{className:"flex flex-row gap-1 mb-1 text-xl",children:(0,n.jsx)(a.S,{state:X})}),M&&M.length>0&&(0,n.jsx)("div",{className:"flex flex-col space-y-3",children:M.map((e,t)=>(0,n.jsx)(i.p,{cardAttachmentJson:e},"".concat(g.responseId,"-card-").concat(t)))}),(0,n.jsx)(eo.k,{response:g,isStreaming:y,numImages:y?g.imageAttachmentCount||c._w:B||0,readOnly:b}),P.map((e,t)=>{if($)return null;if("artifact"===e.type){let s={...e};return s.id&&R.includes(s.id)&&(s.isInline=!0),(0,n.jsx)("div",{className:"py-1",children:(0,n.jsx)(er,{artifact:s,isStreaming:y,readOnly:null!=b&&b})},t)}if(D){var s;return(0,n.jsx)(H,{sender:T||"",webSearchResults:K||eE,xposts:W||eE,hideCitations:!!(null===(s=g.steps)||void 0===s?void 0:s.length),children:e.body},t)}return(0,n.jsx)("span",{className:"whitespace-pre-wrap",children:null==e?void 0:e.body},t)}),!y&&!F&&!$&&!L&&!w&&!g.message&&(0,n.jsx)("p",{className:"text-secondary italic",children:N("No response","No response")+"."}),w&&(0,n.jsx)("p",{className:"text-secondary italic",children:N("Content Moderated","Content Moderated. Try a different idea.")}),"reconnecting"===g.state&&(0,n.jsx)("p",{className:"text-secondary italic",children:N("Reconnecting...","Reconnecting...")})]})}},48737:function(e,t,s){s.d(t,{E:function(){return eS}});var n=s(2899),i=s(85792),r=s(76038),a=s(49810),l=s(60250),o=s(4694),c=s(70702);let d=e=>{let{response:t}=e,{t:s}=(0,c.$G)("chat"),{ASSET_SERVER_URL:d}=(0,r.O)(),u=t?(0,a.Vh)(d,t.imageEditUri):void 0,[p,m]=o.useState(!1),x=(0,o.useMemo)(()=>p?Error(s("Failed to load image","Failed to load image")):void 0,[p,s]);return(0,n.jsxs)("div",{className:"h-auto flex items-center rounded-xl gap-3",children:[(0,n.jsx)(l.Z,{className:"text-fg-secondary size-4"}),(0,n.jsx)("figure",{className:"size-10 overflow-hidden rounded-lg flex items-center justify-center",children:p?(0,n.jsx)(i.j,{fileName:"",labelClassName:"-ml-2",metadata:x}):(0,n.jsx)("img",{className:"w-full h-full object-cover",src:u,alt:s("Original image to edit","Original image to edit"),onError:()=>m(!0)})})]})};var u=s(14714),p=s(75243),m=s(46520),x=s(6087),h=s(75260),f=s(78394),v=s(34116),g=s(27763),y=s(37446),j=s(94408),b=s(69198),w=s(81211),N=s(89463),I=s(33263),S=s(18486),k=s(3453),C=s(74542),E=s(72242),_=s(3189),R=s(13771),T=s(73197),z=s(43701),M=s(74239),A=s(67894),O=s.n(A),Z=s(44199),U=s(69454),P=s(39650),H=s(40881),F=s(14075),L=s(56672),G=s(74036),D=s(98118),B=s(6138),$=s(75361),W=s(69492),q=s(34415),K=s(95506),V=s(30430),Y=s(42032),X=s(82112);function J(e){let{response:t}=e,s=t.message;if(t.metadata&&"artifactAction"in t.metadata){let e=t.metadata.artifactAction;"ask"===e?s=(0,n.jsx)(Q,{message:t.message}):"explain"===e&&(s=(0,n.jsx)(ee,{}))}return(0,n.jsx)(X.V,{isUser:!0,children:(0,n.jsx)(Y.Y,{isUser:!0,children:s})})}function Q(e){let{message:t}=e,{t:s}=(0,c.$G)("chat");return(0,n.jsxs)("div",{children:[(0,n.jsxs)(et,{children:[(0,n.jsx)(l.Z,{size:12}),s("artifact-action.ask","Ask Grok")]}),(0,n.jsx)("div",{children:t})]})}function ee(){let{t:e}=(0,c.$G)("chat");return(0,n.jsxs)(et,{children:[(0,n.jsx)(V.Z,{size:12}),e("artifact-action.explain","Explain")]})}function et(e){let{children:t}=e;return(0,n.jsx)("header",{className:"text-secondary text-sm flex items-center gap-1 pt-1",children:t})}var es=s(15571);function en(e){let{initialMessage:t,onCancel:s,onSave:i}=e,{t:r}=(0,c.$G)("chat"),[a,l]=(0,o.useState)(t),d=(0,o.useRef)(null),u=(0,N.r)(),p=(0,o.useCallback)(e=>{l(e.target.value)},[]),m=(0,o.useCallback)(()=>{i(a)},[i,a]),x=(0,o.useCallback)(e=>{let t=!e.metaKey&&!e.ctrlKey&&!e.shiftKey,s=!e.nativeEvent.isComposing&&"Process"!==e.key&&"KeyZ"!==e.code;if("Enter"===e.key&&t&&s&&!u){e.preventDefault(),m();return}},[m,u]),h=(0,o.useCallback)(e=>{let t=e.target.value;e.target.value="",e.target.value=t},[]);return(0,n.jsxs)("div",{className:"flex flex-col w-full gap-2",children:[(0,n.jsx)(es.Z,{dir:"auto",ref:d,autoFocus:!0,className:(0,E.cn)("w-screen max-w-[100%]","bg-transparent","focus:outline-none","text-primary"),placeholder:r("Enter prompt here","Enter prompt here"),style:{resize:"none"},onKeyDown:x,onChange:p,defaultValue:t,onFocus:h}),(0,n.jsxs)("div",{className:"flex flex-row justify-end w-full gap-2 p-1",children:[(0,n.jsx)(v.zx,{variant:"ghost",size:"sm",onClick:s,children:r("Cancel","Cancel")}),(0,n.jsx)(v.zx,{variant:"primary",size:"sm",onClick:m,children:r("Save","Save")})]})]})}var ei=s(50121),er=s(97404),ea=s(87325),el=s(31477),eo=s(34101),ec=s(46150),ed=s(76072),eu=s(26602),ep=s(50516);let em=[{icon:(0,n.jsx)(el.Z,{height:14,width:14}),label:(0,ea.t)("Wanted something else",{defaultValue:"Wanted something else"}),type:"wanted-something-else"},{icon:(0,n.jsx)(eo.Z,{height:14,width:14}),label:(0,ea.t)("Incorrect answer",{defaultValue:"Incorrect answer"}),type:"incorrect-answer"},{icon:(0,n.jsx)(ec.Z,{height:14,width:14}),label:(0,ea.t)("Biased answer",{defaultValue:"Biased answer"}),type:"biased-answer"},{icon:(0,n.jsx)(ed.Z,{height:14,width:14}),label:(0,ea.t)("Wanted image",{defaultValue:"Wanted image"}),type:"wanted-image"},{icon:(0,n.jsx)(eu.Z,{height:14,width:14}),label:(0,ea.t)("Bad style / tone",{defaultValue:"Bad style / tone"}),type:"bad-style"},{icon:(0,n.jsx)(ep.Z,{height:14,width:14}),label:(0,ea.t)("Wanted to search",{defaultValue:"Wanted to search"}),type:"wanted-search"}];function ex(e){let{handleClickDislike:t,triggerButton:s,showDropdown:i}=e,[r,a]=o.useState(!1);return(0,n.jsxs)(er.h_,{open:r,onOpenChange:e=>{!i&&e&&t(),a(e&&i)},children:[(0,n.jsx)(er.$F,{asChild:!0,children:s}),(0,n.jsx)(er.AW,{side:"bottom",align:"end",sideOffset:6,className:"min-w-36 space-y-0.5",children:em.map(e=>(0,n.jsxs)(er.Xi,{onClick:()=>{t(e.type)},className:(0,E.cn)("flex items-center gap-2"),children:[e.icon,e.label]},e.label))})]})}var eh=s(29084),ef=s(7426),ev=s(83376),eg=s(8781),ey=s(4077);function ej(e){var t,s,i;let{response:r,followUpSuggestedMode:a,className:l}=e,{t:d}=(0,c.$G)("base"),u=(0,w.g)(),{client:p}=(0,M.useStatsigClient)(),m=(0,eg.w)(),x=(0,ev.X)(),h=(0,W.gK)(L.Z("isDeepSearchRateLimited")),f=(0,W.gK)(L.Z("isThinkingRateLimited")),g=(0,W.gK)(L.Z("lastMessageId")),{mode:y,mobile:j,web:b}=a,{modelById:N}=(0,ey.bP)(),I=(0,W.gK)(L.Z("activeModelId")),S=null==N?void 0:N[I],k=(0,o.useCallback)(async()=>{try{let e=W.gK.getState(),t=T.CI.getState();if(await x(),!e.conversationId)throw Error("No conversation id");let s=r.parentResponseId?t.byId[r.parentResponseId]:void 0;if(!s)throw Error("No source parent response message");if("SEARCH"===y)e.setReasoningMode("deepsearch");else if("THINK"===y)e.setReasoningMode("think");else throw Error("Invalid follow up suggested mode");return p.logEvent("follow_up_suggested_mode_button_clicked",r.responseId,{responseId:r.responseId,parentResponseId:s.responseId,conversationId:e.conversationId,followUpSuggestedMode:y}),e.sendResponse({message:s.message,enableRetries:u.ENABLE_AUTO_STREAM_RETRY,parentResponseId:e.lastMessageId,conversationId:e.conversationId,fileAttachmentIds:s.fileAttachments,webpageUrls:s.webpageUrls,setOpimisticUserResponse:!0,setUserResponse:!0})}catch(e){(0,C.H)("search-deeper-button",e),$.Am.error(d("follow-up-suggested-mode.error","Something went wrong while following up"))}},[r,p,y,u,x,d]);if(!S||r.responseId!==g||!y)return null;let _=null===(t=S.tags)||void 0===t?void 0:t.includes("deepsearch"),R=null===(s=S.tags)||void 0===s?void 0:s.includes("think");if(u.DISABLE_RESEARCH_TOGGLE||"SEARCH"===y&&(!_||h)||"THINK"===y&&(!R||f))return null;let z=null!==(i=m?j:b)&&void 0!==i?i:"SEARCH"===y?d("follow-up-suggested-mode.deepsearch","Search deeper"):d("follow-up-suggested-mode.think","Think deeper"),A="SEARCH"===y?ef.G:eh.Z;return(0,n.jsx)("div",{className:(0,E.cn)("flex justify-center w-full sm:w-auto",l),children:(0,n.jsxs)(v.zx,{variant:"card",size:"pill",onClick:k,children:[(0,n.jsx)(A,{size:20}),(0,n.jsx)("span",{children:z})]})})}var eb=s(725),ew=s(38372);let eN=[],eI="opacity-0 group-focus-within:opacity-100 group-hover:opacity-100 [.last-response_&]:opacity-100 disabled:opacity-0 group-focus-within:disabled:opacity-60 group-hover:disabled:opacity-60 [.last-response_&]:disabled:opacity-60",eS=(0,o.memo)(e=>{var t,s;let{responseFamily:i=eN,selectedId:r,streamingResponse:a,onPivotResponse:l,onEditSubmit:A,readOnly:V,isIncognito:Q,queryBarHeight:ee,isLastResponse:et}=e,{t:es,i18n:er}=(0,c.$G)("chat"),ea=(0,N.r)(),el=(0,w.g)(),{client:eo}=(0,M.useStatsigClient)(),[ec,ed]=(0,o.useState)(),[eu,ep]=(0,o.useState)(),[em,eh]=(0,o.useState)(!1),ef=(0,o.useRef)(null),ev=(0,W.gK)(L.Z("usingExperiment")),eg=(0,_.a)(L.Z("fetchGetAsset")),ey=(0,W.gK)(L.Z("isRateLimited")),eS=(0,W.gK)(L.Z("experiments")),ek=(0,F.usePathname)(),eE=null==ek?void 0:ek.includes("/share/"),[e_,eR]=(0,o.useState)(!1),[eT,ez]=(0,o.useState)(!1),eM=(0,o.useMemo)(()=>i.findIndex(e=>e.responseId===r),[i,r]),eA=null===(t=i[eM])||void 0===t?void 0:t.responseId;if(!eA)throw Error("Response not found in family");let eO=(0,T.CI)(e=>e.byId[eA]);if(a&&(eO.streamingImageById=a.streamingImageById),!eO)throw Error("Response not found");let eZ=(0,R.t)(e=>eO.conversationId?e.byId[eO.conversationId]:void 0),{getPersonaForConversation:eU}=(0,I.HG)(),eP=eU(eZ),[eH,eF]=(0,o.useState)({}),eL=(0,o.useCallback)(()=>{var e;null===(e=eO.fileAttachments)||void 0===e||e.forEach(e=>{e in eH||eg({assetId:e}).then(t=>{eF(G.Z(D.Z(e),t))}).catch(k.xo)})},[eO,eH]);(0,o.useEffect)(()=>{eL()},[eO]),(0,o.useEffect)(()=>{eF({})},[r,ev]);let eG=(0,o.useCallback)(e=>{eF(t=>B.Z(e.assetId)(t))},[eF]),{resolvedTheme:eD}=(0,H.F)(),eB="dark"===eD,e$=(0,o.useMemo)(()=>Object.values(eH),[eH]),[eW,eq]=(0,o.useState)(eO.webpageUrls),eK=(0,o.useCallback)(e=>{eq(t=>t.filter(t=>t!==e)||[])},[]),eV="human"===eO.sender,eY=(0,o.useMemo)(()=>!!(eO.error&&eO.error.includes("content-moderated")),[eO.error]),eX=(0,o.useCallback)(async()=>{let e=i[eM-1];l&&e&&(eo.logEvent("pivot_prev_response",eO.responseId,{location:"chat-response",responseId:eO.responseId,conversationId:eO.conversationId}),ep("prev"),await l(e.responseId),ep(void 0))},[l,eM,i,eO,eo]),eJ=(0,o.useCallback)(async()=>{let e=i[eM+1];l&&e&&(eo.logEvent("pivot_next_response",eO.responseId,{location:"chat-response",responseId:eO.responseId,conversationId:eO.conversationId}),ep("next"),await l(e.responseId),ep(void 0))},[l,eM,i,eO,eo]),eQ=(0,o.useCallback)(()=>{ez(!0);let e=(0,K.l)(eO.message);navigator.clipboard.writeText(e).catch(e=>$.Am.error(e.message)),setTimeout(()=>ez(!1),1e3),eo.logEvent("copy_response",eO.responseId,{location:"response-family",responseId:eO.responseId,conversationId:eO.conversationId})},[eO,eo,er.resolvedLanguage]),e0=(0,o.useCallback)(()=>{eR(e=>!e),eo.logEvent("edit_response",eO.responseId,{location:"chat-response",responseId:eO.responseId,conversationId:eO.conversationId})},[eO,eo]),e1=(0,o.useCallback)(async()=>{var e,t;let s=W.gK.getState(),n=z.F.getState();eo.logEvent("regenerate_response",eO.responseId,{location:"chat-response",responseId:eO.responseId,conversationId:eO.conversationId,fileAttachments:String((null===(e=eO.fileAttachments)||void 0===e?void 0:e.length)||0),webpageUrls:String((null===(t=eO.webpageUrls)||void 0===t?void 0:t.length)||0),outputMode:s.outputMode,reasoningMode:s.reasoningMode,personalityId:n.userSettings.preferences.selectedSystemPromptId||"",personaId:(null==eP?void 0:eP.personaId)||""}),s.sendResponse({message:"",parentResponseId:eO.parentResponseId,conversationId:eO.conversationId,fileAttachmentIds:eO.fileAttachments||[],webpageUrls:eO.webpageUrls,setOpimisticUserResponse:!1,setUserResponse:!1,persona:eP,enableRetries:el.ENABLE_AUTO_STREAM_RETRY}).then(e=>{e.length||(0,C.H)("response-family:handleClickRegenerate","Failed to regenerate model response")}).catch(e=>{(0,C.H)("response-family:handleClickRegenerate",e)})},[eP,eO,eo,el.ENABLE_AUTO_STREAM_RETRY]),{data:e2}=(0,S.ri)(eO.conversationId,eE),e4=String(!O()(null==e2?void 0:e2.length)),e5=(0,o.useCallback)(()=>{ed(e=>"like"===e?void 0:"like"),eo.logEvent("like_response",eO.responseId,{location:"response-family",message:eO.message,generatedImageUrls:eO.generatedImageUrls.join(","),responseId:eO.responseId,conversationId:eO.conversationId,hasWorkspace:e4})},[eO,eo,e4]),e3=(0,o.useCallback)(e=>{ed(e=>"dislike"===e?void 0:"dislike"),eo.logEvent("dislike_response",eO.responseId,{location:"response-family",message:eO.message,generatedImageUrls:eO.generatedImageUrls.join(","),responseId:eO.responseId,conversationId:eO.conversationId,type:null!=e?e:"type-unspecified",hasWorkspace:e4})},[eO,eo,e4]),e6=(0,z.F)(e=>e.userSettings.preferences.displayUserMessageMarkdown),[e7]=(0,o.useState)(e6),e8=(0,o.useCallback)(e=>{if(!eO.conversationId){(0,C.H)("response-family:handleEditSave","No conversation id found");return}null==A||A(eO.responseId);let t=W.gK.getState(),s=z.F.getState();eo.logEvent("edit_response_submit",eO.responseId,{location:"chat-response",responseId:eO.responseId,conversationId:eO.conversationId,fileAttachments:String(Object.keys(eH).length||0),webpageUrls:String(eW.length||0),outputMode:t.outputMode,reasoningMode:t.reasoningMode,personalityId:s.userSettings.preferences.selectedSystemPromptId||"",personaId:(null==eP?void 0:eP.personaId)||""}),t.sendResponse({message:e,parentResponseId:eO.parentResponseId,conversationId:eO.conversationId,fileAttachmentIds:Object.keys(eH),webpageUrls:eW,setOpimisticUserResponse:!0,setUserResponse:!0,persona:eP,enableRetries:el.ENABLE_AUTO_STREAM_RETRY}).then(e=>{e.length||(0,C.H)("response-family:handleEditSave","Failed to response to edit")}).catch(e=>{(0,C.H)("response-family:handleEditSave",e)}).finally(()=>eR(!1))},[eP,eO,eH,eW,el.ENABLE_AUTO_STREAM_RETRY]),e9=(0,o.useCallback)(()=>{eR(!1),eL(),eq(eO.webpageUrls||[])},[eL,eO.webpageUrls]),te=(0,o.useCallback)((e,t)=>{let s=eS[e],n=eS[0==e?1:0];eo.logEvent("user_side_by_side_preference",(null==s?void 0:s.responseId)||"",{index:e.toString(),nonPreferredResponseId:(null==n?void 0:n.responseId)||"",conversationId:(null==s?void 0:s.conversationId)||""});let i=W.gK.getState();i.setLastMessageId(null==t?void 0:t.responseId),i.setStreamedMessageId(""),i.setUsingExperiment(!1)},[eS,eo]);if((0,o.useEffect)(()=>{if(!ef.current)return;let e=new IntersectionObserver(e=>{let[t]=e;eh(t.isIntersecting)},{root:null,rootMargin:"0px",threshold:0}),t=document.createElement("div");return t.style.height="1px",t.style.position="absolute",t.style.bottom="0",t.style.zIndex="1000",ef.current.appendChild(t),e.observe(t),()=>{var s;e.unobserve(t),null===(s=ef.current)||void 0===s||s.removeChild(t),e.disconnect()}},[r]),null!=eA&&ev&&(null==eS?void 0:eS.some(e=>(null==e?void 0:e.responseId)===eA)))return(0,n.jsx)(m.S,{fallbackRender:eC({isUser:eV}),children:(0,n.jsx)(q.C,{children:eS.map((e,t)=>(0,n.jsx)(q.L,{index:t,response:e,isStreaming:!1,onClickPrefer:te},t))})});if(eO.metadata&&"artifactAction"in eO.metadata)return(0,n.jsx)(m.S,{fallbackRender:eC({isUser:eV}),children:(0,n.jsx)(J,{response:eO})});let tt=()=>(0,n.jsx)(v.g$,{"aria-label":es("response-action.copy","Copy"),tooltipContent:eT?(0,n.jsx)("p",{children:es("Copied!","Copied!")}):(0,n.jsx)("p",{children:es("Copy","Copy")}),tooltipContentProps:{side:"bottom"},variant:"ghostSecondary",size:ea?"iconXl":"iconMd",onClick:eQ,className:eI,children:(0,n.jsx)(g.k,{children:eT?(0,n.jsx)(Z.Z,{className:"size-4"}):(0,n.jsx)(x.TI,{className:"size-4"})},eT?"copied":"copy")});return(0,n.jsx)(m.S,{fallbackRender:eC({isUser:eV}),children:(0,n.jsxs)(X.V,{isUser:eV,ref:ef,children:[(0,n.jsx)(p.c,{hidden:!0}),(0,n.jsx)(Y.Y,{isUser:eV,isIncognito:Q,children:!V&&e_?(0,n.jsx)(en,{initialMessage:eO.message,onCancel:e9,onSave:e8}):(0,n.jsx)(eb.i,{readOnly:V,response:eO,isStreaming:"streaming"===eO.state||"reconnecting"===eO.state,showMarkdown:eV?e7:void 0,isModerated:eY})}),(0,n.jsx)(u.et,{response:eO}),e$.length>0?(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"flex flex-row flex-wrap justify-end gap-2 mt-2",children:[eE&&(0,n.jsxs)(j.u,{children:[(0,n.jsx)(j.aJ,{className:"focus:outline-none focus:ring-1 ring-ring rounded-xl",children:(0,n.jsx)(U.Z,{size:18,className:"cursor-default text-secondary"})}),(0,n.jsx)(j._v,{side:"bottom",children:(0,n.jsx)("p",{className:"my-1 text-sm text-right",children:es("Attachments are hidden for privacy considerations","Attachments are hidden for privacy considerations")})})]}),e$.map(e=>(0,n.jsx)(f.k,{asset:e,onRemoveAsset:e_?eG:void 0,isShared:eE,allowCompact:!0},e.assetId))]})}):null,eO.imageEditUri&&(null!==(s=e$.length)&&void 0!==s?s:0)===0?(0,n.jsx)(d,{response:eO}):null,el.ENABLE_WEBPAGE_ATTACHMENTS&&(null==eW?void 0:eW.length)>0?(0,n.jsx)(n.Fragment,{children:(0,n.jsx)("div",{className:"flex flex-row flex-wrap justify-end gap-2 mt-2",children:eW.map(e=>(0,n.jsx)(b.X,{url:e,onDetachUrl:e_?eK:void 0},"".concat(eO.responseId,"-").concat(e)))})}):null,eO.error&&!eY&&(0,n.jsx)("div",{className:"flex mt-2 -ml-5",children:(0,n.jsx)(ei.i,{title:es("Grok was unable to finish replying.errorMessage","Grok was unable to finish replying."),description:es("Grok was unable to finish replying.description","Please try again later or use a different model."),className:eV?"md:mr-0":"ml-4",onRetry:e1})}),!e_&&!ev&&(0,n.jsx)("div",{className:(0,E.cn)("order-first sticky hidden @xl/mainview:-top-3"," @[960px]/mainview:block","top-11 h-0 opacity-0 group-focus-within:opacity-100 group-hover:opacity-100","-mt-2",eV?"-mr-[36px] @lg/mainview:-mr-12":"-ml-[50px] -left-[26px]"),children:(0,n.jsxs)("div",{className:"min-h-7 py-4 flex flex-col gap-0.5",children:[!em&&eV&&!V&&(0,n.jsx)(v.g$,{tooltipContent:es("Edit","Edit"),tooltipContentProps:{side:eV?"right":"left"},variant:"ghostSecondary",size:ea?"iconXl":"iconMd",onClick:e0,"aria-label":es("response-action.edit","Edit"),disabled:ey,children:(0,n.jsx)(g.k,{children:(0,n.jsx)(x.Mw,{className:"size-4"})},"edit")}),!em&&(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(v.g$,{tooltipContent:eT?(0,n.jsx)("p",{children:es("Copied!","Copied!")}):(0,n.jsx)("p",{children:es("Copy","Copy")}),tooltipContentProps:{side:eV?"right":"left"},variant:"ghostSecondary",size:ea?"iconXl":"iconMd",onClick:eQ,children:(0,n.jsx)(g.k,{children:eT?(0,n.jsx)(Z.Z,{className:"size-4"}):(0,n.jsx)(x.TI,{className:"size-4"})},eT?"copied":"copy")})})]})}),!e_&&!ev&&(0,n.jsxs)("div",{className:(0,E.cn)("flex flex-row flex-wrap w-full",eV?"justify-end":"justify-between",et?"last-response":""),children:[(0,n.jsxs)("div",{className:(0,E.cn)("flex items-center gap-[2px] w-max","rounded-lg text-xs bg-background","pb-2 px-2",eV?"end-4 -mr-2":"start-0 md:start-3 -ml-4",ea&&"-mt-2 opacity-100"),style:{bottom:"".concat(ee,"px")},children:[!V&&eV?(0,n.jsx)(v.g$,{tooltipContent:(0,n.jsx)("p",{children:es("Edit","Edit")}),tooltipContentProps:{side:"bottom"},variant:"ghostSecondary","aria-label":es("response-action.edit","Edit"),size:ea?"iconXl":"iconMd",onClick:e0,disabled:ey,className:eI,children:(0,n.jsx)(g.k,{children:(0,n.jsx)(x.Mw,{className:"size-4"})},"edit")}):null,eV?tt():null,i.length>1?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(v.g$,{tooltipContent:(0,n.jsx)("p",{children:es("go to previously sent message","Previous message")}),tooltipContentProps:{side:"bottom"},variant:"ghostSecondary","aria-label":es("go to previously sent message","Previous message"),size:ea?"iconXl":"iconMd",disabled:0===eM||"prev"===eu,onClick:eX,children:(0,n.jsx)(g.k,{children:"prev"===eu?(0,n.jsx)(y.$,{size:"xs"}):(0,n.jsx)(x.wy,{size:20})},"prev"===eu?"loading":"prev")}),(0,n.jsxs)("span",{className:(0,E.cn)("px-0.5"),children:[eM+1," / ",i.length]}),(0,n.jsx)(v.g$,{tooltipContent:(0,n.jsx)("p",{children:es("go to next sent message","Next message")}),tooltipContentProps:{side:"bottom"},variant:"ghostSecondary","aria-label":es("go to next sent message","Next message"),size:ea?"iconXl":"iconMd",disabled:eM===i.length-1||"next"===eu,onClick:eJ,children:(0,n.jsx)(g.k,{children:"next"===eu?(0,n.jsx)(y.$,{size:"xs"}):(0,n.jsx)(x.XC,{size:20})},"next"===eu?"loading":"next")})]}):null,V||eV?null:(0,n.jsx)(v.g$,{tooltipContent:(0,n.jsx)("p",{children:es("Regenerate","Regenerate")}),tooltipContentProps:{side:"bottom"},variant:"ghostSecondary","aria-label":"Regenerate",size:ea?"iconXl":"iconMd",disabled:ey,onClick:e1,className:eI,children:(0,n.jsx)(g.k,{children:(0,n.jsx)(x.Iy,{className:"size-4"})},"regenerate")}),eV?null:tt(),!V&&!eV&&(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(ew.T,{variant:"ghostSecondary",size:ea?"iconXl":"iconMd",conversationId:eO.conversationId,responseId:eO.responseId,iconProps:{className:"size-4"},className:eI})}),!V&&eO.memoryReferences&&(0,n.jsx)(h.Q,{responseId:eO.responseId,memoryReferences:eO.memoryReferences,className:eI}),!V&&!eV&&(0,n.jsx)(v.g$,{"aria-label":es("response-action.like","Like"),tooltipContent:(0,n.jsx)("p",{children:es("Love this","Love this")}),tooltipContentProps:{side:"bottom"},variant:"ghostSecondary",size:ea?"iconXl":"iconMd",onClick:e5,className:eI,children:(0,n.jsx)(g.k,{children:"like"===ec?(0,n.jsx)(x.lb,{className:(0,E.cn)("size-4 text-green-500",{"fill-green-200":eB,"fill-green-100":!eB})}):(0,n.jsx)(x.lb,{className:"size-4"})},"like"===ec?"like":"dislike")}),!V&&!eV&&(0,n.jsx)(ex,{handleClickDislike:e3,showDropdown:"dislike"!==ec,triggerButton:(0,n.jsx)(v.g$,{"aria-label":es("response-action.dislike","Dislike"),variant:"ghostSecondary",size:ea?"iconXl":"iconMd",tooltipContent:(0,n.jsx)("p",{children:es("Needs improvement","Needs improvement")}),tooltipContentProps:{side:"bottom"},className:eI,children:(0,n.jsx)(g.k,{children:"dislike"===ec?(0,n.jsx)(x.kZ,{className:(0,E.cn)("size-4 text-blue-500",{"fill-blue-200":eB,"fill-blue-100":!eB})}):(0,n.jsx)(x.kZ,{className:"size-4"})},"dislike"===ec?"dislike":"like")})}),!V&&!eV&&el.SHOW_RESPONSE_LOAD_TIMER&&null!=eO.generationTimeMs&&(0,n.jsx)("div",{className:(0,E.cn)("px-1 text-secondary",eI),children:es("response-generation-time-seconds",{count:eO.generationTimeMs/1e3,defaultValue_one:"{{count, number(maximumFractionDigits: 2)}}s",defaultValue_other:"{{count, number(maximumFractionDigits: 2)}}s"})}),!eV&&eO.partial&&(0,n.jsxs)("div",{className:(0,E.cn)("flex items-center gap-1 px-1 text-secondary",eI),children:[(0,n.jsx)(P.Z,{size:16}),es("Interrupted","Interrupted")]})]}),el.SHOW_SEARCH_DEEPER&&eO.followUpSuggestedMode&&(0,n.jsx)(ej,{response:eO,followUpSuggestedMode:eO.followUpSuggestedMode,className:eI})]})]})})},(e,t)=>{var s,n;return e.onPivotResponse===t.onPivotResponse&&e.selectedId===t.selectedId&&(null===(s=e.responseFamily)||void 0===s?void 0:s.map(e=>e.responseId).join(","))===(null===(n=t.responseFamily)||void 0===n?void 0:n.map(e=>e.responseId).join(","))&&e.queryBarHeight===t.queryBarHeight&&e.isLastResponse===t.isLastResponse});function ek(e){let{isUser:t}=e,{t:s}=(0,c.$G)("chat");return(0,n.jsx)(X.V,{isUser:t,children:(0,n.jsx)(Y.Y,{isUser:t,children:(0,n.jsx)("p",{children:s("Something went wrong rendering this message","Something went wrong rendering this message")})})})}function eC(e){let{isUser:t}=e;return e=>{let{error:s,resetErrorBoundary:i}=e;return(0,n.jsx)(ek,{isUser:t,error:s,resetErrorBoundary:i})}}eS.displayName="ResponseFamily"},14714:function(e,t,s){s.d(t,{Ou:function(){return k},et:function(){return _}});var n=s(2899),i=s(69492),r=s(26777),a=s(34116),l=s(77119),o=s(4694);let c={};function d(e,t){let s=(0,o.useRef)("function"==typeof t?t():t).current,[n,i]=(0,o.useState)(()=>{try{let t=window.sessionStorage.getItem(e);return t?JSON.parse(t):s}catch(e){return console.error("Error parsing sessionStorage value:",e),s}});return(0,o.useEffect)(()=>{let t=e=>{i(e)};return c[e]||(c[e]=[]),c[e].push(t),()=>{c[e]&&(c[e]=c[e].filter(e=>e!==t))}},[e]),(0,o.useEffect)(()=>{let t=t=>{if(t.key===e&&t.storageArea===window.sessionStorage){if(null!==t.newValue)try{i(JSON.parse(t.newValue))}catch(e){console.error("Error parsing storage event value:",e)}else i(s)}};return window.addEventListener("storage",t),()=>{window.removeEventListener("storage",t)}},[e,s]),[n,t=>{try{let s="function"==typeof t?t(n):t;window.sessionStorage.setItem(e,JSON.stringify(s)),i(s),c[e]&&c[e].forEach(e=>e(s))}catch(e){console.error("Error setting sessionStorage value:",e)}}]}var u=s(14901),p=s(20592),m=s(72242),x=s(46913),h=s(73197),f=s(67206),v=s(30722),g=s.n(v),y=s(41916),j=s(56672),b=s(70702);let w="HcydF4kDI5",N=["QHguYWk=","QHRlYWNoeC5haQ=="],I=new Set(["amRsb3Zlc3RoaXNAZ21haWwuY29t","bWF0dGJzcmlAZ21haWwuY29t"]);function S(){let{user:e}=(0,r.kP)(),[t]=d(w,!1),s=null==e?void 0:e.email;return!!(s&&(I.has(s)||N.some(e=>s.endsWith(atob(e)))))&&!t}function k(){let{t:e}=(0,b.$G)("base"),[,t]=d(w,!1),{isChatPage:s,isSharePage:i,pageData:r}=(0,l.o)();return S()?(0,n.jsxs)("div",{className:"absolute top-0 right-1/2 translate-x-1/2 z-50 flex items-center gap-0",children:[s&&(0,n.jsx)(E,{}),i&&(null==r?void 0:r.shareLinkId)&&(0,n.jsx)(C,{shareLinkId:r.shareLinkId}),(0,n.jsx)(a.zx,{variant:"ghost",size:"iconSm",onClick:()=>{t(!0)},"aria-label":e("debug-menu-close.label","Close"),children:(0,n.jsx)(y.Z,{size:10})})]}):null}function C(e){let{shareLinkId:t}=e,{data:s}=(0,f.aM)({queryKey:["share",t],queryFn:()=>(0,u.z)(t,x.xU)});return s?(0,n.jsxs)("div",{className:"text-red-600 font-normal text-xs flex flex-row gap-1",children:[(0,n.jsx)("span",{children:"convo id: "}),(0,n.jsx)("span",{className:"block",children:null==s?void 0:s.conversation.conversationId})]}):null}function E(){let e=(0,i.gK)(j.Z("lastMessageId")),t=(0,h.CI)(j.Z("byId"));return(0,n.jsx)(a.zx,{className:"text-red-600 font-normal",variant:"text",size:"none",onClick:()=>{!function(e,t){if(!e){console.error("No last message id");return}let s=t[e];if(!s){console.error("No response for last message id",e);return}let n=new Blob([JSON.stringify((0,p.Bv)(s,t).map(e=>t[e]).map(e=>({role:"human"===e.sender?"user":"assistant",content:e.message,...g().pick(e,"thinkingTrace","steps","generatedImageUrls","metadata")})),null,2)],{type:"application/json"}),i=window.URL.createObjectURL(n);window.open(i,"_blank")}(e,t)},children:"export"})}function _(e){let{response:t}=e;return S()?(0,n.jsxs)("div",{className:(0,m.cn)("absolute text-red-600 font-normal text-xs bottom-[2.5rem]","opacity-0 group-focus-within:opacity-100 group-hover:opacity-100 transition-opacity","flex flex-row gap-1"),children:[(0,n.jsx)("span",{children:"res id: "}),(0,n.jsx)("span",{className:"block",children:t.responseId})]}):null}},75243:function(e,t,s){s.d(t,{c:function(){return a}});var n=s(2899),i=s(34116),r=s(4694);function a(e){let{error:t,hidden:s}=e,[a,l]=(0,r.useState)(!1);if(a){if(t)throw t;throw Error("Triggered error")}return s?null:(0,n.jsx)(i.zx,{className:"absolute top-1/2 left-2 z-[100]",onClick:()=>l(!0),children:"Trigger Error"})}},46520:function(e,t,s){s.d(t,{S:function(){return r}});var n=s(74542);s(4694);var i=s(41105);class r extends i.SV{componentDidCatch(e,t){super.componentDidCatch(e,t),(0,n.H)(t.componentStack||"no stack info",e.message)}constructor(e){super(e)}}},75260:function(e,t,s){s.d(t,{L:function(){return F},Q:function(){return A}});var n=s(2899),i=s(37330),r=s(69492),a=s(77119),l=s(81211),o=s(8781),c=s(89099),d=s(17010),u=s(72242),p=s(46913),m=s(13771),x=s(74239),h=s(67206),f=s(62719),v=s(11286),g=s(66218),y=s(82209),j=s(65671),b=s(13562),w=s(3667),N=s(73069),I=s(56672),S=s(4694),k=s(70702),C=s(75361),E=s(6087),_=s(4710),R=s(34116),T=s(27763);let z=[],M=()=>(0,n.jsxs)("div",{className:"relative w-8 h-8 flex items-center justify-center filter blur-[1.5px]",children:[(0,n.jsx)(w.E.div,{className:"absolute w-4 h-4 rounded-full bg-opacity-90 shadow-lg",style:{background:"radial-gradient(circle at 30% 30%, rgba(255, 255, 255, 0.8) 0%, rgba(255, 255, 255, 0) 70%)",boxShadow:"inset 2px 2px 4px rgba(255, 255, 255, 0.5), inset -2px -2px 4px rgba(0, 0, 0, 0.3)"},animate:{background:["radial-gradient(circle at 30% 30%, rgba(255, 255, 255, 0.8) 0%, rgba(139, 92, 246, 0.8) 50%, rgba(236, 72, 153, 0.8) 100%)","radial-gradient(circle at 30% 30%, rgba(255, 255, 255, 0.8) 0%, rgba(59, 130, 246, 0.8) 50%, rgba(139, 92, 246, 0.8) 100%)","radial-gradient(circle at 30% 30%, rgba(255, 255, 255, 0.8) 0%, rgba(139, 92, 246, 0.8) 50%, rgba(59, 130, 246, 0.8) 100%)","radial-gradient(circle at 30% 30%, rgba(255, 255, 255, 0.8) 0%, rgba(139, 92, 246, 0.8) 50%, rgba(236, 72, 153, 0.8) 100%)"],scale:[1,1.1,1]},transition:{duration:6,ease:"linear",repeat:1/0,times:[0,.33,.66,1]}}),(0,n.jsx)("div",{className:"absolute w-0.5 h-0.5 rounded-full bg-white opacity-5 blur-[2px]",style:{top:"35%",left:"35%"}}),(0,n.jsx)(w.E.div,{className:"absolute w-4 h-4 rounded-full",style:{border:"1px solid rgba(255, 255, 255, 0.3)",boxShadow:"inset 0 0 5px rgba(255, 255, 255, 0.5)"},animate:{opacity:[.7,.5,.7]},transition:{duration:3,ease:"easeInOut",repeat:1/0}})]});function A(e){let{responseId:t,memoryReferences:s,className:i}=e,{t:a}=(0,k.$G)("base"),c=(0,l.g)(),{client:d}=(0,x.useStatsigClient)(),u=(0,r.gK)(I.Z("sidePanelContent")),p=(0,r.gK)(I.Z("setSidePanelContent")),m=(0,o.w)(),h=(0,S.useMemo)(()=>{if((null==u?void 0:u.type)!=="memoryReferences")return!1;let e=u.data.memoryReferences.map(e=>e.conversationId);return s.every((t,s)=>t.conversationId===e[s])&&s.length===e.length},[u,s]),f=(0,S.useCallback)(()=>{if(h){p(void 0);return}d.logEvent("open_memory_reference_list",t),p({type:"memoryReferences",data:{responseId:t,memoryReferences:s}})},[h,s,t,p,d]);return 0===s.length?null:(0,n.jsx)(R.g$,{"aria-label":a("response-action.referenced-conversations","Referenced Conversations"),tooltipContent:(0,n.jsx)("p",{children:a("response-action.referenced-conversations","Referenced Conversations")}),tooltipContentProps:{side:"bottom"},variant:"ghostSecondary",size:m?"iconXl":"iconMd",onClick:f,className:i,children:(0,n.jsx)(T.k,{children:c.SHOW_ORB_ICON_MEMORY?(0,n.jsx)(M,{}):h?(0,n.jsx)(E.vJ,{className:"size-4 text-primary"}):(0,n.jsx)(E.vJ,{className:"size-4"})},h?"selected":"not-selected")})}function O(e){return e.charAt(0).toUpperCase()+e.slice(1)}function Z(e){let{conversation:t}=e,s=(0,S.useMemo)(()=>{if(t.modifyTime||t.createTime)return function(e){let t=new Date(e),s=new Date,n=(s.getTime()-t.getTime())/864e5;return n<1?O((0,f.U)(e,s,{locale:d.Z.language})):n<7?O((0,f.U)(e,s,{unit:"day",locale:d.Z.language})):t.getFullYear()===s.getFullYear()?t.toLocaleDateString(d.Z.language,{day:"numeric",month:"short"}):t.toLocaleDateString(d.Z.language,{day:"numeric",month:"short",year:"numeric"})}(t.modifyTime||t.createTime)},[t.modifyTime,t.createTime]);return s?(0,n.jsx)("span",{className:(0,u.cn)("text-secondary text-sm"),children:s}):null}function U(e){let{responseId:t,memoryConversationId:s,onSettled:i,onlyShowOnHover:a}=e,{t:l}=(0,k.$G)("base"),{client:o}=(0,x.useStatsigClient)(),c=(0,h.NL)(),d=(0,r.gK)(I.Z("conversationId")),[u,m]=(0,S.useState)(!1),f=(0,S.useCallback)(e=>{e.stopPropagation(),o.logEvent("begin_forget_memory_reference",t,{responseId:t,memoryConversationId:s,threadConversationId:null!=d?d:""}),m(!0);let n=setTimeout(()=>{m(!1)},3e3);return()=>clearTimeout(n)},[s,t,d,o]),{mutate:g,isPending:y}=(0,h.Db)({mutationFn:()=>p.xU.chatDeleteMemory({conversationIds:[s]}),onError:()=>{m(!1),C.Am.error(l("memory.failed-to-delete-memory","Failed to delete memory"))},onSettled:()=>{m(!1),c.invalidateQueries({queryKey:["memories",t]}).catch(()=>{C.Am.error(l("memory.failed-to-refresh-memory-list","Failed to refresh memory list"))}),null==i||i()}});return(0,n.jsx)(n.Fragment,{children:u?(0,n.jsx)(R.zx,{onClick:e=>{e.stopPropagation(),o.logEvent("forget_memory_reference",t,{responseId:t,memoryConversationId:s,threadConversationId:null!=d?d:""}),g()},variant:"destructive",size:"pill",children:y?(0,n.jsx)(v.Z,{className:"size-4 animate-spin"}):l("Confirm","Confirm")}):(0,n.jsx)(R.zx,{className:a?"opacity-0 group-hover:opacity-100 transition-opacity duration-200":"",onClick:f,variant:"secondary",size:"pill",children:l("Forget","Forget")})})}function P(e){let{responseId:t,memory:s,onClick:i}=e,{convoId:r,convoSummary:a}=s,o=(0,m.t)(I.Z("fetchGetConversation")),d=(0,l.g)(),p=(0,S.useCallback)(e=>{e.stopPropagation(),i()},[i]),{data:x,isLoading:h,error:f}=(0,c.f)(r?o(r):void 0),v=(0,S.useMemo)(()=>null==a?void 0:a.split("\n").map(e=>e.replace(/^[- ]*/,"")).join("\n"),[a]);return h||f||!x?null:(0,n.jsx)("div",{className:(0,u.cn)("block text-base hover:bg-card-hover rounded-xl focus:outline-none focus-within:outline-none focus-visible:ring-1 focus-visible:ring-ring w-full cursor-pointer"),onClick:p,children:(0,n.jsxs)("div",{className:"flex flex-row items-center justify-between gap-4 p-4 group",children:[(0,n.jsxs)("div",{className:(0,u.cn)("flex flex-col gap-2 max-w-[400px]",d.SHOW_MEMORY_SUMMARY&&"w-full max-w-[600px]"),children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"text-sm text-primary",children:x.title||"Untitled Memory"}),(0,n.jsx)("span",{className:"text-secondary text-sm",children:"  •  "}),(0,n.jsx)(Z,{conversation:x})]}),d.SHOW_MEMORY_SUMMARY&&(0,n.jsx)("div",{className:"max-h-[100px] overflow-hidden pb-4 -mb-4 fade-mask-bottom",children:(0,n.jsx)("p",{className:"mt-1 text-xs text-primary break-words",children:v})})]}),!d.SHOW_MEMORY_SUMMARY&&(0,n.jsx)(U,{responseId:t,memoryConversationId:r,onlyShowOnHover:!0})]})})}function H(e){let{responseId:t,memory:s,onOpen:r,onBack:a}=e,{convoId:l,convoSummary:o}=s,d=(0,m.t)(I.Z("fetchGetConversation")),{data:p,isLoading:x,error:h}=(0,c.f)(l?d(l):void 0),f=(0,S.useMemo)(()=>null==o?void 0:o.split("\n").map(e=>e.replace(/^[- ]*/,"")).join("\n\n"),[o]);return x||h||!p?null:(0,n.jsxs)("div",{className:(0,u.cn)("p-4 max-w-[600px]"),children:[(0,n.jsxs)("div",{className:"flex flex-row items-center justify-between gap-4",children:[(0,n.jsxs)("div",{className:"flex flex-row items-center gap-2",children:[(0,n.jsx)(R.zx,{variant:"ghostSecondary",size:"iconSm",onClick:()=>a(),children:(0,n.jsx)(g.Z,{className:"size-4"})}),(0,n.jsx)("div",{className:"group cursor-pointer relative text-sm",onClick:()=>r(),children:(0,n.jsxs)("span",{className:"group-hover:underline flex flex-row items-center gap-1",children:[(0,n.jsx)("span",{className:"line-clamp-1",children:p.title||"Untitled Memory"}),(0,n.jsx)(y.Z,{size:22,className:"text-primary rounded-full bg-card p-1 flex-shrink-0"})]})})]}),(0,n.jsx)(U,{responseId:t,memoryConversationId:l,onSettled:()=>{a()}})]}),(0,n.jsx)("div",{className:"p-4 prose dark:prose-invert text-sm",children:(0,n.jsx)(i.Cn,{sender:"",webSearchResults:z,xposts:z,children:null!=f?f:""})})]})}function F(e){let{responseId:t,memoryReferences:s}=e,{t:i}=(0,k.$G)("base"),r=(0,l.g)(),{routeToConversation:o}=(0,a.o)(),{client:c}=(0,x.useStatsigClient)(),{data:d,isLoading:m,error:f,refetch:v}=(0,h.aM)({queryKey:["memories",t],queryFn:()=>{let e=s.map(e=>e.conversationId).filter(e=>void 0!==e);return p.xU.chatGetMemory({body:{conversationIds:e}})}}),[g,y]=(0,S.useState)(null),I=(0,S.useCallback)(e=>{var s;c.logEvent("open_memory_reference",t,{memoryConversationId:null!==(s=e.convoId)&&void 0!==s?s:""}),r.OPEN_MEMORY_IN_NEW_TAB?window.open("/chat/".concat(e.convoId),"_blank"):o(e.convoId)},[o,c,r.OPEN_MEMORY_IN_NEW_TAB,t]);if(m)return(0,n.jsx)("div",{className:"flex flex-col items-center px-4 pt-1 pb-2 gap-2",children:(0,n.jsx)(_.S,{})});if(f)return(0,n.jsx)("div",{className:"flex flex-col items-center px-4 pt-1 pb-2 gap-2 w-full",children:(0,n.jsx)(w.E.div,{initial:{translateY:5,opacity:0},animate:{translateY:0,opacity:1},exit:{translateY:5,opacity:0},className:(0,u.cn)("w-fit","p-4 bg-card","shadow-sm","border border-input-border rounded-2xl","ml-4 md:mx-4"),children:(0,n.jsxs)("div",{className:"flex items-center gap-4 flex-wrap",children:[(0,n.jsx)(j.Z,{className:(0,u.cn)("h-5 w-5 flex-shrink-0")}),(0,n.jsx)("div",{className:"flex-1 max-w-96",children:(0,n.jsx)("div",{className:"text-primary text-sm",children:i("memory.error","Failed to load memories.")})}),(0,n.jsxs)(R.zx,{variant:"secondary",size:"pill",onClick:()=>{v()},children:[(0,n.jsx)(b.Z,{className:"mr-2 h-4 w-4"}),i("Retry","Retry")]})]})})});if(!d||!d.memories)return(0,n.jsx)("div",{className:"flex flex-col items-center px-4 pt-1 pb-2 gap-2",children:(0,n.jsx)("p",{className:"text-sm text-primary",children:i("memory.no-memories","No memories to display.")})});let C=d.memories;return r.SHOW_MEMORY_SUMMARY?(0,n.jsx)(N.M,{children:(0,n.jsx)("div",{className:"flex flex-row",children:g?(0,n.jsx)(w.E.div,{initial:{x:200,opacity:0},animate:{x:0,opacity:1},exit:{x:200,opacity:0},transition:{duration:.1},className:"w-full",children:(0,n.jsx)(H,{responseId:t,memory:g,onOpen:()=>I(g),onBack:()=>y(null)})},"memory-detail"):(0,n.jsx)(w.E.div,{initial:{x:-200,opacity:0},animate:{x:0,opacity:1},exit:{x:-200,opacity:0},transition:{duration:.1},className:"flex flex-col items-center px-4 pt-1 pb-2 gap-2 max-w-full",children:C.length>0?null==C?void 0:C.map(e=>(0,n.jsx)(P,{responseId:t,memory:e,onClick:()=>y(null!=e?e:null)},e.convoId)):(0,n.jsx)("p",{className:"text-sm text-primary",children:i("memory.no-memories","No memories to display.")})},"memory-list")})}):(0,n.jsx)("div",{className:"flex flex-col items-center px-4 pt-1 pb-2 gap-2 max-w-full",children:C.length>0?null==C?void 0:C.map(e=>(0,n.jsx)(P,{responseId:t,memory:e,onClick:()=>I(e)},e.convoId)):(0,n.jsx)("p",{className:"text-sm text-primary",children:i("memory.no-memories","No memories to display.")})})}},41860:function(e,t,s){s.d(t,{l:function(){return o}});var n=s(2899),i=s(72242),r=s(25694),a=s(81242),l=s(4694);let o=(0,l.forwardRef)((e,t)=>{let{className:s,onScroll:o,children:d,stickToBottom:u,onUnhookScroll:p,onShowScrollButton:m}=e,x=(0,l.useRef)(null),{scrollY:h}=(0,r.v)({container:x});(0,a.W)(h,"change",e=>{if(!x.current)return;let t=c(x.current),s=h.getPrevious();void 0===s||"up"!=(e-s>0?"down":"up")||t||null==p||p(),m(!t),null==o||o(t)});let f=(0,l.useCallback)(e=>{x.current&&x.current.scrollTo({top:x.current.scrollHeight,behavior:e})},[]);return(0,l.useEffect)(()=>{if(!x.current)return;let e=new MutationObserver(()=>{if(!x.current){m(!1);return}let e=c(x.current);u&&!e&&f("instant"),m(!e)});return e.observe(x.current,{childList:!0,subtree:!0}),()=>{e.disconnect()}},[u,m,f]),(0,l.useImperativeHandle)(t,()=>{var e,t,s;return{scrollToBottom:f,scrollTo:e=>{var t;return null===(t=x.current)||void 0===t?void 0:t.scrollTo(e)},el:x.current,scrollHeight:null===(e=x.current)||void 0===e?void 0:e.scrollHeight,scrollTop:null===(t=x.current)||void 0===t?void 0:t.scrollTop,clientHeight:null===(s=x.current)||void 0===s?void 0:s.clientHeight}}),(0,n.jsx)("div",{ref:x,className:(0,i.cn)("w-full h-full overflow-y-auto overflow-x-hidden scrollbar-gutter-stable",s),style:{overflowAnchor:"none"},children:d})});function c(e){return e.scrollHeight<e.scrollTop+e.clientHeight+5}},53429:function(e,t,s){s.d(t,{$7:function(){return r},S3:function(){return l},i4:function(){return a}});var n=s(46913),i=s(53952);async function r(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n.xU;return await s.chatGetArtifactById({artifactId:e,body:{conversationId:t}})}async function a(e,t,s){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n.xU;try{if((await r.chatUpdateArtifact({artifactId:e,body:{artifactVersionId:t,fullArtifact:s}})).artifactVersionId)return!0}catch(e){return i.Tb(e),!1}}async function l(e){let{artifactId:t,artifactVersionId:s,isInline:r}=e,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.xU;try{if((await a.chatUpdateArtifactInlineStatus({artifactId:t,body:{artifactVersionId:s,inlineStatus:r?"SHOW_INLINE_ARTIFACT_INLINE_STATUS":"SHOW_SIDEBAR_ARTIFACT_INLINE_STATUS"}})).artifactVersionId)return!0}catch(e){return i.Tb(e),!1}}},14901:function(e,t,s){s.d(t,{z:function(){return r}});var n=s(33263),i=s(46913);async function r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.xU,s=arguments.length>2?arguments[2]:void 0,r=await t.chatGetShareLink({shareLinkId:e},{headers:s});if(!r.conversation)throw Error("Conversation not found.");if(!r.responses||0===r.responses.length)throw Error("No responses in conversation.");let a={...r.conversation,personaId:(0,n.BV)(r.conversation.systemPromptName)};return{responses:r.responses.map(e=>({...e,conversationId:a.conversationId,state:"closed"})),conversation:a}}},64327:function(e,t,s){s.d(t,{N:function(){return c},dV:function(){return o},nf:function(){return l}});var n=s(30722),i=s.n(n),r=s(11194),a=s(85035);let l=(0,r.U)(e=>({mode:"code",setMode:t=>e({mode:t}),artifactsByConversationId:{},isRefreshing:!1,refresh:()=>{e({isRefreshing:!0}),setTimeout(()=>e({isRefreshing:!1}),100)},upsertArtifact:(t,s)=>{t.id&&t.timestamp&&e(e=>{var n,r,a;return{artifactsByConversationId:{...e.artifactsByConversationId,[s]:{...null!==(r=e.artifactsByConversationId[s])&&void 0!==r?r:{},[t.id]:i().orderBy(i().uniqBy([t,...null!==(a=null===(n=e.artifactsByConversationId[s])||void 0===n?void 0:n[t.id])&&void 0!==a?a:[]],"identifier"),"timestamp","asc")}}}})}})),o=(0,r.U)()((0,a.tJ)(e=>({inlineSettings:{},setInlineSetting:(t,s)=>{e(e=>({inlineSettings:{...e.inlineSettings,[t]:{updateTime:Date.now(),isInline:s}}}))}}),{name:"inline-artifacts"})),c=(0,r.U)()((0,a.tJ)(e=>({edits:{},saveEdit:(t,s,n)=>{e(e=>{var i,r,a,l;let o=null!==(a=null===(r=e.edits[t])||void 0===r?void 0:null===(i=r[s])||void 0===i?void 0:i.lastSyncTime)&&void 0!==a?a:0,c={editTime:Date.now(),lastSyncTime:o,content:n};return{edits:{...e.edits,[t]:{...null!==(l=e.edits[t])&&void 0!==l?l:{},[s]:c}}}})},updateLastSyncTime:(t,s)=>{e(e=>{var n,i;let r=null===(n=e.edits[t])||void 0===n?void 0:n[s];if(!r)return{};let a={...r,lastSynctime:Date.now()};return{edits:{...e.edits,[t]:{...null!==(i=e.edits[t])&&void 0!==i?i:{},[s]:a}}}})}}),{name:"artifacts-edits"}))}}]);