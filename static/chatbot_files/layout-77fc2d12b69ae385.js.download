!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="0f77385e-33f9-403c-99aa-eb7fb4e170b2",e._sentryDebugIdIdentifier="sentry-dbid-0f77385e-33f9-403c-99aa-eb7fb4e170b2")}catch(e){}}(),(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3185],{6807:function(e,t,s){Promise.resolve().then(s.t.bind(s,30745,23)),Promise.resolve().then(s.bind(s,1162)),Promise.resolve().then(s.bind(s,76038)),Promise.resolve().then(s.bind(s,9593)),Promise.resolve().then(s.bind(s,87005)),Promise.resolve().then(s.bind(s,99595)),Promise.resolve().then(s.bind(s,2043)),Promise.resolve().then(s.bind(s,88669)),Promise.resolve().then(s.bind(s,10190)),Promise.resolve().then(s.bind(s,97257)),Promise.resolve().then(s.bind(s,87881)),Promise.resolve().then(s.bind(s,38198)),Promise.resolve().then(s.bind(s,70169)),Promise.resolve().then(s.bind(s,41695)),Promise.resolve().then(s.bind(s,36043)),Promise.resolve().then(s.bind(s,82887)),Promise.resolve().then(s.bind(s,29536)),Promise.resolve().then(s.bind(s,91487)),Promise.resolve().then(s.bind(s,5273)),Promise.resolve().then(s.bind(s,87353)),Promise.resolve().then(s.bind(s,72467)),Promise.resolve().then(s.bind(s,96888)),Promise.resolve().then(s.bind(s,46346)),Promise.resolve().then(s.bind(s,69019)),Promise.resolve().then(s.bind(s,3810)),Promise.resolve().then(s.bind(s,40881)),Promise.resolve().then(s.t.bind(s,61370,23)),Promise.resolve().then(s.t.bind(s,87064,23)),Promise.resolve().then(s.t.bind(s,78982,23)),Promise.resolve().then(s.t.bind(s,13803,23)),Promise.resolve().then(s.bind(s,62312)),Promise.resolve().then(s.bind(s,34164)),Promise.resolve().then(s.bind(s,46458)),Promise.resolve().then(s.bind(s,34646))},1162:function(e,t,s){"use strict";s.d(t,{Loadout:function(){return e9}});var n=s(2899);s(17010);var r=s(40202),i=s(34116),a=s(81211),l=s(72242),o=s(60193),c=s(4886),d=s(65671),u=s(41916),m=s(4694),f=s(6240),x=s(54596);function h(){let e=(0,a.g)(),t=(0,m.useMemo)(()=>{let t=p.safeParse(e.BANNER.value);if(t.success)return t.data},[e.BANNER.value]),[s,r]=(0,f.Z)("banner-".concat(null==t?void 0:t.sentAt),!1),x=(0,m.useMemo)(()=>{if(t)switch(t.type){case"log":return(0,n.jsx)(o.Z,{className:"mr-0.5 flex-shrink-0",size:18});case"warn":return(0,n.jsx)(c.Z,{className:"mr-0.5 flex-shrink-0",size:18});case"error":return(0,n.jsx)(d.Z,{className:"mr-0.5 flex-shrink-0",size:18})}},[null==t?void 0:t.type]),h=(0,m.useCallback)(()=>{r(!0)},[]);if(!s&&t&&t.message)return(0,n.jsxs)("div",{className:(0,l.cn)("absolute top-4 right-1/2 translate-x-1/2 z-50","flex flex-row items-center gap-3","bg-popover rounded-2xl ring-1 ring-inset ring-toggle-border","mx-4 py-3 pl-4 pr-3 min-w-[300px] max-w-full lg:max-w-3/5 w-fit"),children:[x,t.message,(0,n.jsx)(i.zx,{className:"ml-auto",variant:"ghostSecondary",size:"iconSm",onClick:h,children:(0,n.jsx)(u.Z,{size:18})})]})}let p=x.z.object({sentAt:x.z.string().catch(new Date().toISOString()),type:x.z.union([x.z.literal("log"),x.z.literal("warn"),x.z.literal("error")]).catch("error"),message:x.z.string().catch("")}).catch({sentAt:new Date().toISOString(),type:"log",message:""});var v=s(87005),g=s(33901),b=s(74542),y=s(75361);let w=()=>{let[e,t]=(0,f.Z)("anonUserId"),[s,n]=(0,f.Z)("anonPrivateKey"),{user:r,anonUser:i,refreshAnonUser:a}=(0,v.useSession)(),l=(0,m.useCallback)(async()=>{let{privateKey:e,anonUserId:s}=await (0,g.b)();t(s),n(e),await a(s,e)},[]);return(0,m.useEffect)(()=>{let t=async()=>{e&&s?await a(e,s).catch(()=>l()):await l()};r||e&&s&&i||t().catch(e=>{y.Am.error("Failed to initialize session"),(0,b.H)("session-store-init",e)})},[e,s]),null};var j=s(5419);let N=j.fC;j.xz;let S=j.h_,E=m.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,n.jsx)(j.aV,{className:(0,l.cn)("fixed inset-0 z-50 bg-overlay data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...r,ref:t})});E.displayName=j.aV.displayName;let k=m.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,n.jsxs)(S,{children:[(0,n.jsx)(E,{}),(0,n.jsx)(j.VY,{ref:t,className:(0,l.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 ring-1 ring-inset ring-popover-border bg-popover p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-3xl",s),...r})]})});k.displayName=j.VY.displayName;let I=e=>{let{className:t,...s}=e;return(0,n.jsx)("div",{className:(0,l.cn)("flex flex-col space-y-2 text-center sm:text-left",t),...s})};I.displayName="AlertDialogHeader";let C=e=>{let{className:t,...s}=e;return(0,n.jsx)("div",{className:(0,l.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...s})};C.displayName="AlertDialogFooter";let P=m.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,n.jsx)(j.Dx,{ref:t,className:(0,l.cn)("text-lg font-semibold",s),...r})});P.displayName=j.Dx.displayName;let _=m.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,n.jsx)(j.dk,{ref:t,className:(0,l.cn)("text-sm text-secondary",s),...r})});_.displayName=j.dk.displayName;let R=m.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,n.jsx)(j.aU,{ref:t,className:(0,l.cn)((0,i.dc)({variant:"primary"}),s),...r})});R.displayName=j.aU.displayName;let z=m.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,n.jsx)(j.$j,{ref:t,className:(0,l.cn)((0,i.dc)({variant:"ghost"}),"mt-2 sm:mt-0",s),...r})});z.displayName=j.$j.displayName;var M=s(48972),O=s(8781),T=s(70702);function D(e){let{startTimeMs:t,onComplete:s}=e,r=(0,m.useRef)(null),i=(0,m.useRef)();return(0,m.useEffect)(()=>{if(!r.current)return;let e=e=>{r.current&&(r.current.textContent=(e/1e3).toString())};e(t);let n=t,a=setInterval(()=>{if((n-=1e3)<0){clearInterval(a),null==s||s();return}e(n)},1e3);return i.current=()=>clearInterval(a),()=>{var e;return null===(e=i.current)||void 0===e?void 0:e.call(i)}},[t,s]),(0,n.jsx)("span",{ref:r})}function L(){let{t:e}=(0,T.$G)("base"),t={title:e("session-reset.title","Are you still there?"),reset:e("session-reset.reset","Reset my chats"),confirm:e("session-reset.confirm","I'm still here")},[s,r]=function(e){let{timeToWarningMs:t,gracePeriodMs:s}=e,[n,r]=(0,m.useState)("active"),[i,a]=(0,m.useState)(!0),l=(0,m.useCallback)(()=>{r("active"),a(!0)},[]);return(0,m.useEffect)(()=>{let e,n;let o=()=>{i&&(clearTimeout(e),clearTimeout(n),l(),e=setTimeout(()=>{r("warning"),a(!1)},t))},c=["mousedown","mousemove","keypress","scroll","touchstart"];return i?(c.forEach(e=>{document.addEventListener(e,o,!0)}),e=setTimeout(()=>{r("warning"),a(!1)},t)):n=setTimeout(()=>{r("inactive")},s),()=>{i?(c.forEach(e=>{document.removeEventListener(e,o,!0)}),clearTimeout(e)):clearTimeout(n)}},[t,s,l,i]),[n,l]}({timeToWarningMs:3e5,gracePeriodMs:6e4}),a=(0,v.useSession)(),l=(0,m.useCallback)(()=>{a.clearUser(),window.location.reload(),localStorage.clear(),function(){for(let e of document.cookie.split(";")){let t=e.indexOf("="),s=t>-1?e.substr(0,t):e;document.cookie=s+"=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/"}}()},[a]);(0,m.useEffect)(()=>{"inactive"===s&&l()},[s]);let o=(0,m.useCallback)(()=>{r()},[]),c=(0,O.w)();if("active"===s)return null;let d=()=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(T.cC,{i18nKey:"Your chats will be deleted after",defaults:"Your chats will be deleted after {{minutes}} minutes of inactivity. You have <timer/> seconds remaining.",components:{timer:(0,n.jsx)("span",{className:"text-sunset",children:(0,n.jsx)(D,{startTimeMs:6e4})})},values:{minutes:Math.ceil(5)}}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsxs)(T.cC,{i18nKeys:"To permanently save",children:["To permanently save your chats you must ",(0,n.jsx)("b",{children:"sign in"}),"."]})]});return c?(0,n.jsx)(M.dy,{dismissible:!1,open:"warning"===s,children:(0,n.jsxs)(M.sc,{children:[(0,n.jsx)(M.OX,{children:(0,n.jsx)(M.iI,{children:t.title})}),(0,n.jsx)("div",{className:"p-4 text-primary",children:d()}),(0,n.jsxs)(M.ze,{children:[(0,n.jsx)(i.zx,{variant:"ghost",onClick:l,children:t.reset}),(0,n.jsx)(i.zx,{onClick:o,variant:"primary",children:t.confirm})]})]})}):(0,n.jsx)(N,{open:"warning"===s,children:(0,n.jsxs)(k,{children:[(0,n.jsxs)(I,{children:[(0,n.jsx)(P,{children:t.title}),(0,n.jsx)(_,{className:"text-primary",children:d()})]}),(0,n.jsxs)(C,{children:[(0,n.jsx)(z,{onClick:l,children:t.reset}),(0,n.jsx)(R,{onClick:o,children:t.confirm})]})]})})}var Z=s(94408),A=s(76256),U=s(89463),F=s(4077);let W=()=>{let[e,t]=(0,m.useState)(!0);return(0,m.useEffect)(()=>{let e=()=>t(!0),s=()=>t(!1);return window.addEventListener("online",e),window.addEventListener("offline",s),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",s)}},[]),e};var G=s(99595),Y=s(30722),$=s.n(Y),B=s(13771),H=s(68192),V=s(64846),K=s(43701),q=s(14075),J=s(56672),Q=s(13717),X=s(76010),ee=s(14714),et=s(40955),es=s(42210),en=s(35813),er=s(6936),ei=s(74239),ea=s(11194),el=s(85035),eo=s(76038),ec=s(43335);let ed=(0,ea.U)()((0,el.tJ)(e=>({isDismissed:!1,setIsDismissed:t=>e({isDismissed:t})}),{name:"open-in-app-dialog"}));function eu(){let{t:e}=(0,T.$G)("base"),t=(0,a.g)(),{client:s}=(0,ei.useStatsigClient)(),r=ed(J.Z("isDismissed")),o=ed(J.Z("setIsDismissed")),{os:c}=(0,en.i)(),{APP_STORE_URL:d,GOOGLE_PLAY_URL:u}=(0,eo.O)(),[f,x]=(0,m.useState)(!!t.SHOW_OPEN_IN_APP_DIALOG_EVERY_TIME||!r),h=(0,m.useCallback)(()=>{if(s.logEvent("clicked_open_in_app",c,{location:"open-in-app-dialog"}),!t.SHOW_OPEN_IN_APP_DIALOG_DOWNLOAD_DEFAULT){let e=document.createElement("iframe");e.src=window.location.href,e.style.display="none",e.height="0",e.width="0",document.body.appendChild(e)}setTimeout(function(){document.hasFocus()&&(s.logEvent("redirected_to_store",c,{location:"open-in-app-dialog"}),"ios"===c?window.location.href=d:window.location.href=u)},500)},[s,c,d,u,t]),p=(0,m.useCallback)(()=>{s.logEvent("clicked_open_in_app_not_now",c,{location:"open-in-app-dialog"}),o(!0),x(!1)},[o,x,s,c]);return(0,n.jsxs)(es.c,{open:f,setOpen:x,contentClassName:(0,l.cn)("focus:outline-0 focus-within:outline-0 gap-2","bg-background rounded-3xl","w-full md:w-5/6 lg:w-3/5 max-w-sm","flex flex-col","md:overflow-hidden","px-6 py-6"),children:[(0,n.jsx)("div",{className:"w-full flex justify-center pt-4",children:(0,n.jsx)(ec.$I,{className:"w-32 h-14"})}),(0,n.jsxs)(et.fK,{className:"mb-2 sm:text-center",children:[(0,n.jsx)(er.$N,{className:"sr-only",children:e("open-in-app-dialog.title","Open in App Dialog")}),(0,n.jsx)(et.Be,{className:"mb-1",children:e("Get the full Grok experience","Get the full Grok experience")})]}),(0,n.jsx)(i.zx,{asChild:!0,variant:"primary",size:"lg",onClick:h,children:(0,n.jsx)("div",{children:t.SHOW_OPEN_IN_APP_DIALOG_DOWNLOAD_DEFAULT?e("Download App","Download App"):e("Open in App","Open in App")})}),(0,n.jsx)(i.zx,{asChild:!0,variant:"secondary",size:"lg",onClick:p,children:(0,n.jsx)("div",{children:e("Not now","Not now")})})]})}var em=s(55911);s(73020),new WeakSet;var ef=s(68060),ex=s(40794),eh=s(53781),ep=s(81556),ev=s(75260),eg=s(73069),eb=s(3667);function ey(e){let{children:t,isVisible:s,minWidth:r,maxWidth:i,initialWidth:a,className:o}=e,[c,d]=(0,m.useState)(!1),[u,f]=(0,m.useState)(a);(0,m.useRef)(u).current=u;let x=(0,m.useRef)(null),h=(0,m.useRef)(document.body.clientWidth);(0,m.useEffect)(()=>{f(a)},[a]);let p=(0,m.useCallback)(e=>{e.preventDefault(),d(!0)},[]),v=(0,m.useCallback)(()=>{d(!1)},[]),g=(0,m.useCallback)(e=>{c&&x.current&&f(Math.max(r,Math.min(i,document.body.clientWidth-e.clientX)))},[c,r,i]),b=(0,m.useCallback)(()=>{f(Math.max(r,Math.min(i,a/h.current*document.body.clientWidth)))},[r,i,a]);return(0,m.useEffect)(()=>(window.addEventListener("mousemove",g),()=>window.removeEventListener("mousemove",g)),[g]),(0,m.useEffect)(()=>(window.addEventListener("mouseup",v),()=>window.removeEventListener("mouseup",v)),[v]),(0,m.useEffect)(()=>(window.addEventListener("resize",b),()=>window.removeEventListener("resize",b)),[b]),(0,n.jsx)(eg.M,{children:s&&(0,n.jsx)(eb.E.div,{initial:{x:u,opacity:0,width:0},animate:{x:0,opacity:1,width:u},exit:{x:u,opacity:0,width:0},transition:c?{duration:0}:{type:"ease",ease:"easeInOut",duration:.2},className:(0,l.cn)("h-dvh flex-shrink-0",o),children:(0,n.jsxs)("div",{ref:x,className:"relative h-full w-full",children:[(0,n.jsx)("div",{className:(0,l.cn)("absolute start-0 top-0 bottom-0 w-2 cursor-col-resize border-l border-input-border hover:bg-card-hover z-50",c&&"bg-card-hover"),onMouseDown:p}),(0,n.jsxs)("div",{className:"h-full p-0",children:[t,c&&(0,n.jsx)("div",{className:"absolute inset-0 bg-transparent z-50"})]})]})})})}var ew=s(63255),ej=s(43010),eN=s(6087),eS=s(9682),eE=s(38199),ek=s(49810),eI=s(89194),eC=s(67206),eP=s(86952),e_=s(8728),eR=s(65215),ez=s(84444),eM=s(40881),eO=s(41543),eT=s(12340),eD=s(80779),eL=s(2368),eZ=s(74431);function eA(e){let{fileMetadata:t,onClose:s,useRawFileURI:r,hideEdit:i}=e,{t:l}=(0,T.$G)("chat"),o=(0,a.g)(),{ASSET_SERVER_URL:c}=(0,eo.O)(),{data:d,isLoading:u,error:m}=(0,eC.aM)({queryKey:["asset",t.fileMetadataId],queryFn:async()=>r?t.fileUri:(0,ek.Vh)(c,t.fileUri)});if(u)return(0,n.jsxs)("div",{className:"p-4",children:[l("Loading","Loading"),"..."]});if(m)return(0,n.jsx)("div",{className:"p-4",children:l("Error: Could not access this content","Error: Could not access this content")});if(o.ENABLE_CSV_RENDERING&&["text/csv","application/csv"].includes(t.fileMimeType))return(0,n.jsx)("div",{className:"flex flex-col items-center justify-center w-full mx-auto",children:(0,n.jsx)(eZ.g,{assetUrl:d,fileMetadata:t})});if(t.fileMimeType.startsWith("text/"))return(0,n.jsx)(eW,{assetUrl:d,fileMetadata:t});switch(t.fileMimeType){case"image/jpeg":case"image/png":case"image/webp":return(0,n.jsx)(eU,{assetUrl:d,fileMetadata:t,onClose:s,hideEdit:i});case"application/json":case"application/csv":case"application/x-yaml":case"application/xml":case"application/toml":case"":return(0,n.jsx)(eW,{assetUrl:d,fileMetadata:t});case"application/vnd.openxmlformats-officedocument.wordprocessingml.document":case"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":return(0,n.jsx)(eG,{assetUrl:d,fileMetadata:t});default:return(0,n.jsx)(eY,{assetUrl:d,fileMetadata:t})}}function eU(e){let{assetUrl:t,fileMetadata:s,showControls:r=!1,onClose:l,hideEdit:o}=e,[c,d]=(0,m.useState)(!0),u=(0,a.g)(),{t:f}=(0,T.$G)("chat");(0,m.useEffect)(()=>{if(!t){d(!1);return}let e=new Image;return e.src=t,e.onload=()=>d(!1),e.onerror=()=>d(!1),()=>{e.onload=null,e.onerror=null}},[t]);let x=(0,m.useCallback)(()=>{t&&(0,eI.G)(t,s.fileName).catch((0,b.n4)("chat-asset-viewer:handleDownloadImage"))},[t,s]);return r?(0,n.jsx)("div",{className:"flex flex-col items-center justify-center w-full max-w-4xl mx-auto","data-vaul-no-drag":!0,children:(0,n.jsx)("div",{className:"relative w-full max-w-4xl mx-auto",children:(0,n.jsx)(eL.d$,{initialScale:1,initialPositionX:0,initialPositionY:0,children:e=>{let{zoomIn:r,zoomOut:a,resetTransform:l}=e;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"absolute end-4 bottom-4 z-10 flex space-x-1 rounded-full bg-background p-1 opacity-80",children:[(0,n.jsx)(i.zx,{onClick:()=>r(),variant:"ghost",size:"iconSm",className:"text-primary hover:bg-foreground","aria-label":"Zoom In",children:(0,n.jsx)(eP.Z,{className:"h-4 w-4"})}),(0,n.jsx)(i.zx,{onClick:()=>a(),variant:"ghost",size:"iconSm",className:"text-primary hover:bg-foreground","aria-label":"Zoom Out",children:(0,n.jsx)(e_.Z,{className:"h-4 w-4"})}),(0,n.jsx)(i.zx,{onClick:()=>l(),variant:"ghost",size:"iconSm",className:"text-primary hover:bg-foreground","aria-label":"Reset Zoom",children:(0,n.jsx)(eR.Z,{className:"h-4 w-4"})}),(0,n.jsx)(i.zx,{onClick:x,variant:"ghost",size:"iconSm",className:"text-primary hover:bg-foreground","aria-label":"Reset Zoom",children:(0,n.jsx)(ez.Z,{className:"h-4 w-4"})})]}),(0,n.jsx)(eL.Uv,{wrapperClass:"!w-full bg-primary/50 rounded-lg",children:(0,n.jsx)("img",{src:t,alt:s.fileName,className:"w-full h-auto shadow-md",onLoad:()=>a(),style:{maxHeight:"70vh"}})}),c&&(0,n.jsx)(eE.O,{className:"w-full h-[70vh] rounded-lg"})]})}})})}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("img",{src:t,alt:s.fileName,className:"w-[94vw] max-h-[calc(100vh-10rem)] max-w-5xl xl:max-w-6xl shadow cursor-pointer rounded-xl lg:w-fit object-contain"}),u.SHOW_IMAGE_EDIT&&t&&!o&&(0,n.jsx)("div",{className:"w-full flex justify-center absolute bottom-3 p-3",children:(0,n.jsxs)(eS.d,{className:"px-4 py-3 h-auto",buttonProps:{variant:"card",size:"pill"},editingImage:{url:t,metadata:s},location:"chat-asset-viewer",onClick:e=>{e.stopPropagation(),l()},children:[(0,n.jsx)(eN.NP,{className:"size-5 text-secondary"}),f("Edit Image","Edit Image")]})})]})}let eF=["text/plain","text/csv","application/csv"],eW=m.memo(function(e){let{assetUrl:t,fileMetadata:s}=e,{t:r}=(0,T.$G)("chat"),{resolvedTheme:i}=(0,eM.F)(),{isLoading:a,error:l,data:o}=(0,eC.aM)({queryKey:["text-asset",t],queryFn:async()=>{if(!t)throw Error("Asset URL is required");let e=await fetch(t,{method:"GET",credentials:"include"});if(!e.ok)throw Error("Failed to fetch: ".concat(e.statusText));return await e.text()},enabled:!!t});if(a)return(0,n.jsx)("div",{className:"p-4",children:r("Loading text…","Loading text…")});if(l)return(0,n.jsx)("div",{className:"p-4",children:r("errorMessage","Error: {{error}}",{error:l.message})});if(!o)return(0,n.jsx)("div",{className:"p-4",children:r("No text content available.","No text content available.")});let c=o.length>16384,d=eF.includes(s.fileMimeType),u=c||d?(0,n.jsx)("pre",{className:"w-full p-4 rounded-lg shadow-md text-sm font-mono overflow-auto max-h-[50dvh] sm:max-h-[calc(100dvh-6rem)] mb-4 bg-foreground",children:o}):(0,n.jsx)("div",{className:"w-full rounded-lg shadow-md text-sm font-mono overflow-auto max-h-[50dvh] sm:max-h-[calc(100dvh-6rem)] mb-4",children:(0,n.jsx)(eO.Z,{style:"dark"===i?eT.Z:eD.Z,customStyle:{background:"dark"===i?"#121314":"var(--foreground)",fontFamily:"var(--font-ibm-plex-mono)"},children:o})});return(0,n.jsx)("div",{className:"flex flex-col items-center justify-center w-full max-w-4xl mx-auto",children:u})});function eG(e){let{assetUrl:t,fileMetadata:s}=e,{t:r}=(0,T.$G)("chat");return t?(0,n.jsx)("div",{className:"flex flex-col items-center justify-center rounded-lg mb-4",children:(0,n.jsx)("a",{href:t,download:s.fileName||"download",children:(0,n.jsx)(i.zx,{children:r("Download Asset","Download Asset")})})}):null}function eY(e){let{assetUrl:t,fileMetadata:s}=e,r=(0,m.useRef)(null);return(0,m.useEffect)(()=>{let e=()=>{if(r.current){let e=window.innerWidth<O.G,t=window.innerHeight*(e?.7:.9);r.current.style.height="".concat(t,"px")}};return window.addEventListener("resize",e),e(),()=>{window.removeEventListener("resize",e)}},[]),(0,n.jsx)("div",{className:"flex flex-col items-center justify-center rounded-lg mb-4 w-full",children:(0,n.jsx)("iframe",{ref:r,src:t,width:"100%",height:"800px",title:s.fileName,className:"rounded-lg shadow-md"})})}eW.displayName="MemoizedTextAssetViewer";var e$=s(69492),eB=s(88416),eH=s(85632),eV=s(85635);let eK=(0,ea.U)(e=>({previewMode:"desktop",setPreviewMode:t=>e({previewMode:t}),isRefreshing:!1,refresh:()=>{e({isRefreshing:!0}),setTimeout(()=>e({isRefreshing:!1}),100)}}));var eq=s(97818),eJ=s(26963),eQ=s(71181);function eX(){let{t:e}=(0,T.$G)("chat"),{previewMode:t,setPreviewMode:s}=eK();return(0,n.jsx)(eV.mQ,{className:"flex-1 flex-row justify-center flex",defaultValue:"desktop",value:t,onValueChange:e=>s(e),children:(0,n.jsxs)(eV.dr,{children:[(0,n.jsxs)(eV.SP,{className:"gap-1",value:"desktop",children:[(0,n.jsx)(eq.Z,{className:"size-4"}),(0,n.jsx)("span",{className:"hidden md:inline",children:e("Wide","Wide")})]}),(0,n.jsxs)(eV.SP,{className:"gap-1",value:"mobile",children:[(0,n.jsx)(eJ.Z,{className:"size-4"}),(0,n.jsx)("span",{className:"hidden md:inline",children:e("Mobile","Mobile")})]})]})})}function e0(){let{refresh:e}=eK(),{t}=(0,T.$G)("chat");return(0,n.jsx)("div",{className:"flex gap-2 items-center",children:(0,n.jsxs)(Z.u,{delayDuration:300,children:[(0,n.jsx)(Z.aJ,{asChild:!0,children:(0,n.jsx)(i.zx,{variant:"outline",size:"icon",onClick:e,children:(0,n.jsx)(eQ.Z,{size:16})})}),(0,n.jsx)(Z._v,{children:(0,n.jsx)("p",{children:t("Refresh","Refresh")})})]})})}function e1(e){let{html:t}=e,{previewMode:s,isRefreshing:r}=eK();return(0,n.jsx)("div",{className:"h-full bg-foreground dark:bg-background",children:(0,n.jsx)("div",{className:"w-full h-full flex flex-col",children:(0,n.jsx)("div",{className:(0,l.cn)("bg-background-secondary flex-1 flex flex-col"),children:(0,n.jsx)("div",{className:(0,l.cn)("flex-1 bg-foreground","mobile"===s&&"max-w-lg mx-auto"),children:r?null:(0,n.jsx)(eB.GJ,{srcDoc:t,autofocus:!0})})})})})}var e2=s(73197),e4=s(37330);let e5=[],e3=e=>{let{responseId:t}=e,[s,r]=(0,m.useState)(""),i=(0,e2.CI)(e=>e.byId[t]);return(0,m.useEffect)(()=>{let e=setInterval(()=>{var e;r((null===(e=i.steps)||void 0===e?void 0:e.map(e=>{var t,s,n;if(!(null===(t=e.tags)||void 0===t?void 0:t.includes("assistant")))return"";let r=null===(s=e.tags)||void 0===s?void 0:s.indexOf("assistant");return(null===(n=e.text)||void 0===n?void 0:n[r])||""}).join(" "))||"")},100);return()=>clearInterval(e)},[i.steps]),(0,n.jsx)(e4._I,{sender:"assistant",webSearchResults:e5,xposts:e5,children:s})};function e6(){var e;let{t}=(0,T.$G)("chat"),s=(0,a.g)(),r=(0,e$.gK)(J.Z("sidePanelContent")),o=(0,e$.gK)(J.Z("setSidePanelContent")),[c,d]=(0,m.useState)(void 0),f=["htmlPreview","artifact"].includes(null!==(e=null==r?void 0:r.type)&&void 0!==e?e:""),x=r&&"asset"===r.type&&(r.data.fileMimeType.startsWith("text/csv")||r.data.fileMimeType.startsWith("application/csv")),h=f||s.ENABLE_CSV_RENDERING&&x,p=(0,O.w)(f?1024:void 0),v=(null==r?void 0:r.type)==="thinkingTrace"?740:.62*document.body.clientWidth,g=(0,m.useCallback)(()=>{o(void 0)},[o]),b=()=>{var e,a,m,f;let x,h,v,b;if(!r)return null;let{type:y,data:w}=r,j=null,N=null;switch(y){case"asset":x=(0,n.jsx)(ej.Z,{className:"!size-5"}),h=w.fileName.length>0?w.fileName:"File",b=(0,n.jsx)("div",{className:"flex flex-col items-center gap-2 px-4 pb-2",children:(0,n.jsx)(eA,{fileMetadata:w,onClose:g,hideEdit:r.hideEdit})});break;case"rawAsset":x=(0,n.jsx)(ej.Z,{className:"!size-5"}),h=w.fileName.length>0?w.fileName:"File",b=(0,n.jsx)("div",{className:"flex flex-col items-center gap-2 px-4 pb-2",children:(0,n.jsx)(eA,{fileMetadata:w,onClose:g,useRawFileURI:!0})});break;case"webSearchResults":h=t("Search Results","Search Results"),b=(0,n.jsxs)("div",{className:"flex flex-col items-center gap-2 px-4 pb-2",children:[w.webSearchResults.map(e=>(0,n.jsx)("div",{className:"w-full py-1 text-base text-primary",children:(0,n.jsx)(ep.Fg,{webSearchResult:e})},e.url)),!!(null===(e=w.browsedUrls)||void 0===e?void 0:e.length)&&(null===(a=w.browsedUrls)||void 0===a?void 0:a.length)>0&&(0,n.jsxs)("div",{className:"w-full",children:[(0,n.jsx)("div",{className:"text-base font-medium pb-2",children:t("Deep Search: Browsed URLs","Deep Search: Browsed URLs")}),null===(m=w.browsedUrls)||void 0===m?void 0:m.map(e=>(0,n.jsx)("div",{className:"w-full py-1 text-base text-primary",children:(0,n.jsx)(ep.Fg,{webSearchResult:{url:e,title:e,preview:"",searchEngineText:"",description:"",siteName:"",metadataTitle:"",creator:"",image:"",favicon:"",citationId:""}})},e))]})]});break;case"xPosts":h=t("\uD835\uDD4F Posts","\uD835\uDD4F Posts"),b=(0,n.jsx)("div",{className:"flex flex-col items-center px-4 pb-2",children:w.map(e=>(0,n.jsx)("div",{className:"w-full py-1 text-base text-primary",children:(0,n.jsx)(ep.jW,{xPost:e})},e.postId))});break;case"memoryReferences":h=(0,n.jsxs)("div",{className:"flex flex-row items-center gap-1.5",children:[t("response-action.referenced-conversations","Referenced Conversations"),(0,n.jsx)(ew.v,{})]}),v=t("Forgetting conversations won’t delete them from history","Forgetting conversations won’t delete them from history"),b=(0,n.jsx)(ev.L,{responseId:w.responseId,memoryReferences:w.memoryReferences});break;case"thinkingTrace":h=t("Thoughts","Thoughts"),b=(0,n.jsx)(eb.E.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.15},className:"[&>*:first-child]:mt-0 h-fit overflow-x-auto w-full focus:outline-none focus-within:outline-none px-3 prose dark:prose-invert",children:(0,n.jsx)(e3,{responseId:w.responseId})});break;case"artifact":h=null,b=(0,n.jsx)(eB.kw,{artifact:w.artifact,onSetMenu:s.ENABLE_ARTIFACTS_EDITING?d:void 0,readOnly:w.readOnly}),N=null,j=(0,n.jsx)(eH.z,{artifact:w.artifact,contentButtons:c,readOnly:w.readOnly});break;case"htmlPreview":j=(0,n.jsxs)("div",{className:"flex gap-4 items-center",children:[(0,n.jsx)(eX,{}),(0,n.jsx)(e0,{})]}),b=(0,n.jsx)(e1,{html:w});break;default:throw Error("Unknown side panel content type")}let S=["asset","webSearchResults","xPosts","memoryReferences"].includes(null!==(f=null==r?void 0:r.type)&&void 0!==f?f:"");return(0,n.jsxs)("aside",{className:"max-h-[97dvh] h-[97dvh] lg:max-h-none lg:h-full flex flex-col w-full overflow-y-auto overflow-x-hidden bg-background-secondary",children:[(0,n.jsxs)("div",{className:(0,l.cn)("flex z-10 flex-row items-center justify-between flex-shrink-0 w-full px-2 md:px-5 sticky top-0 bg-gradient-to-b from-background-secondary via-background-secondary to-transparent",v?"h-[4.5rem] via-90%":"h-12 md:h-16 via-80%"),children:[j||(0,n.jsxs)("div",{className:"flex flex-row gap-2 items-center max-w-[80%]",children:[x&&(0,n.jsx)("div",{className:"flex-shrink-0",children:x}),(0,n.jsxs)("div",{className:(0,l.cn)("flex flex-col items-start w-full",p&&"gap-1",S&&"ps-2 md:ps-3"),children:[(0,n.jsx)("div",{className:"truncate text-base font-medium w-full",children:p?(0,n.jsx)(et.$N,{children:h}):h}),v&&(0,n.jsx)("div",{className:(0,l.cn)("text-xs text-secondary w-full",!p&&"truncate"),children:p?(0,n.jsx)(et.Be,{children:v}):v})]})]}),N,(0,n.jsxs)("div",{className:"flex justify-end items-center gap-2",children:[null,(0,n.jsxs)(Z.u,{delayDuration:300,children:[(0,n.jsx)(Z.aJ,{asChild:!0,children:(0,n.jsx)(i.zx,{variant:"ghost",size:"icon",onClick:()=>o(void 0),className:"flex-shrink-0 rounded-full","aria-label":t("Close","Close"),children:(0,n.jsx)(u.Z,{size:20,strokeWidth:2})})}),(0,n.jsx)(Z._v,{children:(0,n.jsx)("p",{children:t("Close","Close")})})]})]})]}),(0,n.jsx)("div",{className:(0,l.cn)("flex-grow w-full h-fit overflow-y-visible",(null==r?void 0:r.type)==="artifact"&&"overflow-y-auto min-h-0 flex-1 p-0"),children:b})]})};return p?(0,n.jsx)(M.dy,{open:!!r,onOpenChange:e=>o(e?r:void 0),children:(0,n.jsx)(M.sc,{className:"focus:outline-none",disableDrag:!("ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0),children:b()})}):r&&"asset"===r.type&&r.data.fileMimeType.startsWith("image/")?(0,n.jsx)(er.Vq,{open:!!r,onOpenChange:e=>{o(e?r:void 0)},children:(0,n.jsx)(et.PK,{children:(0,n.jsx)(et.cZ,{className:(0,l.cn)("bg-transparent h-full w-full","!scale-100 !-translate-x-1/2 !-translate-y-1/2"),children:(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center w-full h-full",onClick:()=>o(void 0),children:[(0,n.jsx)(eA,{fileMetadata:r.data,onClose:g,hideEdit:r.hideEdit}),(0,n.jsx)("div",{className:"absolute flex-col justify-between hidden lg:flex end-3 inset-y-3 dark",children:(0,n.jsx)(i.zx,{variant:"ghost",size:"iconXl",onClick:e=>{e.stopPropagation(),o(void 0)},children:(0,n.jsx)(u.Z,{className:"size-5"})})})]})})})}):(0,n.jsx)(ey,{isVisible:!!r,minWidth:f&&!p?550:288,maxWidth:v,initialWidth:h?.66*document.body.clientWidth:480,className:"max-w-[66%] xl:max-w-none",children:b()})}function e9(e){let{children:t}=e,s=(0,a.g)(),i=(0,B.t)(J.Z("list")),l=(0,U.r)(),{os:o}=(0,en.i)(),c=(0,v.useSession)(),d=(0,q.usePathname)(),u=!(null==d?void 0:d.startsWith("/coming-soon")),x=(0,K.F)(J.Z("showAgeVerification")),p=(0,K.F)(J.Z("ageVerificationCallback"));(function(e){let[t,s]=(0,f.Z)("hasPreviouslyInitUserSettings",!1),{client:n}=(0,ei.useStatsigClient)();(0,m.useEffect)(()=>{if(e.user){if((0,ef.g)(e.countryCode)&&(n.logEvent("initialize_gdpr_user_settings",e.countryCode,{location:"loadout",countryCode:e.countryCode||"",hasPreviouslyInitUserSettings:String(t)}),!t)){K.F.getState().initializeGdprUserSettings().then(()=>s(!0)).catch(()=>(0,b.H)("loadout","Failed to initialize GDPR user settings"));return}K.F.getState().fetchGetUserSettings().catch(()=>(0,b.H)("loadout","Failed to load user settings"))}},[e.user,n])})(c),function(e){let{personalityPresets:t}=function(){let e=(0,a.g)(),{t}=(0,T.$G)("base"),s={concise:t("personality.concise.name","Concise"),formal:t("personality.formal.name","Formal"),socratic:t("personality.socratic.name","Socratic")},n={concise:t("personality.concise.description","Responds briefly and directly."),formal:t("personality.formal.description","Responds using a formal tone."),socratic:t("personality.socratic.description","Responds in a way to help you learn.")},r=(0,m.useMemo)(()=>{let t=(e.PERSONALITY_PRESETS.value.personalityPresets&&Array.isArray(e.PERSONALITY_PRESETS.value.personalityPresets)?e.PERSONALITY_PRESETS.value.personalityPresets:[]).map(e=>V.xn.safeParse(e)).filter(e=>e.success).map(e=>{var t,r;let{data:i}=e;return{...i,isPreset:!0,name:null!==(t=s[i.personalityId])&&void 0!==t?t:i.name,description:null!==(r=n[i.personalityId])&&void 0!==r?r:i.description}});return $().keyBy(t,e=>e.personalityId)},[e.PERSONALITY_PRESETS.value]);return{personalityPresets:(0,m.useMemo)(()=>Object.values(r),[r]),personalityPresetById:r}}();(0,m.useEffect)(()=>{V.Zv.getState().appendPersonalities(t)},[t]),(0,m.useEffect)(()=>{e.user&&V.Zv.getState().fetchListPersonalities().catch(e=>(0,b.H)("loadout:fetchList","Failed to load custom personalities: ".concat(e)))},[e.user])}(c);let g=(0,em.Pd)();(0,m.useEffect)(()=>{if((c.user||c.anonUser)&&!g.isPending){var e,t,s;eh.w.setState({hasSubscriptions:(null===(e=g.data)||void 0===e?void 0:e.hasSubscriptions)||!1,subscriptions:(null===(t=g.data)||void 0===t?void 0:t.subscriptions)||[],bestSubscription:(null===(s=g.data)||void 0===s?void 0:s.bestSubscription)||"SUBSCRIPTION_TIER_INVALID",isPending:g.isPending})}},[g,c.user,c.anonUser]);let y=(0,F.bP)();return(0,m.useEffect)(()=>{(c.user||c.anonUser)&&(y.isPending||H.p.setState(y))},[y,c.user,c.anonUser]),(0,m.useEffect)(()=>{!function(){let e=!1,t=0,s=0,n=null;function r(){"visible"===document.visibilityState&&(e||(e=!0,t=performance.now()),null!==n&&clearTimeout(n),n=setTimeout(i,1e4))}function i(){if(e){e=!1;let n=performance.now()-t;s+=n,null===G.IW||void 0===G.IW||G.IW.logEvent("session_active_time",n,{sessionActiveTimeMs:n.toString(),totalActiveTimeMs:s.toString()})}}document.addEventListener("mousemove",$().throttle(r,500)),document.addEventListener("keydown",$().throttle(r,500)),document.addEventListener("click",$().throttle(r,500)),document.addEventListener("scroll",$().throttle(r,500)),document.addEventListener("visibilitychange",()=>{"hidden"===document.visibilityState&&e&&i(),"visible"!==document.visibilityState||e||r()}),window.addEventListener("beforeunload",()=>{e&&i()})}()},[]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(ee.Ou,{}),(0,n.jsx)(Q.W,{backend:X.PD,children:(0,n.jsxs)(Z.pn,{delayDuration:300,skipDelayDuration:0,disableHoverableContent:!0,children:[!c.user&&!l&&!!i.length&&(0,n.jsx)(L,{}),(0,n.jsxs)(ex.o,{className:"flex w-full h-full",children:[(0,n.jsx)(h,{}),(0,n.jsxs)("div",{className:"flex w-full h-full @container/mainview",children:[s.SHOW_OPEN_IN_APP_DIALOG&&"ios"===o&&(0,n.jsx)(eu,{}),x&&!c.user&&(0,n.jsx)(r.l$,{onPass:p}),u&&(0,n.jsx)(w,{}),t]}),(0,n.jsx)(e6,{})]}),s.SHOW_SUBSCRIPTION_FLOWS&&(0,n.jsx)(A.ev,{}),(0,n.jsx)(e7,{})]})}),!1]})}function e7(){let{t:e}=(0,T.$G)("base"),t=W(),s=(0,m.useRef)(null);return(0,m.useEffect)(()=>{t||s.current?s.current&&(y.Am.dismiss(s.current),s.current=null):s.current=y.Am.error(e("You are offline","You are offline"),{duration:1/0})},[t]),null}},14714:function(e,t,s){"use strict";s.d(t,{Ou:function(){return k},et:function(){return P}});var n=s(2899),r=s(69492),i=s(26777),a=s(34116),l=s(77119),o=s(4694);let c={};function d(e,t){let s=(0,o.useRef)("function"==typeof t?t():t).current,[n,r]=(0,o.useState)(()=>{try{let t=window.sessionStorage.getItem(e);return t?JSON.parse(t):s}catch(e){return console.error("Error parsing sessionStorage value:",e),s}});return(0,o.useEffect)(()=>{let t=e=>{r(e)};return c[e]||(c[e]=[]),c[e].push(t),()=>{c[e]&&(c[e]=c[e].filter(e=>e!==t))}},[e]),(0,o.useEffect)(()=>{let t=t=>{if(t.key===e&&t.storageArea===window.sessionStorage){if(null!==t.newValue)try{r(JSON.parse(t.newValue))}catch(e){console.error("Error parsing storage event value:",e)}else r(s)}};return window.addEventListener("storage",t),()=>{window.removeEventListener("storage",t)}},[e,s]),[n,t=>{try{let s="function"==typeof t?t(n):t;window.sessionStorage.setItem(e,JSON.stringify(s)),r(s),c[e]&&c[e].forEach(e=>e(s))}catch(e){console.error("Error setting sessionStorage value:",e)}}]}var u=s(14901),m=s(20592),f=s(72242),x=s(46913),h=s(73197),p=s(67206),v=s(30722),g=s.n(v),b=s(41916),y=s(56672),w=s(70702);let j="HcydF4kDI5",N=["QHguYWk=","QHRlYWNoeC5haQ=="],S=new Set(["amRsb3Zlc3RoaXNAZ21haWwuY29t","bWF0dGJzcmlAZ21haWwuY29t"]);function E(){let{user:e}=(0,i.kP)(),[t]=d(j,!1),s=null==e?void 0:e.email;return!!(s&&(S.has(s)||N.some(e=>s.endsWith(atob(e)))))&&!t}function k(){let{t:e}=(0,w.$G)("base"),[,t]=d(j,!1),{isChatPage:s,isSharePage:r,pageData:i}=(0,l.o)();return E()?(0,n.jsxs)("div",{className:"absolute top-0 right-1/2 translate-x-1/2 z-50 flex items-center gap-0",children:[s&&(0,n.jsx)(C,{}),r&&(null==i?void 0:i.shareLinkId)&&(0,n.jsx)(I,{shareLinkId:i.shareLinkId}),(0,n.jsx)(a.zx,{variant:"ghost",size:"iconSm",onClick:()=>{t(!0)},"aria-label":e("debug-menu-close.label","Close"),children:(0,n.jsx)(b.Z,{size:10})})]}):null}function I(e){let{shareLinkId:t}=e,{data:s}=(0,p.aM)({queryKey:["share",t],queryFn:()=>(0,u.z)(t,x.xU)});return s?(0,n.jsxs)("div",{className:"text-red-600 font-normal text-xs flex flex-row gap-1",children:[(0,n.jsx)("span",{children:"convo id: "}),(0,n.jsx)("span",{className:"block",children:null==s?void 0:s.conversation.conversationId})]}):null}function C(){let e=(0,r.gK)(y.Z("lastMessageId")),t=(0,h.CI)(y.Z("byId"));return(0,n.jsx)(a.zx,{className:"text-red-600 font-normal",variant:"text",size:"none",onClick:()=>{(function(e,t){if(!e){console.error("No last message id");return}let s=t[e];if(!s){console.error("No response for last message id",e);return}let n=new Blob([JSON.stringify((0,m.Bv)(s,t).map(e=>t[e]).map(e=>({role:"human"===e.sender?"user":"assistant",content:e.message,...g().pick(e,"thinkingTrace","steps","generatedImageUrls","metadata")})),null,2)],{type:"application/json"}),r=window.URL.createObjectURL(n);window.open(r,"_blank")})(e,t)},children:"export"})}function P(e){let{response:t}=e;return E()?(0,n.jsxs)("div",{className:(0,f.cn)("absolute text-red-600 font-normal text-xs bottom-[2.5rem]","opacity-0 group-focus-within:opacity-100 group-hover:opacity-100 transition-opacity","flex flex-row gap-1"),children:[(0,n.jsx)("span",{children:"res id: "}),(0,n.jsx)("span",{className:"block",children:t.responseId})]}):null}},9682:function(e,t,s){"use strict";s.d(t,{d:function(){return p}});var n=s(2899),r=s(76038),i=s(34116),a=s(87678),l=s(49810),o=s(72242),c=s(41307),d=s(10090),u=s(74239),m=s(56672),f=s(4694),x=s(70702),h=s(78394);let p=e=>{let{conversationId:t,shouldGetFromStore:s=!1,editingImage:p,className:v,buttonProps:g,location:b,children:y,onClick:w}=e,{t:j}=(0,x.$G)("base"),{ASSET_SERVER_URL:N}=(0,r.O)(),S=(0,d.i)(m.Z("open")),E=(0,c.O)(m.Z("listByConversationId")),k=(0,c.O)(m.Z("attachListByConversationId")),{client:I}=(0,u.useStatsigClient)(),C=E[null!=t?t:"no_conversation_id"],P=k[null!=t?t:"no_conversation_id"],_=(0,f.useMemo)(()=>{var e,t;return(null==C?void 0:C[0])&&(null==C?void 0:null===(e=C[0])||void 0===e?void 0:e.metadata)?null==C?void 0:null===(t=C[0])||void 0===t?void 0:t.metadata:(null==P?void 0:P[0])?(0,h.I)(null==P?void 0:P[0]):void 0},[C,P]),R=(0,f.useMemo)(()=>{if(!(_ instanceof Error))return null==_?void 0:_.fileUri},[_]),z=(0,f.useMemo)(()=>s&&!(_&&!(_ instanceof Error)),[s,_]),M=(0,f.useCallback)(e=>{e.stopPropagation(),!s||!_||_ instanceof Error?p&&S(p):S({metadata:_,url:(0,l.Vh)(N,R)});let t=p&&"assetKey"in p?p.assetKey:R||"";I.logEvent("image_editor_open",(0,a.s)(t||""),{location:b||""}),w&&w(e)},[s,p,_,R,w,I,t]);return(0,n.jsx)(i.zx,{...g,"aria-label":j("Edit image","Edit image"),disabled:z,className:(0,o.cn)("bg-surface-l2 hover:bg-warm-gray-100 dark:hover:bg-surface-l3",!z&&"*:hover:text-primary *:hover:transition-colors",v),onClick:M,children:y})}},75260:function(e,t,s){"use strict";s.d(t,{L:function(){return U},Q:function(){return O}});var n=s(2899),r=s(37330),i=s(69492),a=s(77119),l=s(81211),o=s(8781),c=s(89099),d=s(17010),u=s(72242),m=s(46913),f=s(13771),x=s(74239),h=s(67206),p=s(62719),v=s(11286),g=s(66218),b=s(82209),y=s(65671),w=s(13562),j=s(3667),N=s(73069),S=s(56672),E=s(4694),k=s(70702),I=s(75361),C=s(6087),P=s(4710),_=s(34116),R=s(27763);let z=[],M=()=>(0,n.jsxs)("div",{className:"relative w-8 h-8 flex items-center justify-center filter blur-[1.5px]",children:[(0,n.jsx)(j.E.div,{className:"absolute w-4 h-4 rounded-full bg-opacity-90 shadow-lg",style:{background:"radial-gradient(circle at 30% 30%, rgba(255, 255, 255, 0.8) 0%, rgba(255, 255, 255, 0) 70%)",boxShadow:"inset 2px 2px 4px rgba(255, 255, 255, 0.5), inset -2px -2px 4px rgba(0, 0, 0, 0.3)"},animate:{background:["radial-gradient(circle at 30% 30%, rgba(255, 255, 255, 0.8) 0%, rgba(139, 92, 246, 0.8) 50%, rgba(236, 72, 153, 0.8) 100%)","radial-gradient(circle at 30% 30%, rgba(255, 255, 255, 0.8) 0%, rgba(59, 130, 246, 0.8) 50%, rgba(139, 92, 246, 0.8) 100%)","radial-gradient(circle at 30% 30%, rgba(255, 255, 255, 0.8) 0%, rgba(139, 92, 246, 0.8) 50%, rgba(59, 130, 246, 0.8) 100%)","radial-gradient(circle at 30% 30%, rgba(255, 255, 255, 0.8) 0%, rgba(139, 92, 246, 0.8) 50%, rgba(236, 72, 153, 0.8) 100%)"],scale:[1,1.1,1]},transition:{duration:6,ease:"linear",repeat:1/0,times:[0,.33,.66,1]}}),(0,n.jsx)("div",{className:"absolute w-0.5 h-0.5 rounded-full bg-white opacity-5 blur-[2px]",style:{top:"35%",left:"35%"}}),(0,n.jsx)(j.E.div,{className:"absolute w-4 h-4 rounded-full",style:{border:"1px solid rgba(255, 255, 255, 0.3)",boxShadow:"inset 0 0 5px rgba(255, 255, 255, 0.5)"},animate:{opacity:[.7,.5,.7]},transition:{duration:3,ease:"easeInOut",repeat:1/0}})]});function O(e){let{responseId:t,memoryReferences:s,className:r}=e,{t:a}=(0,k.$G)("base"),c=(0,l.g)(),{client:d}=(0,x.useStatsigClient)(),u=(0,i.gK)(S.Z("sidePanelContent")),m=(0,i.gK)(S.Z("setSidePanelContent")),f=(0,o.w)(),h=(0,E.useMemo)(()=>{if((null==u?void 0:u.type)!=="memoryReferences")return!1;let e=u.data.memoryReferences.map(e=>e.conversationId);return s.every((t,s)=>t.conversationId===e[s])&&s.length===e.length},[u,s]),p=(0,E.useCallback)(()=>{if(h){m(void 0);return}d.logEvent("open_memory_reference_list",t),m({type:"memoryReferences",data:{responseId:t,memoryReferences:s}})},[h,s,t,m,d]);return 0===s.length?null:(0,n.jsx)(_.g$,{"aria-label":a("response-action.referenced-conversations","Referenced Conversations"),tooltipContent:(0,n.jsx)("p",{children:a("response-action.referenced-conversations","Referenced Conversations")}),tooltipContentProps:{side:"bottom"},variant:"ghostSecondary",size:f?"iconXl":"iconMd",onClick:p,className:r,children:(0,n.jsx)(R.k,{children:c.SHOW_ORB_ICON_MEMORY?(0,n.jsx)(M,{}):h?(0,n.jsx)(C.vJ,{className:"size-4 text-primary"}):(0,n.jsx)(C.vJ,{className:"size-4"})},h?"selected":"not-selected")})}function T(e){return e.charAt(0).toUpperCase()+e.slice(1)}function D(e){let{conversation:t}=e,s=(0,E.useMemo)(()=>{if(t.modifyTime||t.createTime)return function(e){let t=new Date(e),s=new Date,n=(s.getTime()-t.getTime())/864e5;return n<1?T((0,p.U)(e,s,{locale:d.Z.language})):n<7?T((0,p.U)(e,s,{unit:"day",locale:d.Z.language})):t.getFullYear()===s.getFullYear()?t.toLocaleDateString(d.Z.language,{day:"numeric",month:"short"}):t.toLocaleDateString(d.Z.language,{day:"numeric",month:"short",year:"numeric"})}(t.modifyTime||t.createTime)},[t.modifyTime,t.createTime]);return s?(0,n.jsx)("span",{className:(0,u.cn)("text-secondary text-sm"),children:s}):null}function L(e){let{responseId:t,memoryConversationId:s,onSettled:r,onlyShowOnHover:a}=e,{t:l}=(0,k.$G)("base"),{client:o}=(0,x.useStatsigClient)(),c=(0,h.NL)(),d=(0,i.gK)(S.Z("conversationId")),[u,f]=(0,E.useState)(!1),p=(0,E.useCallback)(e=>{e.stopPropagation(),o.logEvent("begin_forget_memory_reference",t,{responseId:t,memoryConversationId:s,threadConversationId:null!=d?d:""}),f(!0);let n=setTimeout(()=>{f(!1)},3e3);return()=>clearTimeout(n)},[s,t,d,o]),{mutate:g,isPending:b}=(0,h.Db)({mutationFn:()=>m.xU.chatDeleteMemory({conversationIds:[s]}),onError:()=>{f(!1),I.Am.error(l("memory.failed-to-delete-memory","Failed to delete memory"))},onSettled:()=>{f(!1),c.invalidateQueries({queryKey:["memories",t]}).catch(()=>{I.Am.error(l("memory.failed-to-refresh-memory-list","Failed to refresh memory list"))}),null==r||r()}});return(0,n.jsx)(n.Fragment,{children:u?(0,n.jsx)(_.zx,{onClick:e=>{e.stopPropagation(),o.logEvent("forget_memory_reference",t,{responseId:t,memoryConversationId:s,threadConversationId:null!=d?d:""}),g()},variant:"destructive",size:"pill",children:b?(0,n.jsx)(v.Z,{className:"size-4 animate-spin"}):l("Confirm","Confirm")}):(0,n.jsx)(_.zx,{className:a?"opacity-0 group-hover:opacity-100 transition-opacity duration-200":"",onClick:p,variant:"secondary",size:"pill",children:l("Forget","Forget")})})}function Z(e){let{responseId:t,memory:s,onClick:r}=e,{convoId:i,convoSummary:a}=s,o=(0,f.t)(S.Z("fetchGetConversation")),d=(0,l.g)(),m=(0,E.useCallback)(e=>{e.stopPropagation(),r()},[r]),{data:x,isLoading:h,error:p}=(0,c.f)(i?o(i):void 0),v=(0,E.useMemo)(()=>null==a?void 0:a.split("\n").map(e=>e.replace(/^[- ]*/,"")).join("\n"),[a]);return h||p||!x?null:(0,n.jsx)("div",{className:(0,u.cn)("block text-base hover:bg-card-hover rounded-xl focus:outline-none focus-within:outline-none focus-visible:ring-1 focus-visible:ring-ring w-full cursor-pointer"),onClick:m,children:(0,n.jsxs)("div",{className:"flex flex-row items-center justify-between gap-4 p-4 group",children:[(0,n.jsxs)("div",{className:(0,u.cn)("flex flex-col gap-2 max-w-[400px]",d.SHOW_MEMORY_SUMMARY&&"w-full max-w-[600px]"),children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"text-sm text-primary",children:x.title||"Untitled Memory"}),(0,n.jsx)("span",{className:"text-secondary text-sm",children:"  •  "}),(0,n.jsx)(D,{conversation:x})]}),d.SHOW_MEMORY_SUMMARY&&(0,n.jsx)("div",{className:"max-h-[100px] overflow-hidden pb-4 -mb-4 fade-mask-bottom",children:(0,n.jsx)("p",{className:"mt-1 text-xs text-primary break-words",children:v})})]}),!d.SHOW_MEMORY_SUMMARY&&(0,n.jsx)(L,{responseId:t,memoryConversationId:i,onlyShowOnHover:!0})]})})}function A(e){let{responseId:t,memory:s,onOpen:i,onBack:a}=e,{convoId:l,convoSummary:o}=s,d=(0,f.t)(S.Z("fetchGetConversation")),{data:m,isLoading:x,error:h}=(0,c.f)(l?d(l):void 0),p=(0,E.useMemo)(()=>null==o?void 0:o.split("\n").map(e=>e.replace(/^[- ]*/,"")).join("\n\n"),[o]);return x||h||!m?null:(0,n.jsxs)("div",{className:(0,u.cn)("p-4 max-w-[600px]"),children:[(0,n.jsxs)("div",{className:"flex flex-row items-center justify-between gap-4",children:[(0,n.jsxs)("div",{className:"flex flex-row items-center gap-2",children:[(0,n.jsx)(_.zx,{variant:"ghostSecondary",size:"iconSm",onClick:()=>a(),children:(0,n.jsx)(g.Z,{className:"size-4"})}),(0,n.jsx)("div",{className:"group cursor-pointer relative text-sm",onClick:()=>i(),children:(0,n.jsxs)("span",{className:"group-hover:underline flex flex-row items-center gap-1",children:[(0,n.jsx)("span",{className:"line-clamp-1",children:m.title||"Untitled Memory"}),(0,n.jsx)(b.Z,{size:22,className:"text-primary rounded-full bg-card p-1 flex-shrink-0"})]})})]}),(0,n.jsx)(L,{responseId:t,memoryConversationId:l,onSettled:()=>{a()}})]}),(0,n.jsx)("div",{className:"p-4 prose dark:prose-invert text-sm",children:(0,n.jsx)(r.Cn,{sender:"",webSearchResults:z,xposts:z,children:null!=p?p:""})})]})}function U(e){let{responseId:t,memoryReferences:s}=e,{t:r}=(0,k.$G)("base"),i=(0,l.g)(),{routeToConversation:o}=(0,a.o)(),{client:c}=(0,x.useStatsigClient)(),{data:d,isLoading:f,error:p,refetch:v}=(0,h.aM)({queryKey:["memories",t],queryFn:()=>{let e=s.map(e=>e.conversationId).filter(e=>void 0!==e);return m.xU.chatGetMemory({body:{conversationIds:e}})}}),[g,b]=(0,E.useState)(null),S=(0,E.useCallback)(e=>{var s;c.logEvent("open_memory_reference",t,{memoryConversationId:null!==(s=e.convoId)&&void 0!==s?s:""}),i.OPEN_MEMORY_IN_NEW_TAB?window.open("/chat/".concat(e.convoId),"_blank"):o(e.convoId)},[o,c,i.OPEN_MEMORY_IN_NEW_TAB,t]);if(f)return(0,n.jsx)("div",{className:"flex flex-col items-center px-4 pt-1 pb-2 gap-2",children:(0,n.jsx)(P.S,{})});if(p)return(0,n.jsx)("div",{className:"flex flex-col items-center px-4 pt-1 pb-2 gap-2 w-full",children:(0,n.jsx)(j.E.div,{initial:{translateY:5,opacity:0},animate:{translateY:0,opacity:1},exit:{translateY:5,opacity:0},className:(0,u.cn)("w-fit","p-4 bg-card","shadow-sm","border border-input-border rounded-2xl","ml-4 md:mx-4"),children:(0,n.jsxs)("div",{className:"flex items-center gap-4 flex-wrap",children:[(0,n.jsx)(y.Z,{className:(0,u.cn)("h-5 w-5 flex-shrink-0")}),(0,n.jsx)("div",{className:"flex-1 max-w-96",children:(0,n.jsx)("div",{className:"text-primary text-sm",children:r("memory.error","Failed to load memories.")})}),(0,n.jsxs)(_.zx,{variant:"secondary",size:"pill",onClick:()=>{v()},children:[(0,n.jsx)(w.Z,{className:"mr-2 h-4 w-4"}),r("Retry","Retry")]})]})})});if(!d||!d.memories)return(0,n.jsx)("div",{className:"flex flex-col items-center px-4 pt-1 pb-2 gap-2",children:(0,n.jsx)("p",{className:"text-sm text-primary",children:r("memory.no-memories","No memories to display.")})});let I=d.memories;return i.SHOW_MEMORY_SUMMARY?(0,n.jsx)(N.M,{children:(0,n.jsx)("div",{className:"flex flex-row",children:g?(0,n.jsx)(j.E.div,{initial:{x:200,opacity:0},animate:{x:0,opacity:1},exit:{x:200,opacity:0},transition:{duration:.1},className:"w-full",children:(0,n.jsx)(A,{responseId:t,memory:g,onOpen:()=>S(g),onBack:()=>b(null)})},"memory-detail"):(0,n.jsx)(j.E.div,{initial:{x:-200,opacity:0},animate:{x:0,opacity:1},exit:{x:-200,opacity:0},transition:{duration:.1},className:"flex flex-col items-center px-4 pt-1 pb-2 gap-2 max-w-full",children:I.length>0?null==I?void 0:I.map(e=>(0,n.jsx)(Z,{responseId:t,memory:e,onClick:()=>b(null!=e?e:null)},e.convoId)):(0,n.jsx)("p",{className:"text-sm text-primary",children:r("memory.no-memories","No memories to display.")})},"memory-list")})}):(0,n.jsx)("div",{className:"flex flex-col items-center px-4 pt-1 pb-2 gap-2 max-w-full",children:I.length>0?null==I?void 0:I.map(e=>(0,n.jsx)(Z,{responseId:t,memory:e,onClick:()=>S(e)},e.convoId)):(0,n.jsx)("p",{className:"text-sm text-primary",children:r("memory.no-memories","No memories to display.")})})}},9593:function(e,t,s){"use strict";let n;s.d(t,{QueryClientProvider:function(){return o}});var r=s(2899),i=s(67206);let a=()=>new i.Su({defaultOptions:{queries:{staleTime:3e5,gcTime:3e5}}}),l=()=>i.sk?a():(n||(n=a()),n),o=e=>{let{children:t,dehydratedState:s}=e,n=l();return(0,r.jsx)(i.aH,{client:n,children:(0,r.jsx)(i.Rq,{state:s,children:t})})}},38199:function(e,t,s){"use strict";s.d(t,{O:function(){return i}});var n=s(2899),r=s(72242);function i(e){let{className:t,...s}=e;return(0,n.jsx)("div",{className:(0,r.cn)("animate-pulse rounded-md bg-primary/10",t),...s})}},2043:function(e,t,s){"use strict";s.d(t,{Toaster:function(){return o}});var n=s(2899),r=s(72242),i=s(65671),a=s(40881),l=s(75361);let o=e=>{let{...t}=e,{theme:s}=(0,a.F)();return(0,n.jsx)(l.x7,{theme:s,className:"toaster group",toastOptions:{classNames:{toast:(0,r.cn)("group toast bg-popover rounded-2xl border-0 shadow-sm","w-fit min-w-[200px] left-0 right-0 sm:mx-auto","ring-1 ring-inset ring-input-border","p-3.5 h-fit"),title:"text-primary font-bold",icon:"ml-0 mr-1",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},icons:{error:(0,n.jsx)(i.Z,{size:18})},...t})}},87678:function(e,t,s){"use strict";s.d(t,{s:function(){return a},t:function(){return i}});var n=s(27422),r=s(4694);function i(){let e=(0,r.useRef)(void 0),t=(0,r.useRef)(void 0),s=(0,r.useCallback)(()=>{e.current=Date.now()},[]),i=(0,r.useCallback)(()=>{t.current=Date.now()},[]),a=(0,r.useCallback)(()=>{let t=(0,n.Z)(e.current);return e.current=void 0,t},[]),l=(0,r.useCallback)(()=>{let e=(0,n.Z)(t.current);return t.current=void 0,e},[]),o=(0,r.useCallback)(()=>{e.current=void 0,t.current=void 0},[]);return{handleSendStart:s,handleStreamingStart:i,consumeTimeToSendMs:a,consumeStreamingTimeMs:l,timeToSendStart:e.current,streamingTimeStart:t.current,reset:o}}let a=e=>e.replace(/^https?:\/\/[^/]+\/?/,"").replace(/\/(original_image|image)\.jpg$/,"")},89099:function(e,t,s){"use strict";s.d(t,{f:function(){return r}});var n=s(4694);function r(e){let t=(0,n.useRef)();t.current=e;let[s,r]=(0,n.useState)(),[i,a]=(0,n.useState)(),[l,o]=(0,n.useState)(!1),[c,d]=(0,n.useState)(!1),[u,m]=(0,n.useState)(!1),[f,x]=(0,n.useState)(!1),[h,p]=(0,n.useState)(!0);return(0,n.useEffect)(()=>{if(!e){r(void 0),a(void 0),o(!0),d(!1),m(!1),x(!0),p(!1);return}if(!f){x(!0);return}let s={status:"UNSET",value:void 0,error:void 0};e.then(n=>{t.current===e&&("PASSED"===s.status?(r(n),a(void 0),o(!0),d(!1),m(!1)):(s.status="SETVALUE",s.value=n))}).catch(n=>{t.current===e&&("PASSED"===s.status?(r(void 0),a(n),o(!1),d(!0),m(!1)):(s.status="SETERROR",s.error=n))}),setTimeout(()=>{if(t.current===e){switch(p(!1),s.status){case"UNSET":r(void 0),a(void 0),o(!1),d(!1),m(!0);break;case"SETVALUE":r(s.value),a(void 0),o(!0),d(!1),m(!1);break;case"SETERROR":r(void 0),a(s.error),o(!1),d(!0),m(!1)}s.status="PASSED"}})},[f,e]),{data:s,error:i,isResolved:l,isErrored:c,isLoading:u,isUninitialized:h}}},14901:function(e,t,s){"use strict";s.d(t,{z:function(){return i}});var n=s(33263),r=s(46913);async function i(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.xU,s=arguments.length>2?arguments[2]:void 0,i=await t.chatGetShareLink({shareLinkId:e},{headers:s});if(!i.conversation)throw Error("Conversation not found.");if(!i.responses||0===i.responses.length)throw Error("No responses in conversation.");let a={...i.conversation,personaId:(0,n.BV)(i.conversation.systemPromptName)};return{responses:i.responses.map(e=>({...e,conversationId:a.conversationId,state:"closed"})),conversation:a}}},40794:function(e,t,s){"use strict";s.d(t,{_:function(){return o},o:function(){return d}});var n=s(2899),r=s(4694),i=s(13341),a=s(15419);let l=(0,r.createContext)(null);function o(e,t){let s=(0,r.useContext)(l);if(!s)throw Error("Add GlobalFileDropProvider when using useGlobalFileDrop");let n=(0,r.useRef)(Symbol("useGlobalFileId")),{collectedProps:i,hookId:a,subscribe:o}=s;return(0,r.useEffect)(()=>{if(a&&a!==n.current){console.warn("Other component already taken over GlobaFileDropProvider");return}return o({options:"function"==typeof e?e():e,hookId:n.current}),()=>{o(null)}},[o,...null!=t?t:[]]),i}let c={accept:[a.FILE]};function d(e){var t,s;let{className:a,children:o}=e,[d,u]=(0,r.useState)(null),m=(0,r.useRef)(null),f=null!==(t=null==d?void 0:d.options)&&void 0!==t?t:c,[x,h]=(0,i.L)(f);h(m);let p=null!==(s=null==d?void 0:d.hookId)&&void 0!==s?s:null,v=(0,r.useMemo)(()=>({collectedProps:x,hookId:p,subscribe:u}),[x,u,p]);return(0,n.jsx)("div",{ref:m,className:a,"data-testid":"global-drop",children:(0,n.jsx)(l.Provider,{value:v,children:o})})}},88669:function(e,t,s){"use strict";s.d(t,{DirectionProvider:function(){return c}});var n=s(2899),r=s(74239),i=s(87325),a=s(78147),l=s(4694),o=s(88101);function c(e){let{children:t}=e,[s,c]=(0,l.useState)(()=>(0,o.w1)(i.ZP.language)),{client:d}=(0,r.useStatsigClient)();return(0,l.useEffect)(()=>{let e=e=>{i.ZP.isInitializing||d.logEvent("locale_changed",e,{languages:i.ZP.languages.join(", "),location:"src/lib/locales/direction-provider"});let t=(0,o.w1)(e);"rtl"===t?document.body.dir=t:document.body.dir="",c(t)};return i.ZP.on("languageChanged",e),()=>i.ZP.off("languageChanged",e)},[]),(0,n.jsx)(a.zt,{dir:s,children:t})}},27422:function(e,t,s){"use strict";function n(e){return e?Date.now()-e:0}s.d(t,{Z:function(){return n}})},10090:function(e,t,s){"use strict";s.d(t,{i:function(){return i}});var n=s(29598);class r{constructor(e,t){this.set=e,this.get=t,this.isOpen=!1,this.currentImage=null,this.setImage=e=>{this.set({currentImage:e})},this.open=e=>{this.set({currentImage:null!=e?e:null,isOpen:!0})},this.close=()=>{this.set({currentImage:null,isOpen:!1})}}}let i=(0,n.MT)(r)},74417:function(e,t,s){"use strict";s.d(t,{_:function(){return i}});var n=s(29598);class r{constructor(e,t){this.set=e,this.get=t,this.isUpselling=!1,this.setIsUpselling=(0,n.f0)(this.set,"isUpselling")}}let i=(0,n.MT)(r);"#subscribe"===window.location.hash&&i.getState().setIsUpselling(!0),i.subscribe((e,t)=>{var s;e.isUpselling!==t.isUpselling&&(s=e.isUpselling?"subscribe":void 0,window.history.pushState({},"","".concat(window.location.pathname).concat(s?"#".concat(s):"")))}),window.addEventListener("popstate",()=>{let e=window.location.hash;i.getState().setIsUpselling("#subscribe"===e)})},30745:function(){}},function(e){e.O(0,[3759,5493,5113,6299,536,1805,9782,4361,6060,6791,4947,7134,1577,9901,4138,5959,3266,8196,4558,9391,904,442,1217,7261,181,6485,3335,3535,124,2910,8907,4535,2063,83,4072,1744],function(){return e(e.s=6807)}),_N_E=e.O()}]);