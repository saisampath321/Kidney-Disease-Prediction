!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="5ef03ebd-2d90-4e20-b3b7-b47eaf607520",e._sentryDebugIdIdentifier="sentry-dbid-5ef03ebd-2d90-4e20-b3b7-b47eaf607520")}catch(e){}}();"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6485],{69492:function(e,t,s){s.d(t,{gK:function(){return A}});var n=s(87005),r=s(84503),o=s(8781),i=s(39589);function a(e){let t=!1;return()=>{t||(e(),t=!0)}}var l=s(74542),d=s(6123),c=s(29598),m=s(64846),u=s(73197),p=s(43701),h=s(67206),g=s(30722),f=s.n(g),I=s(91218),v=s(75361),y=s(54596),w=s(11194),S=s(85035),R=s(2899);let b=[1];var x=s(46913),C=s(4077),_=s(92127),M=s(4694),T=s(70702);let P=e=>{let{modelName:t,reasoningMode:s,waitTimeSeconds:n}=e,{t:r}=(0,T.$G)("chat"),{modelById:o}=(0,C.bP)(),i=(0,M.useMemo)(()=>{var e;return(null===(e=o[t])||void 0===e?void 0:e.name)||t},[o,t]),a=(0,M.useMemo)(()=>{let e=Math.floor(n/3600),t=Math.floor(n%3600/60);return e>0&&t>0?"".concat(r("time.hours",{defaultValue_one:"{{count}} hour",defaultValue_other:"{{count}} hours",count:e})," ").concat(r("time.minutes",{count:t,defaultValue_one:"{{count}} minutes",defaultValue_other:"{{count}} minutes"})):e>0?r("time.hours",{defaultValue_one:"{{count}} hour",defaultValue_other:"{{count}} hours",count:e}):r("time.minutes",{count:t,defaultValue_one:"{{count}} minutes",defaultValue_other:"{{count}} minutes"})},[n]),l=(0,M.useMemo)(()=>"DEEPSEARCH"===s?r("Rate Limit Reached.description-deepsearch","Query limit reached for {{modelName}} with DeepSearch. Limit refreshes in {{time}}.",{modelName:i,time:a}):"DEEPERSEARCH"===s?r("Rate Limit Reached.description-deepersearch","Query limit reached for {{modelName}} with DeeperSearch. Limit refreshes in {{time}}.",{modelName:i,time:a}):"REASONING"===s?r("Rate Limit Reached.description-reasoning","Query limit reached for {{modelName}} with Think. Limit refreshes in {{time}}.",{modelName:i,time:a}):r("Rate Limit Reached.description","Query limit reached for {{modelName}}. Limit refreshes in {{time}}.",{modelName:i,time:a}),[a,i,r,s]);return(0,R.jsxs)("div",{className:"flex items-center gap-2",children:[(0,R.jsx)(_.aNP,{className:"size-5"}),(0,R.jsx)("div",{className:"font-semibold text-xs",children:l})]})},E=e=>{let{modelName:t,reasoningMode:s,remainingQueries:n,windowSizeSeconds:r}=e,{t:o}=(0,T.$G)("chat"),{modelById:i}=(0,C.bP)(),a=(0,M.useMemo)(()=>{var e;return(null===(e=i[t])||void 0===e?void 0:e.name)||t},[i,t]),l=(0,M.useMemo)(()=>{let e=Math.floor(r/3600),t=Math.floor(r%3600/60);return e>0&&t>0?"".concat(o("time.hours",{defaultValue_one:"{{count}} hour",defaultValue_other:"{{count}} hours",count:e})," ").concat(o("time.minutes",{count:t,defaultValue_one:"{{count}} minutes",defaultValue_other:"{{count}} minutes"})):e>0?o("time.hours",{defaultValue_one:"{{count}} hour",defaultValue_other:"{{count}} hours",count:e}):o("time.minutes",{count:t,defaultValue_one:"{{count}} minutes",defaultValue_other:"{{count}} minutes"})},[r]),d=(0,M.useMemo)(()=>"DEEPSEARCH"===s?o("Remaining Queries.description-deepsearch",{modelName:a,count:n,time:l,defaultValue_one:"One query left for {{modelName}} with DeepSearch. Limit resets every {{time}}.",defaultValue_other:"You have {{count}} remaining queries for {{modelName}} with DeepSearch. Limit resets every {{time}}."}):"DEEPERSEARCH"===s?o("Remaining Queries.description-deepersearch",{modelName:a,count:n,time:l,defaultValue_one:"One query left for {{modelName}} with DeeperSearch. Limit resets every {{time}}.",defaultValue_other:"You have {{count}} remaining queries for {{modelName}} with DeeperSearch. Limit resets every {{time}}."}):"REASONING"===s?o("Remaining Queries.description-reasoning",{modelName:a,count:n,time:l,defaultValue_one:"One query left for {{modelName}} with Think. Limit resets every {{time}}.",defaultValue_other:"You have {{count}} remaining queries for {{modelName}} with Think. Limit resets every {{time}}."}):o("Remaining Queries.description",{modelName:a,count:n,time:l,defaultValue_one:"One query left for {{modelName}}. Limit resets every {{time}}.",defaultValue_other:"You have {{count}} remaining queries for {{modelName}}. Limit resets every {{time}}."}),[n,a,l,o,s]);return(0,R.jsxs)("div",{className:"flex items-center gap-2",children:[(0,R.jsx)(_.aNP,{className:"size-5"}),(0,R.jsx)("div",{className:"text-xs font-semibold",children:d})]})};function N(e){x.Bv.rateLimitsGetRateLimits({body:e}).then(t=>{void 0!==t.remainingQueries&&b.includes(t.remainingQueries)?v.Am.info((0,R.jsx)(E,{reasoningMode:e.requestKind,modelName:e.modelName,remainingQueries:t.remainingQueries,windowSizeSeconds:t.windowSizeSeconds||0}),{duration:7e3}):0===t.remainingQueries&&t.waitTimeSeconds&&v.Am.info((0,R.jsx)(P,{reasoningMode:e.requestKind,modelName:e.modelName,waitTimeSeconds:t.waitTimeSeconds}),{duration:7e3})}).catch(e=>{(0,l.H)("chat-page-store:checkRateLimits",e)})}function k(e){v.Am.info(function(e,t){let s=e.trim().replace(/^[^a-zA-Z0-9]+|[^a-zA-Z0-9]+$/g,"");return s.length>200?s.slice(0,200)+"...":s}(e,0),{duration:7e3})}y.z.union([y.z.literal("auto"),y.z.literal("image"),y.z.literal("search"),y.z.literal("modelOnly"),y.z.literal("noSearch")]);class B{constructor(e,t){this.set=e,this.get=t,this.activeModelId=r.fr,this.isRateLimited=!1,this.isThinkingRateLimited=!1,this.isDeepSearchRateLimited=!1,this.isUnauthenticated=!1,this.hasDismissedDisclaimer=!1,this.outputMode="auto",this.reasoningMode="none",this.usingExperiment=!1,this.experiments=[],this.streamingExperimentsIds=[],this.queryBarExpanded=!1,this.isTypingDebounce=!1,this.selectedPersonalityId=void 0,this.customPersonality=void 0,this.queryByConversationId={},this.chatPageLoaded=!1,this.isDeeperSearchSelected=!1,this.setConversationId=(0,c.f0)(this.set,"conversationId"),this.setOptimisticConversationId=(0,c.f0)(this.set,"optimisticConversationId"),this.setLastMessageId=(0,c.f0)(this.set,"lastMessageId"),this.setSidePanelContent=(0,c.f0)(this.set,"sidePanelContent"),this.setStreamedMessageId=(0,c.f0)(this.set,"streamedMessageId"),this.setActiveModelId=(0,c.f0)(this.set,"activeModelId"),this.setSelectedSystemPromptId=(0,c.f0)(this.set,"selectedSystemPromptId"),this.setIsRateLimited=(0,c.f0)(this.set,"isRateLimited"),this.setIsUnauthenticated=(0,c.f0)(this.set,"isUnauthenticated"),this.setHasDismissedDisclaimer=(0,c.f0)(this.set,"hasDismissedDisclaimer"),this.setOptimisticMessageId=(0,c.f0)(this.set,"optimisticMessageId"),this.setOutputMode=(0,c.f0)(this.set,"outputMode"),this.setReasoningMode=(0,c.f0)(this.set,"reasoningMode"),this.setChatPageLoaded=(0,c.f0)(this.set,"chatPageLoaded"),this.setUsingExperiment=e=>{this.removeAllExperiments(),this.removeAllStreamingExperiments(),this.set(t=>({...t,usingExperiment:e}))},this.removeAllExperiments=(0,c.o0)(this.set,"experiments",[]),this.setExperiments=(0,c.f0)(this.set,"experiments"),this.addExperiment=(0,c.IH)(this.set,"experiments"),this.removeExperiment=e=>{this.set(t=>{let s=[...t.experiments];return s.splice(e,1),{...t,experiments:s}})},this.setStreamingExperimentsIds=(0,c.f0)(this.set,"streamingExperimentsIds"),this.addStreamingExperimentId=(0,c.IH)(this.set,"streamingExperimentsIds"),this.removeAllStreamingExperiments=(0,c.o0)(this.set,"streamingExperimentsIds",[]),this.setSelectedPersonalityId=(0,c.f0)(this.set,"selectedPersonalityId"),this.setCustomPersonality=(0,c.f0)(this.set,"customPersonality"),this.idsetQueryByConversationId=(0,c.Qd)(this.set,"queryByConversationId"),this.setQueryBarExpanded=e=>this.set({queryBarExpanded:e}),this.setIsTypingDebounce=e=>this.set({isTypingDebounce:e}),this.setIsDeeperSearchSelected=(0,c.f0)(this.set,"isDeeperSearchSelected"),this.isErrorRetryable=e=>{let t=(0,d.x0)(e);return 429===t?(this.setIsRateLimited(!0),!1):401===t?(this.setIsUnauthenticated(!0),!1):!(t&&t>=400&&t<500||e.message.includes("Failed to respond")||e.message.includes(h.EU)||e.message.includes(h.pJ))},this.establishNewConversation=async e=>{let{temporary:t,message:s,fileAttachmentIds:n,webpageUrls:r,toolOverrides:l,isPreset:d,persona:c,enableRetries:h,imageEditUri:g,workspaceIds:I}=e,v=this.get(),y=u.CI.getState(),w=p.F.getState(),S=m.Zv.getState(),R=f().get(S.byId,w.userSettings.preferences.selectedSystemPromptId||""),b=v.activeModelId,x=void 0,C=(null==R?void 0:R.prompt)||v.customPersonality,_=!1;return new Promise((e,m)=>{y.streamCreateAndRespond({temporary:t,message:s,modelName:b,fileAttachmentIds:n,webpageUrls:r,systemPromptName:null==c?void 0:c.systemPromptName,personaId:null==c?void 0:c.personaId,toolOverrides:null!=l?l:z(v.outputMode,v.reasoningMode),isPreset:d,customInstructions:x,customPersonality:C,deepsearchPreset:(0,i.TP)(v.reasoningMode),isReasoning:"think"===v.reasoningMode,imageEditUri:g,enableRetries:h,workspaceIds:I,onOptimisticConversation:e=>{let{conversationId:t}=e;v.setOptimisticConversationId(t)},onOptimisticResponse:e=>{let{responseId:t}=e;v.setOptimisticMessageId(t)},onStart:e=>{var t;v.setStreamedMessageId(null===(t=e[0])||void 0===t?void 0:t.responseId)},onConversation:t=>{v.setConversationId(t.conversationId),v.setOptimisticConversationId(void 0),_=!0,e(t)},onUserResponse:e=>{v.setLastMessageId(e.responseId),v.setOptimisticMessageId(e.responseId)},onStartExperiment:e=>{v.setUsingExperiment(!0),e.forEach(e=>{v.addStreamingExperimentId(e),v.addExperiment({})})},onCitations:e=>{if((!window||!(window.innerWidth<o.G))&&w.userSettings.preferences.autoOpenSearchResults){if(e.webSearchResults){v.setSidePanelContent({type:"webSearchResults",data:{webSearchResults:e.webSearchResults}});return}if(e.xposts){v.setSidePanelContent({type:"xPosts",data:e.xposts});return}}},onDisclaimer:c?()=>{}:k,onHasImage:a(()=>w.setShowAgeVerification(!0)),onClose:e=>{e.length>1&&(v.setExperiments(e),v.setStreamingExperimentsIds(e.map(e=>e.responseId)));let t=f().first(e);t&&this.get().lastMessageId===t.parentResponseId&&(v.setLastMessageId(t.responseId),v.setStreamedMessageId(t.responseId)),v.setOptimisticConversationId(void 0),N({modelName:b,requestKind:(0,i.j4)(v.reasoningMode)}),_||m(Error("Not resolved by close"))},onWke:e=>{"RateLimitError"===e.name&&v.setIsRateLimited(!0),m(e)},onError:this.isErrorRetryable}).catch(e=>{m(e)})})},this.sendResponse=async e=>{let{message:t,parentResponseId:s,conversationId:n,fileAttachmentIds:r,webpageUrls:l,toolOverrides:d,setOpimisticUserResponse:c,setUserResponse:h,onOptimisticUserResponse:g,onError:I,imageEditUri:v,persona:y,enableRetries:w,metadata:S}=e,R=this.get(),b=u.CI.getState(),x=p.F.getState(),C=m.Zv.getState(),_=f().get(C.byId,x.userSettings.preferences.selectedSystemPromptId||""),M=R.activeModelId,T=void 0,P=(null==_?void 0:_.prompt)||R.customPersonality;return R.setUsingExperiment(!1),R.setLastMessageId(s),new Promise((e,m)=>{b.streamResponse({message:t,metadata:S,parentResponseId:s,conversationId:n,modelName:M,systemPromptName:null==y?void 0:y.systemPromptName,fileAttachmentIds:r,webpageUrls:l,toolOverrides:{...z(R.outputMode,R.reasoningMode),...null!=d?d:{}},customInstructions:T,customPersonality:P,deepsearchPreset:(0,i.TP)(R.reasoningMode),isReasoning:"think"===R.reasoningMode,imageEditUri:v,enableRetries:w,onOptimisticUserResponse:e=>{c&&(R.setOptimisticMessageId(e.responseId),null==g||g(e))},onOptimisticModelResponse:e=>{R.setStreamedMessageId(e.responseId)},onStart:e=>{var t;R.setStreamedMessageId(null===(t=e[0])||void 0===t?void 0:t.responseId)},onUserResponse:e=>{h&&(R.setLastMessageId(e.responseId),R.setOptimisticMessageId(e.responseId))},onStartExperiment:e=>{R.setUsingExperiment(!0),e.forEach(e=>{R.addStreamingExperimentId(e),R.addExperiment({})})},onCitations:e=>{if((!window||!(window.innerWidth<o.G))&&x.userSettings.preferences.autoOpenSearchResults){if(e.webSearchResults){R.setSidePanelContent({type:"webSearchResults",data:{webSearchResults:e.webSearchResults}});return}if(e.xposts){R.setSidePanelContent({type:"xPosts",data:e.xposts});return}}},onDisclaimer:y?()=>{}:k,onHasImage:a(()=>x.setShowAgeVerification(!0)),onClose:t=>{t.length>1&&(R.setExperiments(t),R.setStreamingExperimentsIds(t.map(e=>e.responseId)));let s=f().first(t);if(s&&this.get().lastMessageId===s.parentResponseId&&(R.setLastMessageId(s.responseId),R.setStreamedMessageId(s.responseId)),t.length&&t.every(e=>"closed"===e.state))e(t);else{let e=Error("Responses missing, errored, or not closed");null==I||I(e),m(e)}N({modelName:M,requestKind:(0,i.j4)(R.reasoningMode)})},onWke:e=>{"RateLimitError"===e.name&&R.setIsRateLimited(!0),null==I||I(e),m(e)},onError:this.isErrorRetryable}).catch(e=>{null==I||I(e),m(e)})})},this.reconnectToInflightResponses=async(e,t)=>{let s=this.get(),n=u.CI.getState(),r=p.F.getState(),d=s.activeModelId;try{let c=await n.fetchListInflightResponses(e);if(!c.length)return;let m=f().maxBy(c,e=>new Date(e.createTime?e.createTime:0));if(!m)return;if(!m.responseId){(0,l.H)("chat-page-store:reconnectToInflightResponses","Inflight response missing response id");return}if(!m.parentResponseId){(0,l.H)("chat-page-store:reconnectToInflightResponses","Inflight response missing parent response id:");return}s.setLastMessageId(m.parentResponseId),await n.reconnectToResponse({inflightResponse:m,conversationId:e,modelName:d,parentResponseId:m.parentResponseId,enableRetries:t,isReasoning:"think"===s.reasoningMode,deepsearchPreset:(0,i.TP)(s.reasoningMode),onStart:e=>{let t=e[0];t&&s.setStreamedMessageId(t.responseId)},onCitations:e=>{if((!window||!(window.innerWidth<o.G))&&r.userSettings.preferences.autoOpenSearchResults){if(e.webSearchResults){s.setSidePanelContent({type:"webSearchResults",data:{webSearchResults:e.webSearchResults}});return}if(e.xposts){s.setSidePanelContent({type:"xPosts",data:e.xposts});return}}},onDisclaimer:k,onHasImage:a(()=>r.setShowAgeVerification(!0)),onClose:(e,t)=>{e.length>1&&(s.setExperiments(e),s.setStreamingExperimentsIds(t));let n=f().first(e);n&&(s.setLastMessageId(n.responseId),s.setStreamedMessageId(void 0)),N({modelName:d,requestKind:(0,i.j4)(s.reasoningMode)})},onWke:e=>{"RateLimitError"===e.name&&s.setIsRateLimited(!0),console.error("Error reconnecting to response:",e)},onError:this.isErrorRetryable})}catch(e){console.error("Error checking for inflight responses:",e)}}}}let A=(0,w.U)()((0,S.XR)((0,S.tJ)((e,t)=>new B(e,t),{name:"chat-preferences",partialize:e=>({outputMode:e.outputMode,activeModelId:e.activeModelId,selectedPersonalityId:e.selectedPersonalityId,customPersonality:e.customPersonality}),version:1})));function z(e,t){switch(t){case"deepsearch":case"deepersearch":return{imageGen:!1,webSearch:!1,xSearch:!1,xMediaSearch:!1,trendsSearch:!1,xPostAnalyze:!1}}switch(e){case"modelOnly":return{imageGen:!1,webSearch:!1,xSearch:!1,xMediaSearch:!1,trendsSearch:!1,xPostAnalyze:!1};case"noSearch":return{imageGen:void 0,webSearch:!1,xSearch:!1,xMediaSearch:!1,trendsSearch:!1,xPostAnalyze:!1};default:return{imageGen:void 0,webSearch:void 0,xSearch:void 0,xMediaSearch:void 0,trendsSearch:void 0,xPostAnalyze:void 0}}}(0,c.N7)(A,"conversationId","optimisticConversationId",()=>void 0),(0,c.N7)(A,"conversationId","isRateLimited",()=>!1),(0,c.N7)(A,"conversationId","isUnauthenticated",()=>!1),(0,c.N7)(A,"conversationId","hasDismissedDisclaimer",()=>!1),(0,c.N7)(A,"conversationId","usingExperiment",()=>!1),(0,c.N7)(A,"conversationId","experiments",()=>[]),(0,c.N7)(A,"conversationId","streamingExperimentsIds",()=>[]),(0,c.N7)(A,"activeModelId","isRateLimited",()=>!1),(0,c.N7)(A,"reasoningMode","isRateLimited",()=>!1),function(e){let t=new I.y("/chat/:chatId"),s=t.test(window.location.pathname);e.setState({conversationId:s?s.chatId:void 0}),window.addEventListener("popstate",()=>{let s=t.test(window.location.pathname);e.setState({conversationId:s?s.chatId:void 0})}),e.subscribe((e,s)=>{if(e.conversationId===s.conversationId)return;let r=window.location.pathname,o=t.test(window.location.pathname);if("/"!==r&&!o)return;let i=new URLSearchParams(window.location.search);i.delete("q"),i.delete("reasoningMode");let a=i.toString(),l=a?"?".concat(a):"",d=p.F.getState(),c=null===n.mU||void 0===n.mU?void 0:n.mU.getState();if(!(r.split("/")[1]||"").includes(".")){if(e.conversationId&&!d.isIncognito&&(null==c?void 0:c.user)){let s=t.build({chatId:e.conversationId});if(r!==s){let e="".concat(s).concat(l);window.history.pushState({...window.history.state,as:e,url:e},"",e)}}else if("/"!==r){let e="/".concat(l);window.history.pushState({...window.history.state,as:e,url:e},"",e)}}})}(A)},40202:function(e,t,s){s.d(t,{l$:function(){return x},Bn:function(){return b}});var n=s(2899),r=s(34116),o=s(40955),i=s(42210),a=s(72242),l=s(98450),d=s(49999),c=s(4694);d.fC,d.ZA,d.B4,c.forwardRef((e,t)=>{let{className:s,children:r,...o}=e;return(0,n.jsxs)(d.xz,{ref:t,className:(0,a.cn)("group flex h-9 w-full items-center justify-between whitespace-nowrap rounded-lg border border-toggle-border bg-transparent px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus-visible:ring-1 focu-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1 [&>svg.chevron-down]:data-[state=open]:rotate-180",s),...o,children:[r,(0,n.jsx)(d.JO,{asChild:!0,children:(0,n.jsx)(l.v4q,{className:"w-4 h-4 opacity-50 transition-transform chevron-down"})})]})}).displayName=d.xz.displayName;let m=c.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,n.jsx)(d.u_,{ref:t,className:(0,a.cn)("flex cursor-default items-center justify-center py-1",s),...r,children:(0,n.jsx)(l.g8U,{className:"w-4 h-4"})})});m.displayName=d.u_.displayName;let u=c.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,n.jsx)(d.$G,{ref:t,className:(0,a.cn)("flex cursor-default items-center justify-center py-1",s),...r,children:(0,n.jsx)(l.v4q,{className:"w-4 h-4"})})});u.displayName=d.$G.displayName,c.forwardRef((e,t)=>{let{className:s,children:r,position:o="popper",...i}=e;return(0,n.jsx)(d.h_,{children:(0,n.jsxs)(d.VY,{ref:t,className:(0,a.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-xl border border-input-border bg-popover text-popover-foreground shadow-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===o&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:o,...i,children:[(0,n.jsx)(m,{}),(0,n.jsx)(d.l_,{className:(0,a.cn)("p-1","popper"===o&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),(0,n.jsx)(u,{})]})})}).displayName=d.VY.displayName,c.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,n.jsx)(d.__,{ref:t,className:(0,a.cn)("px-2 py-1.5 text-sm font-semibold",s),...r})}).displayName=d.__.displayName,c.forwardRef((e,t)=>{let{className:s,children:r,...o}=e;return(0,n.jsxs)(d.ck,{ref:t,className:(0,a.cn)("relative flex w-full cursor-pointer select-none items-center rounded-lg py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-card-hover focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...o,children:[(0,n.jsx)("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,n.jsx)(d.wU,{children:(0,n.jsx)(l.nQG,{className:"w-4 h-4"})})}),(0,n.jsx)(d.eT,{children:r})]})}).displayName=d.ck.displayName,c.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,n.jsx)(d.Z0,{ref:t,className:(0,a.cn)("-mx-1 my-1 h-px bg-muted",s),...r})}).displayName=d.Z0.displayName;var p=s(74239),h=s(30722),g=s.n(h),f=s(80893),I=s(77119),v=s(43701),y=s(70702),w=s(11194),S=s(85035),R=s(41811);g().range(1900,new Date().getFullYear()).map(e=>e.toString()).reverse();let b=(0,w.U)()((0,S.tJ)(e=>({stage:"start",setStage:t=>e({stage:t})}),{name:"age-verif"}));function x(e){let{onPass:t}=e,{t:s}=(0,y.$G)("base"),{stage:l,setStage:d}=b(),{routeToConversation:m}=(0,I.o)(),{client:u}=(0,p.useStatsigClient)(),h=(0,c.useCallback)(()=>{u.logEvent("clicked_signin",void 0,{location:"age-verification"})},[u]),g=(0,c.useCallback)(()=>{d("pass"),null==t||t(),u.logEvent("selected_over_18","pass",{location:"over-18-verification"})},[t,u]),w=(0,c.useCallback)(()=>{d("nopass"),u.logEvent("selected_over_18","nopass",{location:"over-18-verification"})},[u]),S=(0,c.useCallback)(()=>{let{setShowAgeVerification:e}=v.F.getState();e(!1),m(void 0)},[]);return(0,n.jsxs)(i.c,{open:"pass"!==l,contentClassName:(0,a.cn)("focus:outline-0 focus-within:outline-0 gap-2","bg-background rounded-3xl","w-full md:w-5/6 lg:w-3/5 max-w-sm","flex flex-col","md:overflow-hidden","px-6 py-6"),blurBackground:!0,children:["start"===l&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(o.fK,{className:"mb-4",children:[(0,n.jsx)(o.$N,{className:"mb-1",children:s("Please confirm your age","Please confirm your age")}),(0,n.jsx)(o.Be,{children:s("Please confirm your age.description","In order to continue using Grok we need to confirm your age.")})]}),(0,n.jsxs)("div",{className:"flex items-center justify-center gap-4 p-1",children:[(0,n.jsx)(r.zx,{className:"w-full",variant:"secondary",onClick:w,tabIndex:-1,children:s("I am not over 18","I am not over 18")}),(0,n.jsx)(r.zx,{className:"w-full",variant:"primary",onClick:g,children:s("I am 18 or older","I am 18 or older")})]}),(0,n.jsxs)("div",{className:"relative flex items-center justify-center w-full",children:[(0,n.jsx)(R.Z,{className:"absolute -translate-x-1/2 -translate-y-1/2 top-1/2 left-1/2"}),(0,n.jsx)("p",{className:"relative px-2 py-1 mx-auto text-xs bg-background text-secondary",children:s("Or","Or")})]}),(0,n.jsx)(r.zx,{asChild:!0,variant:"secondary",size:"lg",onClick:h,children:(0,n.jsx)(f.default,{href:"sign-in",children:s("Sign in or create an account","Sign in or create an account")})})]}),"nopass"===l&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(o.fK,{children:[(0,n.jsx)(o.$N,{children:s("Restricted","Restricted")}),(0,n.jsx)(o.Be,{className:"",children:(0,n.jsx)("div",{children:s("Restricted.description","Based on the information you provided you cannot use Grok image generation or 18+ personas.")})})]}),(0,n.jsx)(r.zx,{className:"w-full mt-2",variant:"primary",size:"lg",onClick:S,children:s("Start a new chat","Start a new chat")})]})]})}},40955:function(e,t,s){s.d(t,{$N:function(){return h},Be:function(){return g},PK:function(){return d},Vq:function(){return a},cN:function(){return p},cZ:function(){return m},fK:function(){return u},hg:function(){return l},t9:function(){return c}});var n=s(2899),r=s(72242),o=s(6936),i=s(4694);let a=o.fC,l=o.xz,d=o.h_;o.x8;let c=i.forwardRef((e,t)=>{let{className:s,...i}=e;return(0,n.jsx)(o.aV,{ref:t,className:(0,r.cn)("fixed inset-0 z-50 bg-overlay backdrop-blur-[2px] duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...i})});c.displayName=o.aV.displayName;let m=i.forwardRef((e,t)=>{let{className:s,overlayClassname:i,children:a,...l}=e;return(0,n.jsxs)(d,{children:[(0,n.jsx)(c,{className:i}),(0,n.jsx)(o.VY,{ref:t,className:(0,r.cn)("fixed left-[50%] top-[50%] z-50 grid translate-x-[-50%] translate-y-[-50%] gap-4 bg-background duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%]",s),onCloseAutoFocus:e=>{e.preventDefault(),document.body.style.pointerEvents=""},...l,children:a})]})});m.displayName=o.VY.displayName;let u=e=>{let{className:t,...s}=e;return(0,n.jsx)("div",{className:(0,r.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...s})};u.displayName="DialogHeader";let p=e=>{let{className:t,...s}=e;return(0,n.jsx)("div",{className:(0,r.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...s})};p.displayName="DialogFooter";let h=i.forwardRef((e,t)=>{let{className:s,...i}=e;return(0,n.jsx)(o.Dx,{ref:t,className:(0,r.cn)("text-lg font-medium leading-none tracking-tight",s),...i})});h.displayName=o.Dx.displayName;let g=i.forwardRef((e,t)=>{let{className:s,...i}=e;return(0,n.jsx)(o.dk,{ref:t,className:(0,r.cn)("text-sm text-muted-foreground",s),...i})});g.displayName=o.dk.displayName},48972:function(e,t,s){s.d(t,{OX:function(){return u},Qz:function(){return l},dy:function(){return a},iI:function(){return h},sc:function(){return m},u6:function(){return g},ze:function(){return p}});var n=s(2899),r=s(4694),o=s(51548),i=s(72242);let a=e=>{let{shouldScaleBackground:t=!0,...s}=e;return(0,n.jsx)(o.d.Root,{shouldScaleBackground:t,...s})};a.displayName="Drawer";let l=o.d.Trigger,d=o.d.Portal;o.d.Close;let c=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,n.jsx)(o.d.Overlay,{ref:t,className:(0,i.cn)("fixed inset-0 z-50 bg-black/20 dark:bg-black/80",s),...r})});c.displayName=o.d.Overlay.displayName;let m=r.forwardRef((e,t)=>{let{className:s,overlayClassName:r,disableDrag:a,children:l,...m}=e;return(0,n.jsxs)(d,{children:[(0,n.jsx)(c,{className:r}),(0,n.jsxs)(o.d.Content,{ref:t,className:(0,i.cn)("fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[24px] bg-background-secondary",s),onCloseAutoFocus:e=>{e.preventDefault(),document.body.style.pointerEvents=""},...m,children:[a?null:(0,n.jsx)("div",{className:"flex-shrink-0 w-12 h-1 mx-auto mt-3 mb-0 rounded-full bg-secondary/80"}),l]})]})});m.displayName="DrawerContent";let u=e=>{let{className:t,...s}=e;return(0,n.jsx)("div",{className:(0,i.cn)("grid gap-1.5 p-4 text-center sm:text-left",t),...s})};u.displayName="DrawerHeader";let p=e=>{let{className:t,...s}=e;return(0,n.jsx)("div",{className:(0,i.cn)("mt-auto flex flex-col gap-2 p-4",t),...s})};p.displayName="DrawerFooter";let h=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,n.jsx)(o.d.Title,{ref:t,className:(0,i.cn)("text-lg font-semibold leading-none tracking-tight",s),...r})});h.displayName=o.d.Title.displayName;let g=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,n.jsx)(o.d.Description,{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",s),...r})});g.displayName=o.d.Description.displayName},42210:function(e,t,s){s.d(t,{c:function(){return l}});var n=s(2899);s(4694);var r=s(40955),o=s(48972),i=s(8781),a=s(72242);function l(e){let{open:t,setOpen:s,trigger:l,title:d,description:c,footer:m,children:u,contentClassName:p,blurBackground:h}=e;return!(0,i.w)()&&t?(0,n.jsxs)(r.Vq,{open:t,onOpenChange:s,children:[l&&(0,n.jsx)(r.hg,{asChild:!0,children:l}),(0,n.jsxs)(r.cZ,{className:(0,a.cn)("focus:outline-none rounded-none",p),overlayClassname:(0,a.cn)(h&&"backdrop-blur-lg"),"aria-describedby":void 0,children:[(d||c)&&(0,n.jsxs)(r.fK,{children:[null!=d?d:(0,n.jsx)(r.$N,{children:d}),null!=c?c:(0,n.jsx)(r.Be,{children:c})]}),u]})]}):(0,n.jsxs)(o.dy,{open:t,onOpenChange:s,dismissible:!!s,children:[l&&(0,n.jsx)(o.Qz,{asChild:!0,children:l}),(0,n.jsxs)(o.sc,{className:(0,a.cn)("focus:outline-none",p,"max-w-none !rounded-b-none"),overlayClassName:(0,a.cn)(h&&"backdrop-blur-lg"),"aria-describedby":void 0,children:[(d||c)&&(0,n.jsxs)(o.OX,{className:"p-0 text-left",children:[null!=d?d:(0,n.jsx)(o.iI,{children:d}),null!=c?c:(0,n.jsx)(o.u6,{children:c})]}),u,m&&(0,n.jsx)(o.ze,{className:"pt-2",children:m})]})]})}},84503:function(e,t,s){s.d(t,{UH:function(){return o},d7:function(){return i},fr:function(){return n},jd:function(){return r}});let n="grok-3",r="Grok 3",o="Grok 3",i="Grok 2"},77119:function(e,t,s){s.d(t,{o:function(){return d}});var n=s(69492),r=s(14075),o=s(91218),i=s(4694);let a=[new o.y("/chat/:chatId"),new o.y("/chat"),new o.y("/")],l=new o.y("/share/:shareLinkId");function d(){let e=(0,r.useRouter)(),t=(0,r.usePathname)(),s=(0,i.useMemo)(()=>!!t&&a.some(e=>e.test(t)),[t]),o=(0,i.useMemo)(()=>!!t&&l.test(t),[t]),d=(0,i.useMemo)(()=>{if(o){var e;return{shareLinkId:null===(e=l.test(t))||void 0===e?void 0:e.shareLinkId}}},[o,t]);return{isChatPage:s,isSharePage:o,pageData:d,routeToConversation:(0,i.useCallback)((t,r)=>{!function(e){let t=n.gK.getState();t.setConversationId(e),t.setSidePanelContent(void 0)}(t),r||(t?s||e.push("/chat/".concat(t)):e.push("/"))},[e,t]),signInWithReturnTo:(0,i.useCallback)((s,n)=>{let r=new URLSearchParams({q:s||"",reasoningMode:n||"none"}).toString(),o=r?"".concat(t,"?").concat(r):t,i=o?new URLSearchParams({return_to:o}).toString():void 0;e.push("/sign-in".concat(i?"?".concat(i):""))},[e,t])}}},8781:function(e,t,s){s.d(t,{G:function(){return r},w:function(){return o}});var n=s(4694);let r=768;function o(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r,[t,s]=n.useState(void 0);return n.useEffect(()=>{let t=window.matchMedia("(max-width: ".concat(e-1,"px)")),n=()=>{s(window.innerWidth<e)};return t.addEventListener("change",n),s(window.innerWidth<e),()=>t.removeEventListener("change",n)},[e]),!!t}},89463:function(e,t,s){s.d(t,{T:function(){return o},r:function(){return r}});var n=s(4694);function r(){let[e,t]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{let e=()=>{let e=navigator.userAgent||navigator.vendor;t(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Mobile|mobile|CriOS/i.test(e))};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[]),e}function o(){let e=navigator.userAgent||navigator.vendor;return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Mobile|mobile|CriOS/i.test(e)}},4077:function(e,t,s){s.d(t,{Md:function(){return f},NK:function(){return I},bP:function(){return v}});var n=s(69492),r=s(84503),o=s(54596);let i=o.z.object({modelId:o.z.string(),name:o.z.string().optional(),description:o.z.string().optional(),tags:o.z.array(o.z.string()).optional(),badgeText:o.z.string().optional()});o.z.object({models:o.z.array(i).optional().default([]),defaultFreeModel:o.z.string().optional(),defaultProModel:o.z.string().optional(),unavailableModels:o.z.array(i).optional().default([]),defaultAnonModel:o.z.string().optional()});let a=e=>["get-models",e];var l=s(46913),d=s(41307),c=s(67206),m=s(87325),u=s(56672),p=s(90047),h=s(4694),g=s(81211);function f(){let e=(0,g.g)();return(0,h.useMemo)(()=>e.FORCE_SIGN_IN_MODELS.value.forceSignInModels&&Array.isArray(e.FORCE_SIGN_IN_MODELS.value.forceSignInModels)?e.FORCE_SIGN_IN_MODELS.value.forceSignInModels:[],[e.FORCE_SIGN_IN_MODELS.value])}function I(e){var t,s;let r=(0,g.g)(),o=(0,d.O)(u.Z("listByConversationId")),i=(0,d.O)(u.Z("attachListByConversationId")),a=(0,n.gK)(u.Z("conversationId"))||"no_conversation_id",l=(0,n.gK)(u.Z("reasoningMode")),c="deepsearch"==l||"deepersearch"==l,m="think"==l,p=o[a],f=i[a],I=((null==p?void 0:p.length)||0)+((null==f?void 0:f.length)||0),v=(null==e?void 0:null===(t=e.tags)||void 0===t?void 0:t.includes("no_attachments_for_think"))||r.DISABLE_ATTACHMENTS_FOR_THINK,y=(null==e?void 0:null===(s=e.tags)||void 0===s?void 0:s.includes("no_attachments_for_deepsearch"))||r.DISABLE_ATTACHMENTS_FOR_DEEPSEARCH,w=!!I&&v,S=!!I&&y;return{isAttachDisabled:(0,h.useMemo)(()=>!!v&&!!m||!!y&&!!c,[c,m,v,y]),isThinkDisabled:w,isDeepsearchDisabled:S,isThinkSelected:m,isDeepsearchSelected:c}}function v(){var e,t,s,n;let o=m.ZP.language,d=(0,g.g)(),{data:f,isPending:I}=(0,c.aM)({queryKey:a(o),queryFn:async()=>{var e;return{models:((e=await l.aI.modelsGetModels({body:{locale:o}})).models||[]).map(e=>i.safeParse(e)).filter(e=>e.success).map(e=>e.data).sort((e,t)=>e.name===r.UH?-1:t.name===r.UH||e.name===r.d7?1:t.name===r.d7?-1:0),unavailableModels:(e.unavailableModels||[]).map(e=>i.safeParse(e)).filter(e=>e.success).map(e=>e.data),defaultAnonModelId:e.defaultAnonModel,defaultFreeModelId:e.defaultFreeModel,defaultProModelId:e.defaultProModel}},staleTime:3e5}),v=(0,h.useMemo)(()=>f?!d.SHOW_GROK_2&&f.models.map(e=>e.name).includes(r.UH)?f.models.filter(e=>e.name!==r.d7):f.models:[],[f,d.SHOW_GROK_2]),y=(0,h.useMemo)(()=>v?p.Z(u.Z("modelId"),v):{},[v]);return{models:v,unavailableModels:null!==(e=null==f?void 0:f.unavailableModels)&&void 0!==e?e:[],defaultAnonModelId:null!==(t=null==f?void 0:f.defaultAnonModelId)&&void 0!==t?t:r.fr,defaultFreeModelId:null!==(s=null==f?void 0:f.defaultFreeModelId)&&void 0!==s?s:r.fr,defaultProModelId:null!==(n=null==f?void 0:f.defaultProModelId)&&void 0!==n?n:r.fr,modelById:y,isPending:I}}},33263:function(e,t,s){s.d(t,{BV:function(){return b},HG:function(){return w},Mh:function(){return C},VO:function(){return x}});var n=s(40202),r=s(30722),o=s.n(r),i=s(4694),a=s(70702),l=s(54596);let d=l.z.union([l.z.literal("imageGen"),l.z.literal("search"),l.z.literal("think"),l.z.literal("deepsearch")]),c=l.z.object({personaId:l.z.literal("news"),name:l.z.string(),systemPromptName:l.z.literal("grok3_personality_latest_news"),disclaimer:l.z.string().optional(),disabledTools:d.array()}),m=l.z.object({personaId:l.z.literal("doctor"),name:l.z.string(),systemPromptName:l.z.literal("grok3_personality_medical_advisor"),disclaimer:l.z.string().optional(),disabledTools:d.array()}),u=l.z.object({personaId:l.z.literal("friend"),name:l.z.string(),systemPromptName:l.z.literal("grok3_personality_loyal_friend"),disclaimer:l.z.string().optional(),disabledTools:d.array()}),p=l.z.object({personaId:l.z.literal("tutor"),name:l.z.string(),systemPromptName:l.z.literal("grok3_personality_homework_helper"),disclaimer:l.z.string().optional(),disabledTools:d.array()}),h=l.z.object({personaId:l.z.literal("romance"),name:l.z.string(),systemPromptName:l.z.literal("grok3_personality_romance_me"),disclaimer:l.z.string().optional(),disabledTools:d.array()}),g=l.z.object({personaId:l.z.literal("unhinged"),name:l.z.string(),systemPromptName:l.z.literal("grok3_personality_unhinged_comedian"),disclaimer:l.z.string().optional(),disabledTools:d.array()}),f=l.z.object({personaId:l.z.literal("therapist"),name:l.z.string(),systemPromptName:l.z.literal("grok3_personality_trusted_therapist"),disclaimer:l.z.string().optional(),disabledTools:d.array()}),I=l.z.object({personaId:l.z.literal("scientist"),name:l.z.string(),systemPromptName:l.z.literal("grok3_personality_science_geek"),disclaimer:l.z.string().optional(),disabledTools:d.array()}),v=l.z.object({personaId:l.z.literal("coder"),name:l.z.string(),systemPromptName:l.z.literal("grok3_personality_cracked_coder"),disclaimer:l.z.string().optional(),disabledTools:d.array()}),y=l.z.union([c,m,h,g,u,p,f,I,v]);function w(){let{stage:e}=(0,n.Bn)(),{t}=(0,a.$G)("base"),s=(0,i.useMemo)(()=>({news:t("persona-name.news","Latest News"),romance:t("persona-name.romance","Companion"),unhinged:t("persona-name.unhinged","Unhinged Comedian"),friend:t("persona-name.friend","Loyal Friend"),tutor:t("persona-name.tutor","Homework Helper"),doctor:t("persona-name.doctor","Not a Doctor"),therapist:t("persona-name.therapist","Not a Therapist"),scientist:t("persona-name.scientist","Scientist"),coder:t("persona-name.coder","Coder")}),[t]),r=(0,i.useMemo)(()=>S.map(e=>({personaId:e,name:s[e],systemPromptName:R[e],disabledTools:[]})).filter(t=>!C.includes(t.personaId)||"nopass"!==e).map(e=>y.safeParse(e)).filter(e=>e.success).map(e=>e.data),[e,s]),l=(0,i.useMemo)(()=>o().keyBy(r,e=>e.personaId),[r]),d=(0,i.useCallback)(e=>{if(!e||!e.personaId||!S.includes(e.personaId))return;let t=l[e.personaId];if(t)return t},[l]);return{personas:r,personaById:l,getPersonaForConversation:d}}let S=["news","romance","unhinged","friend","tutor","doctor","therapist"],R={doctor:"grok3_personality_medical_advisor",news:"grok3_personality_latest_news",friend:"grok3_personality_loyal_friend",tutor:"grok3_personality_homework_helper",romance:"grok3_personality_romance_me",unhinged:"grok3_personality_unhinged_comedian",therapist:"grok3_personality_trusted_therapist",scientist:"grok3_personality_science_geek",coder:"grok3_personality_cracked_coder"};function b(e){if(!e)return;let t=o().invert(R)[e];if(x(t))return t}function x(e){return!!e&&S.includes(e)}let C=["romance","unhinged"]},39589:function(e,t,s){s.d(t,{DT:function(){return r},TP:function(){return o},j4:function(){return a},w0:function(){return i}});var n=s(54596);let r=n.z.union([n.z.literal("none"),n.z.literal("unknown"),n.z.literal("deepsearch"),n.z.literal("deepersearch"),n.z.literal("think")]);function o(e){return"deepersearch"===e?"deeper":"deepsearch"===e?"default":void 0}function i(e){let{isReasoning:t,deepsearchPreset:s}=e;return t?"think":"deeper"===s?"deepersearch":"default"===s?"deepsearch":s?"unknown":"none"}function a(e){return"deepersearch"===e?"DEEPERSEARCH":"deepsearch"===e?"DEEPSEARCH":"think"===e?"REASONING":"DEFAULT"}},20592:function(e,t,s){s.d(t,{$P:function(){return c},Bv:function(){return l},YM:function(){return a},aM:function(){return i},io:function(){return function e(t,s){let n=t[s];if(!n)return s;let r=n[n.length-1];return r&&r.responseId?e(t,r.responseId):s}},xt:function(){return d}});var n=s(30722),r=s.n(n),o=s(74542);function i(e,t,s){let n=r().keyBy(t,"responseId"),o=n[e];if(!o)return[];let i=[o],a=o.parentResponseId;for(;a&&(!s||i.length<s);){let e=n[a];if(!e)break;i.push(e),a=e.parentResponseId}return i}function a(e,t){let s;for(let n of e)if(t.find(e=>e.responseId===n.responseId))s=n;else break;return s}function l(e,t){let s=[],n=e,r=new Set;for(;n;){if(r.has(n.responseId||"")){(0,o.H)("conversation-utils:getAncestorIds","Cycle detected in response hierarchy: ".concat(n.responseId));break}r.add(n.responseId||""),s.unshift(n.responseId||"");let e=n.parentResponseId;if(!e)break;n=t[e]}return s}function d(e){let t=new Set(e.map(e=>e.parentResponseId)),s=e.filter(e=>!t.has(e.responseId));if(0!==s.length)return r().maxBy(s,e=>e.createTime)}function c(e,t,s){if(!s)return!1;for(let n of i(s,t))if(n.responseId&&!e.some(e=>e.responseId===n.responseId))return!0;return!1}},3453:function(e,t,s){s.d(t,{DC:function(){return a},MA:function(){return i},xo:function(){return l}});var n=s(47500),r=s(67206),o=s(75361);function i(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return!!e.match(/^\d+\s[A-Z_]+:\s([\s\S]+)/)}let a=(e,t)=>t&&Object.entries(t).map(e=>{let[t,s]=e;return"".concat(s.join(", "))}).join("\n")||(e?"".concat(e,"\n"):"");function l(e){!function(e,t){if(e instanceof n.VLC){e.response.json().then(e=>{e.message&&e.message.length>0&&!i(e.message)&&(e.message="2 UNKNOWN: ".concat(e.message));let{message:s,details:n}=(0,r.e$)(e);null==t||t(s,n)}).catch(()=>{null==t||t("Something went wrong")});return}let{message:s}=(0,r.e$)(e);null==t||t(s)}(e,(e,t)=>{o.Am.error(a(e,t))})}},6123:function(e,t,s){s.d(t,{Mt:function(){return a},o7:function(){return l},x0:function(){return d}});var n=s(47500),r=s(67206),o=s(3453);class i extends Error{static async fromResponse(e){let t;let s=e.headers.get("Content-Type");if(s&&s.includes("application/json"))try{var n;let s=await e.json(),r=null!==(n=s.error)&&void 0!==n?n:s;"object"==typeof r&&null!==r&&"code"in r&&"number"==typeof r.code&&"message"in r&&"string"==typeof r.message&&"details"in r&&Array.isArray(r.details)&&(t=r)}catch(e){}if(!t)throw Error("Unable to parse RequestError response body as JSON");return new i(e,t)}constructor(e,t){let s={...t};s.message.length>0&&!(0,o.MA)(s.message)&&(s.message="2 UNKNOWN: ".concat(s.message));let n=(0,r.e$)(s);super((0,o.DC)(n.message,n.details)||"Request failed with status ".concat(e.status,": ").concat(e.statusText)),this.response=e,this.name="DetailedResponseError",this.status=e.status,this.statusText=e.statusText,this.url=e.url,this.grpcError=s,this.errorMessage=n}}function a(e){return e instanceof n.VLC?i.fromResponse(e.response).catch(()=>e):Promise.resolve(e)}function l(e){return e instanceof n.VLC&&e.response.status>=500||e instanceof i&&e.status>=500}function d(e){return e instanceof n.VLC?e.response.status:e instanceof i?e.status:void 0}},29598:function(e,t,s){s.d(t,{H:function(){return g},IH:function(){return m},Kn:function(){return v},MT:function(){return R},N7:function(){return w},Nh:function(){return I},Od:function(){return h},Qd:function(){return f},R3:function(){return y},ZN:function(){return p},f0:function(){return c},o0:function(){return u},tM:function(){return S}});var n=s(15280),r=s(90047),o=s(56672),i=s(74036),a=s(98118),l=s(11194),d=s(85035);function c(e,t){return s=>{e(e=>({...e,[t]:s}))}}function m(e,t){return s=>{e(e=>({...e,[t]:[...e[t]||[],s]}))}}function u(e,t,s){return()=>{e(e=>({...e,[t]:s}))}}function p(e,t){return()=>{e(e=>({...e,[t]:!e[t]}))}}function h(e,t){return s=>{e(e=>({...e,[t]:n.Z([s],e[t])}))}}function g(e,t,s){return n=>{e(e=>({...e,[t]:{...e[t],...r.Z(o.Z(s),[n])}}))}}function f(e,t){return(s,n)=>{e(e=>({...e,[t]:{...e[t],[n]:s}}))}}function I(e,t){return(s,n)=>{e(e=>({...e,[t]:{...e[t],[n]:[...e[t][n]||[],s]}}))}}function v(e,t,s){return(n,r)=>{let o=!1;return e(e=>{var i;return{...e,[t]:{...e[t],[n]:null===(i=e[t][n])||void 0===i?void 0:i.filter(e=>{let t=e[s]!==r;return t||(o=!0),t})}}}),o}}function y(e,t,s){return n=>{e(e=>({...e,[t]:{...e[t],...r.Z(o.Z(s),n)}}))}}function w(e,t,s,n){let{subscribe:r,setState:l}=e;return r(o.Z(t),(e,t)=>{l(i.Z(a.Z(s),n(e,t)))},{fireImmediately:!0})}function S(e,t,s,n,r){let{subscribe:l,setState:d}=e;try{let e=localStorage.getItem(s);if(null!=e){let s=JSON.parse(e);if(r){let e=r(s);d(i.Z(a.Z(t),e))}else d(i.Z(a.Z(t),s))}}catch(e){localStorage.setItem(s,JSON.stringify(n))}l(o.Z(t),e=>{localStorage.setItem(s,JSON.stringify(e))})}function R(e){return(0,l.U)()((0,d.XR)((t,s)=>new e(t,s)))}},13771:function(e,t,s){s.d(t,{P:function(){return f},t:function(){return g}});var n=s(33263),r=s(29598),o=s(46913),i=s(14106),a=s(74036),l=s(84524),d=s(73197);let c={},m={},u=[],p={};class h{constructor(e,t){this.set=e,this.get=t,this.promiseById=c,this.byId=m,this.list=u,this.abortControllerById=p,this.upsertConversation=(0,r.H)(this.set,"byId","conversationId"),this.appendConversations=(0,r.R3)(this.set,"byId","conversationId"),this.removeConversation=(0,r.Od)(this.set,"byId"),this.setById=(0,r.f0)(this.set,"byId"),this.idsertConversationPromise=(0,r.Qd)(this.set,"promiseById"),this.removeConversationPromise=(0,r.Od)(this.set,"promiseById"),this.setPromiseById=(0,r.f0)(this.set,"promiseById"),this.idsertAbortControllerById=(0,r.Qd)(this.set,"abortControllerById"),this.removeAbortControllerById=(0,r.Od)(this.set,"abortControllerById"),this.upsertAndCacheConversation=e=>{this.upsertConversation(e),this.idsertConversationPromise(Promise.resolve(e),e.conversationId)},this.fetchCreateConversation=e=>{var t;let s=this.get(),r=d.CI.getState(),i=o.xU.chatCreateConversation({body:e}).then(e=>({...e,personaId:(0,n.BV)(e.systemPromptName),isNew:!0,state:"closed"})),a=null===(t=e.addResponseRequest)||void 0===t?void 0:t.conversationId;return a&&(s.idsertConversationPromise(i,a),r.nodesByConversationId[a]=[]),i.then(e=>{s.upsertConversation(e),s.idsertConversationPromise(i,e.conversationId),r.nodesByConversationId[e.conversationId]=[]}).catch(console.error),i},this.fetchUpdateConversation=(e,t)=>{let s=this.get(),n=o.xU.chatUpdateConversation({conversationId:e,body:t}).then(e=>({...s.byId[e.conversationId]||{isNew:!1,state:"closed"},...e})).then(i.Z(s.upsertConversation));return s.idsertConversationPromise(n,e),n.catch(console.error),n},this.fetchDeleteConversation=e=>{let t=this.get(),s=o.xU.chatDeleteConversation({conversationId:e});return t.removeConversation(e),t.removeConversationPromise(e),s},this.fetchSoftDeleteConversation=e=>{let t=this.get(),s=o.xU.chatSoftDeleteConversation({conversationId:e});return t.removeConversation(e),t.removeConversationPromise(e),s},this.fetchGetConversation=e=>{let t=this.get();if(e in t.promiseById)return t.promiseById[e];let s=o.xU.chatGetConversation({conversationId:e,includeWorkspaces:!0}).then(e=>({...e,personaId:(0,n.BV)(e.systemPromptName),isNew:!1,state:"closed"}));return t.set(a.Z(l.Z(["promiseById",e]),s)),s.then(t.upsertConversation).catch(console.error),s},this.fetchGetManyConversations=e=>{let t=this.get(),s={},r=[];if(e.forEach(e=>{e in t.promiseById?s[e]=t.promiseById[e]:r.push(e)}),0===r.length)return Promise.all(Object.values(s));let i=r.length>0?o.xU.chatGetConversations({conversationIds:r,includeWorkspaces:!0}).then(e=>{let{conversations:t}=e;return null==t?void 0:t.map(e=>({...e,personaId:(0,n.BV)(e.systemPromptName),isNew:!1,state:"closed"}))}):Promise.resolve([]);return i.then(e=>{e.forEach(e=>{let s=Promise.resolve(e);t.idsertConversationPromise(s,e.conversationId)}),t.appendConversations(e)}).catch(console.error),Promise.all([...Object.values(s),i.then(e=>e||[])]).then(e=>e.flat())},this.fetchSoftDeleteAllConversations=()=>(this.setById({}),this.setPromiseById({}),o.xU.chatSoftDeleteAllConversations())}}let g=(0,r.MT)(h);function f(e){let t=new Date().toISOString();return{title:"",createTime:t,modifyTime:t,starred:!1,temporary:!1,isNew:!0,state:"optimistic",mediaTypes:[],workspaces:[],...e}}(0,r.N7)(g,"byId","list",Object.values)},41307:function(e,t,s){s.d(t,{O:function(){return g}});var n=s(3453),r=s(74542),o=s(6123),i=s(29598),a=s(46913),l=s(75361),d=s(98437).lW;let c={},m={},u={},p={};class h{constructor(e,t){this.set=e,this.get=t,this.listByConversationId=c,this.fileMetaPromiseById=m,this.fileMetaById=u,this.attachListByConversationId=p,this.lisertByConversationId=(0,i.Nh)(this.set,"listByConversationId"),this.removeByConversationId=(0,i.Od)(this.set,"listByConversationId"),this.delistByConversationId=(0,i.Kn)(this.set,"listByConversationId","file"),this.upsertFileMetadata=(0,i.H)(this.set,"fileMetaById","fileMetadataId"),this.idsertFileMetadataPromise=(0,i.Qd)(this.set,"fileMetaPromiseById"),this.lisertAttachByConversationId=(0,i.Nh)(this.set,"attachListByConversationId"),this.removeAttachByConversationId=(0,i.Od)(this.set,"attachListByConversationId"),this.delistAttachByConversationId=(0,i.Kn)(this.set,"attachListByConversationId","assetId"),this.fetchUploadFile=(e,t)=>{let s=this.get(),n=e.arrayBuffer().then(t=>a.xU.chatUploadFile({body:{fileName:e.name,fileMimeType:e.type,content:d.from(t).toString("base64")}}).then(e=>e).catch(async e=>{let t=await (0,o.Mt)(e);if(t.message.includes("OUT_OF_RANGE"))throw Error("File was too large.");throw t})),i={file:e,metadataPromise:n};return s.lisertByConversationId(i,t),n.then(n=>{s.delistByConversationId(t,e)&&s.lisertByConversationId({...i,metadata:n},t)}).catch(n=>{s.delistByConversationId(t,e)&&(s.lisertByConversationId({...i,metadata:n},t),(0,r.H)("fetchUploadFile",n))}),i},this.fetchFileMetadata=e=>{let t=this.get();if(e in t.fileMetaById)return Promise.resolve(t.fileMetaById[e]);if(e in t.fileMetaPromiseById)return t.fileMetaPromiseById[e];let s=a.xU.chatGetFileMetadata({fileMetadataId:e}).then(e=>e);return t.idsertFileMetadataPromise(s,e),s.then(t.upsertFileMetadata).catch(n.xo),s},this.fetchAttachThirdPartyFile=(e,t,s,n,i)=>{let d=this.get(),c=a.xU.chatUploadFile({body:{fileName:e,fileMimeType:t,fileSource:s,thirdPartyFileId:n}}).then(e=>e).catch(async e=>{let t=await (0,o.Mt)(e);if(t.message.includes("OUT_OF_RANGE"))throw Error("File was too large.");throw t}),m=new File([n],e),u={file:m,metadataPromise:c};return d.lisertByConversationId(u,i),c.then(e=>{d.delistByConversationId(i,m)&&d.lisertByConversationId({...u,metadata:e},i)}).catch(e=>{d.delistByConversationId(i,m)&&(d.lisertByConversationId({...u,metadata:e},i),(0,r.H)("fetchAttachThirdPartyFile",e)),e.message&&l.Am.error(e.message)}),u}}}let g=(0,i.MT)(h)},68192:function(e,t,s){s.d(t,{p:function(){return o}});var n=s(29598);class r{constructor(e,t){this.set=e,this.get=t,this.models=[],this.unavailableModels=[],this.defaultAnonModelId="",this.defaultFreeModelId="",this.defaultProModelId="",this.modelById={},this.isPending=!1}}let o=(0,n.MT)(r)},64846:function(e,t,s){s.d(t,{DL:function(){return c},X5:function(){return d},Zv:function(){return h},xn:function(){return g}});var n=s(29598),r=s(30722),o=s.n(r),i=s(54596),a=s(46913);let l="custom_personality_id",d={personalityId:l,name:"Custom",prompt:"",description:"Responds to you as you please.",isPreset:!1};function c(e){return!!e&&(e===l||36===e.length)}function m(e){return{name:e.name,content:[{text:e.prompt}]}}function u(e){var t,s;return{personalityId:e.systemPromptId||"",name:e.name||d.name,prompt:(null===(s=e.content)||void 0===s?void 0:null===(t=s[0])||void 0===t?void 0:t.text)||"",description:d.description,isPreset:!1}}class p{constructor(e,t){this.set=e,this.get=t,this.promiseById={},this.byId={},this.list=[],this.draftPromptById={},this.upsertPersonality=(0,n.H)(this.set,"byId","personalityId"),this.appendPersonalities=(0,n.R3)(this.set,"byId","personalityId"),this.removePersonality=(0,n.Od)(this.set,"byId"),this.idsertPersonalityPromise=(0,n.Qd)(this.set,"promiseById"),this.removePersonalityPromise=(0,n.Od)(this.set,"promiseById"),this.upsertDraftPrompt=(0,n.Qd)(this.set,"draftPromptById"),this.fetchCreatePersonality=e=>{let t=this.get(),s=a.XR.systemPromptRepositoryCreateSystemPrompt({body:m(e)}).then(e=>{let t=u(e);return t.description=d.description,t}).then(e=>(t.upsertPersonality(e),t.idsertPersonalityPromise(s,e.personalityId),e));return s},this.fetchUpdatePersonality=e=>{let t=this.get(),s=a.XR.systemPromptRepositoryUpdateSystemPrompt({systemPromptId:e.personalityId,body:m(e)}).then(e=>u(e)).then(e=>(t.upsertPersonality(e),e));return t.idsertPersonalityPromise(s,e.personalityId),s},this.fetchDeletePersonality=e=>(this.get().removePersonality(e.personalityId),a.XR.systemPromptRepositoryDeleteSystemPrompt({systemPromptId:e.personalityId})),this.fetchListPersonalities=()=>{let e=this.get();return a.XR.systemPromptRepositoryListSystemPrompts({body:{pageSize:100}}).then(e=>{var t;return(null===(t=e.assets)||void 0===t?void 0:t.map(u))||[]}).then(t=>(e.appendPersonalities(t),e.set(e=>({promiseById:{...e.promiseById,...o().mapValues(o().keyBy(t,"personalityId"),e=>Promise.resolve(e))}})),t))},this.fetchGetPersonality=e=>{let t=this.get(),s=e.personalityId;if(s in t.promiseById)return t.promiseById[s];let n=a.XR.systemPromptRepositoryGetSystemPrompt({systemPromptId:s}).then(e=>u(e)).then(e=>(t.upsertPersonality(e),t.idsertPersonalityPromise(n,e.personalityId),e));return n}}}let h=(0,n.MT)(p);(0,n.N7)(h,"byId","list",Object.values);let g=i.z.object({personalityId:i.z.string(),name:i.z.string(),prompt:i.z.string(),description:i.z.string(),isPreset:i.z.boolean()});i.z.array(g)},73197:function(e,t,s){s.d(t,{_w:function(){return D},V1:function(){return W},CI:function(){return j}});var n=s(99595),r=s(89463),o=s(39589),i=s(20592),a=s(74542),l=s(6123),d=s(29598),c=s(46913),m=s(15149);async function*u(e){if(null===e.body)throw Error("Cannot process response chunks of a response without body.");let t=e.body.getReader(),s=new TextDecoder,n="";for(;;){let{done:e,value:r}=await t.read();if(e)break;let[o,i]=p(n+=s.decode(r,{stream:!0}));for(let e of o)yield e;n=i}let[r,o]=p(n);for(let e of r)yield e;o.length>0&&(yield o)}function p(e){let t=e.split("\n"),s=t.pop();return[t,s]}async function*h(e){for await(let t of u(e)){let s=JSON.parse(t);(0,m.X6)(s,e),yield s}}var g=s(67206),f=s(69845),I=s.n(f),v=s(30722),y=s.n(v),w=s(51892),S=s(54596),R=s(13771),b=s(68192),x=s(53781);let C=S.z.object({memoryReferences:S.z.array(S.z.object({conversationId:S.z.string(),summary:S.z.string()})).optional().catch(void 0),deepsearchPreset:S.z.string().optional().catch(void 0),artifactAction:S.z.enum(["ask","explain"]).optional().catch(void 0)}),_={},M={},T={},P={},E={},N={},k={},B={},A={};class z{constructor(e,t){var s=this;this.set=e,this.get=t,this.nodesPromisesByConversationId=_,this.nodesByConversationId=M,this.initialResponsesPromisesByConversationId=T,this.loadMoreResponsesPromisesByConversationId=P,this.previewResponsesPromisesByConversationId=E,this.byId=N,this.byConversationId=k,this.imageIdByUrl=B,this.inflightPromisesByConversationId=A,this.upsertResponse=(0,d.H)(this.set,"byId","responseId"),this.appendResponses=(0,d.R3)(this.set,"byId","responseId"),this.removeResponse=(0,d.Od)(this.set,"byId"),this.idsertInitialResponsesPromisesByConversationId=(0,d.Qd)(this.set,"initialResponsesPromisesByConversationId"),this.removeInitialResponsesPromiseByConversationId=(0,d.Od)(this.set,"initialResponsesPromisesByConversationId"),this.idsertLoadMoreResponsesPromisesByConversationId=(0,d.Qd)(this.set,"loadMoreResponsesPromisesByConversationId"),this.removeLoadMoreResponsesPromiseByConversationId=(0,d.Od)(this.set,"loadMoreResponsesPromisesByConversationId"),this.idsertPreviewResponsesPromisesByConversationId=(0,d.Qd)(this.set,"previewResponsesPromisesByConversationId"),this.removePreviewResponsesPromiseByConversationId=(0,d.Od)(this.set,"previewResponsesPromisesByConversationId"),this.setOneImageIdByUrl=(0,d.Qd)(this.set,"imageIdByUrl"),this.idsertInflightPromisesByConversationId=(0,d.Qd)(this.set,"inflightPromisesByConversationId"),this.idsertNodesByConversationId=(0,d.Qd)(this.set,"nodesByConversationId"),this.idsertNodesPromisesByConversationId=(0,d.Qd)(this.set,"nodesPromisesByConversationId"),this.removeNodesPromise=(0,d.Od)(this.set,"nodesPromisesByConversationId"),this.fetchListResponseNodes=async e=>{let t=this.get();if(t.nodesByConversationId[e])return t.nodesByConversationId[e];if(e in t.nodesPromisesByConversationId)return t.nodesPromisesByConversationId[e];let s=c.xU.chatListResponseNodes({conversationId:e}).then(e=>{let{responseNodes:t=[]}=e;return t});return t.idsertNodesPromisesByConversationId(s,e),s.then(s=>{t.idsertNodesByConversationId(s,e)}).catch(console.error).finally(()=>{t.removeNodesPromise(e)}),s},this.fetchListInflightResponses=async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=s.get();if(!t&&e in n.inflightPromisesByConversationId)return n.inflightPromisesByConversationId[e];let r=c.xU.chatListResponseNodes({conversationId:e}).then(e=>{let{inflightResponses:t=[]}=e;return t});return n.idsertInflightPromisesByConversationId(r,e),r.then(n.appendResponses).catch(console.error),r},this.loadResponses=async(e,t)=>{let s=this.get(),n=t.filter(e=>!s.byId[e]);if(n.length){var r;let t=((null===(r=await c.xU.chatLoadResponses({conversationId:e,body:{responseIds:n}}))||void 0===r?void 0:r.responses)||[]).map(t=>{let s=C.optional().parse(t.metadata);return{...t,conversationId:e,memoryReferences:null==s?void 0:s.memoryReferences,deepsearchPreset:null==s?void 0:s.deepsearchPreset}});s.appendResponses(t)}return t.map(e=>this.get().byId[e]).sort((e,t)=>new Date(e.createTime).getTime()-new Date(t.createTime).getTime())},this.loadInitialResponses=async e=>{let t=this.get(),s=t.nodesPromisesByConversationId[e];s||(s=this.fetchListResponseNodes(e));let n=t.initialResponsesPromisesByConversationId[e];return n||(n=(async()=>{try{let n=await s;if(!n.length)return[];let r=n[n.length-1],o=(0,i.aM)(r.responseId||"",n,30).filter(e=>!!e.responseId).map(e=>e.responseId);return t.loadResponses(e,o)}catch(e){return console.error(e),[]}})().finally(()=>{t.removeInitialResponsesPromiseByConversationId(e)}),t.idsertInitialResponsesPromisesByConversationId(n,e)),n},this.loadMoreResponses=async(e,t)=>{let s=this.get(),n=s.nodesByConversationId[e];if(!n.length)return[];if(e in s.initialResponsesPromisesByConversationId)return s.initialResponsesPromisesByConversationId[e];let r=s.loadMoreResponsesPromisesByConversationId[e];return r||(r=(async()=>{try{let r=s.byConversationId[e]||[],o=(0,i.aM)(t,n),a=(0,i.YM)(o,r),l=o.findIndex(e=>e.responseId===(null==a?void 0:a.responseId)),d=o.slice(l+1,l+30+1).filter(e=>!!e.responseId).map(e=>e.responseId);return s.loadResponses(e,d)}catch(e){return console.error(e),[]}})().finally(()=>{s.removeLoadMoreResponsesPromiseByConversationId(e)}),s.idsertLoadMoreResponsesPromisesByConversationId(r,e)),r},this.loadPreviewResponses=async(e,t)=>{let s=this.get(),n=s.nodesPromisesByConversationId[e];n||(n=this.fetchListResponseNodes(e));let r=s.previewResponsesPromisesByConversationId[e];return r||(r=(async()=>{try{let r=await n,o=(0,i.aM)(r[r.length-1].responseId,r);if(!o.length)return{responses:[],hasOlderResponses:!1,hasNewerResponses:!1};let a=[];if(t&&o.some(e=>e.responseId===t)){let e=o.findIndex(e=>e.responseId===t);a=o.slice(Math.max(0,e-5),e+5+1).map(e=>e.responseId)}else a=o.slice(0,10).map(e=>e.responseId);let l=o[o.length-1],d=o[0],c=await s.loadResponses(e,a);return{responses:c,hasOlderResponses:!(null==c?void 0:c.some(e=>e.responseId===l.responseId)),hasNewerResponses:!(null==c?void 0:c.some(e=>e.responseId===d.responseId))}}catch(e){return console.error(e),{responses:[],hasOlderResponses:!1,hasNewerResponses:!1}}})().finally(()=>{s.removePreviewResponsesPromiseByConversationId(e)}),s.idsertPreviewResponsesPromisesByConversationId(r,e)),r},this.loadConversationBranch=async(e,t,s)=>{let n=this.get(),r=n.nodesByConversationId[e];if(!r.length)return[];let o=(0,i.aM)(t,r),a=o.slice(0,o.findIndex(e=>e.responseId===s)+1).filter(e=>!!e.responseId).map(e=>e.responseId);return n.loadResponses(e,a)},this.processResponseChunk=e=>{var t,s,n;let{currentStreamResponse:r,responseChunk:o,onCitations:i,onHasImage:a,onDisclaimer:l,onFollowUpSuggestedMode:d}=e,c=this.get(),{responseId:m,token:u,modelResponse:p,webSearchResults:h,xSearchResults:g,queryAction:f,cachedImageGenerationResponse:I,followUpSuggestions:v,cardAttachment:w,streamingImageGenerationResponse:S,finalMetadata:R,isThinking:b,messageTag:x,messageStepId:C,bannerMessage:_,disclaimer:M,imageAttachmentInfo:T,progressReport:P,memoryReferences:E,imageDimensions:N,followUpSuggestedMode:k}=o;if(m&&r.inflightResponseId!==m&&(r.inflightResponseId=m),f&&(("aurora"===f.type||"flux"===f.type)&&(r.hasImages=!0,a()),"x"===f.type&&(r.hasSearches=!0)),T&&T.imageAttachmentCount&&(r.imageAttachmentCount=T.imageAttachmentCount),N&&(N.height&&(r.generatedImageHeight=N.height),N.width&&(r.generatedImageWidth=N.width)),null==h?void 0:h.results){if(void 0!==C){let e=r.steps[C];e?e.webSearchResults=h.results||[]:r.steps.push({text:[],tags:[],webSearchResults:(null==h?void 0:h.results)||[],xpostIds:[],xposts:[]})}else r.steps.length>0||(r.webSearchResults=h.results||[],i())}else if(null==g?void 0:g.results){if(void 0!==C){let e=r.steps[C];e?(e.xposts=g.results||[],e.xpostIds=y().compact(e.xposts.map(e=>e.postId))):r.steps.push({text:[],tags:[],webSearchResults:[],xpostIds:y().compact(g.results.map(e=>e.postId)),xposts:g.results||[]})}else r.steps.length>0||(r.xposts=g.results||[],r.xpostIds=y().compact(r.xposts.map(e=>e.postId)),i())}if(I&&I.imageUrl&&(r.generatedImageUrls=r.generatedImageUrls.concat([I.imageUrl])),w&&w.jsonData&&(r.cardAttachmentsJson=r.cardAttachmentsJson.concat([w.jsonData])),E&&(null===(t=E.references)||void 0===t?void 0:t.length)&&(r.memoryReferences=E.references),b&&!r.thinkingStartTime&&(r.thinkingStartTime=new Date(r.createTime).getTime()),u){if(x&&"UNSET"!==x.toUpperCase()){if(r.searchingStartTime||(r.searchingStartTime=new Date(r.createTime).getTime()),"FINAL"===x.toUpperCase())r.searchingStartTime&&!r.searchingEndTime&&(r.searchingEndTime=Date.now()),r.message+=u;else if(C){let e=r.steps[C];if(e){if(e.tags.includes(x)){let t=e.tags.indexOf(x);t>=0&&(e.text[t]+=u)}else e.text.push(u),e.tags.push(x)}else r.steps.push({text:[u],tags:[x],webSearchResults:[],xpostIds:[],xposts:[]})}}else b?r.thinkingTrace+=u:r.message+=u}if(r.thinkingStartTime&&!r.thinkingEndTime&&!b&&u&&(r.thinkingEndTime=Date.now()),v&&v.suggestions&&(r.suggestions=v.suggestions),k&&(r.followUpSuggestedMode=k,d(k)),R&&(R.followUpSuggestions&&(r.suggestions=R.followUpSuggestions),R.disclaimer&&l(R.disclaimer)),S){let{imageId:e,imageUrl:t}=S;if(e&&t){let o=null!==(s=r.streamingImageById)&&void 0!==s?s:{};S.progress&&(r.streamingImageById={...o,[e]:{...null!==(n=o[e])&&void 0!==n?n:{},[S.progress]:S}}),c.setOneImageIdByUrl(e,t)}}return _&&_.message&&l(_.message),M&&M.message&&l(M.message),P&&P&&(r.progressReport=P),p&&(r={...r,...p,state:"closed"}),r},this.processSideBySide=e=>{let{responseChunk:t,toggledExperiment:s,conversationId:n,parentResponseId:r,userResponseId:o,modelName:i}=e,{sideBySideIndex:a}=t;if(null!=a&&!s)return O({conversationId:n,responseId:"streaming_in_progress_".concat(a,"_").concat(I()()),parentResponseId:o||r,sender:i})},this.processSoftStop=e=>{let{currentStreamResponse:t,responseChunk:s,startTimeMs:n}=e;return t.thinkingStartTime&&!t.thinkingEndTime&&(t.thinkingEndTime=Date.now()),t.generationTimeMs=Date.now()-n,t.state="closed",s.responseId&&(t.responseId=s.responseId),t.partial=!1,t},this.streamResponse=e=>{let t,{message:s,metadata:i,parentResponseId:d,conversationId:m,modelName:u,fileAttachmentIds:p,webpageUrls:f,toolOverrides:v,customInstructions:y,customPersonality:w,deepsearchPreset:S,systemPromptName:C,isReasoning:_,imageEditUri:M,enableRetries:T,onOptimisticUserResponse:P,onOptimisticModelResponse:E,onStart:N,onUserResponse:k,onStartExperiment:B,onCitations:A,onDisclaimer:z,onHasImage:j,onClose:W,onWke:F,onError:q}=e,V=R.t.getState(),Z=this.get(),Q=(0,r.T)(),K=new AbortController;V.idsertAbortControllerById(K,m);let J=x.w.getState().bestSubscription,X=b.p.getState().modelById[u];if(X){var $,Y;(null===($=X.tags)||void 0===$?void 0:$.includes("think"))||!_||(_=void 0),(null===(Y=X.tags)||void 0===Y?void 0:Y.includes("deepsearch"))||!S||(S=void 0)}let ee=[],et=!s;et||(t=L({conversationId:m,responseId:"optimistic_query_".concat(I()()),parentResponseId:d,message:s,fileAttachments:p,webpageUrls:f,state:"optimistic"}),Z.upsertResponse(t),P(t));let es=O({conversationId:m,responseId:"streaming_in_progress_".concat(I()()),parentResponseId:et?d:null==t?void 0:t.responseId,sender:u,state:"optimistic"},S,_);ee.push(es),Z.upsertResponse(es),E(es);let en={message:"",modelName:"",parentResponseId:"",systemPromptName:void 0,disableSearch:!1,imageAttachments:[],returnImageBytes:!1,returnRawGrokInXaiRequest:!1,fileAttachments:[],enableImageGeneration:!0,forceConcise:!1,enableImageStreaming:!0,enableSideBySide:!0,sendFinalMetadata:!0,imageGenerationCount:D,deepsearchPreset:"",isReasoning:!1,disableTextFollowUps:!0,parentResponseId:d,message:s,metadata:i,modelName:u,fileAttachments:p,webpageUrls:f,toolOverrides:v,enableSideBySide:!Q,systemPromptName:C,customInstructions:y,customPersonality:w,deepsearchPreset:S,isReasoning:_,imageEditUri:M},er=!1,eo=!1,ei=!1,ea=Date.now(),[el,ed]=H(),{log:ec,stop:em,resetTime:eu}=(0,a.YM)("streamResponse",{type:"milliseconds_per_token_bucket",subscriptionTier:J,modelId:u,modelMode:(0,o.w0)({isReasoning:_,deepsearchPreset:S}),millisecondsPerTokenList:[]}),ep=(0,a.i2)("streamCreateAndRespond",{type:"milliseconds_to_first_token_bucket",modelId:u,subscriptionTier:J,modelMode:(0,o.w0)({isReasoning:_,deepsearchPreset:S}),timeToFirstToken:0});return c.xU.chatAddResponseRaw({conversationId:m,body:en}).then(async e=>{for await(let s of(t&&(t.state="streaming",ed(t)),(ee=ee.map(e=>({...e,state:"streaming"}))).forEach(ed),N(ee),(0,a.HR)("streamResponse",{type:"send_query_stream_start",subscriptionTier:J,modelId:u,modelMode:(0,o.w0)({isReasoning:_,deepsearchPreset:S})}),eu(),h(e.raw))){if(ep(),ec(),s.error){let e=Error(s.error.message);throw F(e),e}if(!s.result)continue;let e=s.result,{userResponse:o,sideBySideIndex:l,isSoftStop:c,modelResponse:p}=e;if(null==o?void 0:o.error)throw t&&(t.state="error",t.error=o.error,ed(t)),(0,a.H)("response-store:streamResponse:userResponseChunk",o.error),Error(o.error);if(null==p?void 0:p.error)throw(ee=ee.map(e=>({...e,state:"error",error:p.error}))).forEach(ed),(0,a.H)("response-store:streamResponse:modelResponseChunk",p.error),Error(p.error);let h=this.processSideBySide({responseChunk:e,toggledExperiment:er,conversationId:m,parentResponseId:d,userResponseId:null==t?void 0:t.responseId,modelName:u});if(h&&(er=!0,ee.push(h),ed(h),B(ee.map(e=>e.responseId))),o){el(t={...o,conversationId:m,state:"closed"}),k(t),eo=!0,(ee=ee.map(e=>({...e,parentResponseId:null==t?void 0:t.responseId}))).forEach(ed);continue}let g=null!=l?l:0,f=ee[g];if(!f)return;if(el(f=this.processResponseChunk({currentStreamResponse:f,responseChunk:e,onCitations:()=>A(f),onHasImage:j,onDisclaimer:z,onFollowUpSuggestedMode:e=>{var t;null===n.IW||void 0===n.IW||n.IW.logEvent("follow_up_suggested_mode_button_shown",e.mode,{responseId:f.responseId,followUpSuggestedMode:null!==(t=e.mode)&&void 0!==t?t:"UNKNOWN"})}})),ee[g]=f,c&&(f=this.processSoftStop({currentStreamResponse:f,responseChunk:e,startTimeMs:ea}),null===n.IW||void 0===n.IW||n.IW.logEvent("generation_time_ms",f.generationTimeMs,{conversationId:m,responseId:f.responseId}),ed(f),ee.every(e=>"closed"===e.state))){var r,i;null===n.IW||void 0===n.IW||n.IW.logEvent("finished_query",null===(r=ee[0])||void 0===r?void 0:r.responseId,{conversationId:m,toggledExperiment:er.toString(),secondResponse:(null===(i=ee[1])||void 0===i?void 0:i.responseId)||"",isReasoning:_?_.toString():"",deepsearchPreset:S||""}),ee.forEach(ed),W(ee,ee.map(e=>e.responseId)),ei=!0}}if(eo||et||(this.ensureUserResponseSaved({conversationId:m,message:s,userResponse:t,onUserResponse:k,forceUpsertResponse:ed}).then(G(ee)).then(e=>ee=e).catch((0,a.n4)("response-store:useResponseStore:streamResponse")),eo=!0),!ei){let e=Error(g.EU);(0,a.H)("response-store:useResponseStore:streamResponse:closedStream",e)}(0,a.HR)("streamResponse",{type:"send_query_stream_success",subscriptionTier:J,modelId:u,modelMode:(0,o.w0)({isReasoning:_,deepsearchPreset:S})})}).catch(async e=>{let t=await (0,l.Mt)(e);(0,a.H)("response-store:streamCreateAndRespond",t),(0,l.o7)(t)&&(0,a.HR)("streamResponse",{type:"send_query_stream_error",subscriptionTier:J,modelId:u,modelMode:(0,o.w0)({isReasoning:_,deepsearchPreset:S})});let s=q(t);if(T&&s)U(u,m,ee,_,S,N,A,z,j,W,F).catch(e=>{throw(0,a.H)("response-store:streamCreateAndRespond:handleStreamError",e),e});else throw(ee=ee.map(e=>({...e,state:"error",thinkingEndTime:e.thinkingStartTime&&!e.thinkingEndTime?Date.now():e.thinkingEndTime,searchingEndTime:e.searchingStartTime&&!e.searchingEndTime?Date.now():e.searchingEndTime}))).forEach(ed),t}).finally(()=>{em()})},this.reconnectToResponse=e=>{let{inflightResponse:t,conversationId:s,modelName:r,parentResponseId:i,enableRetries:d,isReasoning:m,deepsearchPreset:u,onStart:p,onCitations:f,onDisclaimer:v,onHasImage:y,onClose:w,onWke:S,onError:b}=e,C=this.get(),_=R.t.getState(),M=new AbortController,T=x.w.getState().bestSubscription,P=!1;if(!t.responseId)throw Error("Inflight response missing responseId");let E=[],N={type:"milliseconds_per_token_bucket",subscriptionTier:T,modelId:r,modelMode:(0,o.w0)({isReasoning:m,deepsearchPreset:u}),millisecondsPerTokenList:[]},{log:k,stop:B,resetTime:A}=(0,a.YM)("reconnectToResponse",N);return c.xU.chatReconnectResponseV2Raw({responseId:t.responseId}).then(async e=>{var l,c,I,R,b,x,N,B,z,U,j,D,L,W,G,F,q,V;(0,a.HR)("reconnectToResponse",{type:"send_query_stream_reconnect_start",subscriptionTier:T,modelId:r,modelMode:(0,o.w0)({isReasoning:m,deepsearchPreset:u})}),A();let Z=h(e.raw);k();let Q=await Z.next();if(!(null===(l=Q.value)||void 0===l?void 0:l.result)||!(null===(R=Q.value)||void 0===R?void 0:null===(I=R.result)||void 0===I?void 0:null===(c=I.response)||void 0===c?void 0:c.modelResponse))throw Error("No initial state received from reconnect");let{title:K,response:J}=Q.value.result;if(K){let e=_.byId[s];_.upsertAndCacheConversation({...e,title:K.newTitle})}let X=O({...J.modelResponse,responseId:t.responseId,inflightResponseId:t.responseId,conversationId:s,parentResponseId:i,sender:r,state:"streaming",...t.createTime&&{createTime:t.createTime}});if(((null===(b=J.queryAction)||void 0===b?void 0:b.type)==="aurora"||(null===(x=J.queryAction)||void 0===x?void 0:x.type)==="flux")&&(X.hasImages=!0,y()),(null===(N=J.queryAction)||void 0===N?void 0:N.type)==="x"&&(X.hasSearches=!0),(null===(B=J.followUpSuggestions)||void 0===B?void 0:B.suggestions)&&(X.suggestions=J.followUpSuggestions.suggestions),J.followUpSuggestedMode&&(X.followUpSuggestedMode=J.followUpSuggestedMode),J.finalMetadata&&(J.finalMetadata.followUpSuggestions&&(X.suggestions=J.finalMetadata.followUpSuggestions),J.finalMetadata.disclaimer&&v(J.finalMetadata.disclaimer)),J.cachedImageGenerationResponse&&J.cachedImageGenerationResponse.imageUrl&&(X.generatedImageUrls=X.generatedImageUrls.concat([J.cachedImageGenerationResponse.imageUrl])),J.cardAttachment&&J.cardAttachment.jsonData&&(X.cardAttachmentsJson=X.cardAttachmentsJson.concat([J.cardAttachment.jsonData])),(null===(U=J.modelResponse)||void 0===U?void 0:null===(z=U.steps)||void 0===z?void 0:z.length)&&(X.searchingStartTime=new Date(X.createTime).getTime(),(null===(W=J.modelResponse)||void 0===W?void 0:W.message)&&(X.searchingEndTime=Date.now())),(null===(j=J.modelResponse)||void 0===j?void 0:j.thinkingTrace)&&(X.thinkingStartTime=new Date(X.createTime).getTime(),J.isThinking||X.thinkingEndTime||(X.thinkingEndTime=Date.now())),J.bannerMessage&&J.bannerMessage.message&&v(J.bannerMessage.message),J.disclaimer&&J.disclaimer.message&&v(J.disclaimer.message),E=[X],_.idsertAbortControllerById(M,s),C.upsertResponse(X),p(E),J.streamingImageGenerationResponse){let{imageId:e,imageUrl:t}=J.streamingImageGenerationResponse;if(e&&t){let s=null!==(G=X.streamingImageById)&&void 0!==G?G:{};J.streamingImageGenerationResponse.progress&&(X.streamingImageById={...s,[e]:{...null!==(F=s[e])&&void 0!==F?F:{},[J.streamingImageGenerationResponse.progress]:J.streamingImageGenerationResponse}}),C.setOneImageIdByUrl(e,t)}}((null===(D=X.webSearchResults)||void 0===D?void 0:D.length)||(null===(L=X.xposts)||void 0===L?void 0:L.length))&&f(X);let[$,Y]=H(),ee=new Date(X.createTime).getTime();try{for await(let e of Z){if(k(),e.error){let t=Error(e.error.message);throw S(t),t}if(!e.result)continue;let{title:t,response:r}=e.result;if(null==t?void 0:t.newTitle){let e=_.byId[s];_.upsertAndCacheConversation({...e,title:t.newTitle})}if(r){if(null===(q=r.modelResponse)||void 0===q?void 0:q.error)throw(0,a.H)("response-store:reconnectToResponse:modelResponse",r.modelResponse.error),Error(r.modelResponse.error);X={...this.processResponseChunk({currentStreamResponse:X,responseChunk:r,onCitations:()=>f(X),onHasImage:y,onDisclaimer:v,onFollowUpSuggestedMode:e=>{var t;null===n.IW||void 0===n.IW||n.IW.logEvent("follow_up_suggested_mode_button_shown",e.mode,{responseId:X.responseId,followUpSuggestedMode:null!==(t=e.mode)&&void 0!==t?t:"UNKNOWN"})}}),parentResponseId:i},$(X),E[0]=X,r.isSoftStop&&(X=this.processSoftStop({currentStreamResponse:X,responseChunk:r,startTimeMs:ee}),null===n.IW||void 0===n.IW||n.IW.logEvent("generation_time_ms",X.generationTimeMs,{conversationId:s,responseId:X.responseId}),Y(X),E.every(e=>"closed"===e.state)&&(null===n.IW||void 0===n.IW||n.IW.logEvent("finished_query",null===(V=E[0])||void 0===V?void 0:V.responseId,{conversationId:s,isReasoning:m?m.toString():"",deepsearchPreset:u||""}),E.forEach(Y),w(E,E.map(e=>e.responseId)),P=!0))}}if(!P){let e=Error(g.EU);(0,a.H)("response-store:useResponseStore:reconnectToResponse:closedStream",e)}(0,a.HR)("reconnectToResponse",{type:"send_query_stream_reconnect_success",subscriptionTier:T,modelId:r,modelMode:(0,o.w0)({isReasoning:m,deepsearchPreset:u})})}catch(e){throw d||(X={...X,state:"error",thinkingEndTime:X.thinkingStartTime&&!X.thinkingEndTime?Date.now():X.thinkingEndTime,searchingEndTime:X.searchingStartTime&&!X.searchingEndTime?Date.now():X.searchingEndTime},E[0]=X,Y(X)),e}}).catch(async e=>{let t=await (0,l.Mt)(e);(0,a.H)("response-store:reconnectToResponse",t),(0,a.HR)("reconnectToResponse",{type:"send_query_stream_reconnect_error",subscriptionTier:T,modelId:r,modelMode:(0,o.w0)({isReasoning:m,deepsearchPreset:u})});let n=b(t);if(d&&n)U(r,s,E,m,u,p,f,v,y,w,S).catch(e=>{throw(0,a.H)("response-store:reconnectToResponse:handleStreamError",e),e});else{if(0===E.length){let e=O({conversationId:s,responseId:"streaming_in_progress_".concat(I()()),parentResponseId:i,sender:r,state:"error"});E=[e],C.upsertResponse(e)}throw t}}).finally(()=>{_.removeAbortControllerById(s),B()})},this.streamCreateAndRespond=e=>{let{temporary:t,message:s,modelName:i,fileAttachmentIds:d,webpageUrls:m,systemPromptName:u,personaId:p,toolOverrides:f,isPreset:v,customInstructions:y,customPersonality:w,deepsearchPreset:S,isReasoning:C,imageEditUri:_,enableRetries:M,onOptimisticConversation:T,onOptimisticResponse:P,onStart:E,onConversation:N,onUserResponse:k,onStartExperiment:B,onCitations:A,onDisclaimer:z,onHasImage:j,onClose:W,onWke:F,onError:q,workspaceIds:V}=e,Z=this.get(),Q=R.t.getState(),K=(0,r.T)(),J=x.w.getState().bestSubscription,X=b.p.getState().modelById[i];if(X){var $,Y;(null===($=X.tags)||void 0===$?void 0:$.includes("think"))||!C||(C=void 0),(null===(Y=X.tags)||void 0===Y?void 0:Y.includes("deepsearch"))||!S||(S=void 0)}let ee="optimistic_conversation_".concat(I()()),et=(0,R.P)({conversationId:ee,personaId:p,temporary:t});Q.upsertAndCacheConversation(et),T(et);let es="optimistic_response_".concat(I()()),en=L({conversationId:et.conversationId,responseId:es,message:s,fileAttachments:d,webpageUrls:m});Z.upsertResponse(en),P(en);let er="streaming_in_progress_".concat(I()()),eo=O({conversationId:et.conversationId,responseId:er,parentResponseId:en.responseId,sender:i},S,C),ei=[eo];Z.upsertResponse(eo);let ea={systemPromptName:"",temporary:!1,message:"",modelName:"",fileAttachments:[],imageAttachments:[],disableSearch:!1,enableImageGeneration:!0,returnImageBytes:!1,returnRawGrokInXaiRequest:!1,enableImageStreaming:!0,imageGenerationCount:D,forceConcise:!1,enableSideBySide:!0,sendFinalMetadata:!0,disableTextFollowUps:!0,temporary:t,message:s,modelName:i,fileAttachments:d,webpageUrls:m,systemPromptName:null!=u?u:p,toolOverrides:f,enableSideBySide:!K,customInstructions:y,customPersonality:w,deepsearchPreset:S,isReasoning:C,imageEditUri:_,workspaceIds:V},el=new AbortController;Q.idsertAbortControllerById(el,ee);let ed=!1,ec=!1,em=!1,eu=Date.now(),[ep,eh]=H(),{log:eg,stop:ef,resetTime:eI}=(0,a.YM)("streamCreateAndRespond",{type:"milliseconds_per_token_bucket",subscriptionTier:J,modelId:i,modelMode:(0,o.w0)({isReasoning:C,deepsearchPreset:S}),millisecondsPerTokenList:[]}),ev=(0,a.i2)("streamCreateAndRespond",{type:"milliseconds_to_first_token_bucket",modelId:i,subscriptionTier:J,modelMode:(0,o.w0)({isReasoning:C,deepsearchPreset:S}),timeToFirstToken:0});return c.xU.chatCreateConversationAndRespondRaw({body:ea}).then(async e=>{for await(let s of(en={...en,state:"streaming"},ei=ei.map(e=>({...e,state:"streaming"})),eh(en),ei.forEach(eh),E(ei),(0,a.HR)("streamCreateAndRespond",{type:"send_query_stream_start",subscriptionTier:J,modelId:i,modelMode:(0,o.w0)({isReasoning:C,deepsearchPreset:S})}),eI(),h(e.raw))){if(ev(),eg(),s.error){let e=Error(s.error.message);throw F(e),e}if(!s.result)continue;let{response:e,conversation:o,title:l}=s.result;if(o){Q.removeConversation(et.conversationId),et={...et,isNew:!0,fromPreset:v,state:"closed",systemPromptName:"",...o},Q.upsertAndCacheConversation(et),Q.idsertAbortControllerById(el,et.conversationId),en={...en,conversationId:et.conversationId},ei=ei.map(e=>({...e,parentResponseId:en.responseId,conversationId:et.conversationId})),ep(en),ei.forEach(eh),N(et);continue}if((null==l?void 0:l.newTitle)&&(et={...et,title:l.newTitle},Q.upsertAndCacheConversation(et)),e){let{userResponse:s,sideBySideIndex:o,isSoftStop:l,modelResponse:d}=e;if(null==s?void 0:s.error)throw eh(en={...en,...s,state:"error"}),(0,a.H)("response-store:useResponseStore:streamResponse:userResponseChunk",s.error),Error(s.error);if(null==d?void 0:d.error)throw(ei=ei.map(e=>({...e,...d,state:"error"}))).forEach(eh),(0,a.H)("response-store:useResponseStore:streamResponse:modelResponseChunk",d.error),Error(d.error);let c=this.processSideBySide({responseChunk:e,toggledExperiment:ed,conversationId:et.conversationId,parentResponseId:en.responseId,modelName:i});if(c&&(ed=!0,ei.push(c),eh(c),B(ei.map(e=>e.responseId))),s){ep(en={...en,...s,conversationId:et.conversationId,state:"closed"}),k(en),ec=!0,(ei=ei.map(e=>({...e,parentResponseId:null==en?void 0:en.responseId}))).forEach(eh);continue}let m=null!=o?o:0,u=ei[m];if(!u)continue;if(ep(u=this.processResponseChunk({currentStreamResponse:u,responseChunk:e,onCitations:()=>A(u),onHasImage:j,onDisclaimer:z,onFollowUpSuggestedMode:e=>{var t;null===n.IW||void 0===n.IW||n.IW.logEvent("follow_up_suggested_mode_button_shown",e.mode,{responseId:u.responseId,followUpSuggestedMode:null!==(t=e.mode)&&void 0!==t?t:"UNKNOWN"})}})),ei[m]=u,l&&(u=this.processSoftStop({currentStreamResponse:u,responseChunk:e,startTimeMs:eu}),null===n.IW||void 0===n.IW||n.IW.logEvent("generation_time_ms",u.generationTimeMs,{conversationId:et.conversationId,responseId:u.responseId}),eh(u),ei.every(e=>"closed"===e.state))){var t,r;null===n.IW||void 0===n.IW||n.IW.logEvent("finished_query",null===(t=ei[0])||void 0===t?void 0:t.responseId,{conversationId:et.conversationId,toggledExperiment:ed.toString(),secondResponse:(null===(r=ei[1])||void 0===r?void 0:r.responseId)||"",isReasoning:C?C.toString():"",deepsearchPreset:S||""}),ei.forEach(eh),W(ei),em=!0}}}if(ec||(this.ensureUserResponseSaved({conversationId:et.conversationId,message:s,userResponse:en,onUserResponse:k,forceUpsertResponse:eh}).then(G(ei)).then(e=>ei=e).catch((0,a.n4)("response-store:useResponseStore:streamCreateAndRespond")),ec=!0),!em){let e=Error(g.EU);(0,a.H)("response-store:useResponseStore:streamCreateAndRespond:closedStream",e)}(0,a.HR)("streamCreateAndRespond",{type:"send_query_stream_success",subscriptionTier:J,modelId:i,modelMode:(0,o.w0)({isReasoning:C,deepsearchPreset:S})})}).catch(async e=>{let t=await (0,l.Mt)(e);(0,a.H)("response-store:useResponseStore:streamCreateAndRespond",t),(0,l.o7)(t)&&(0,a.HR)("streamCreateAndRespond",{type:"send_query_stream_error",subscriptionTier:J,modelId:i,modelMode:(0,o.w0)({isReasoning:C,deepsearchPreset:S})});let s=q(t);if(M&&s)U(i,et.conversationId,ei,C,S,E,A,z,j,W,F).catch(e=>{throw(0,a.H)("response-store:useResponseStore:streamCreateAndRespond:handleStreamError",e),e});else throw(ei=ei.map(e=>({...e,state:"error",thinkingEndTime:e.thinkingStartTime&&!e.thinkingEndTime?Date.now():e.thinkingEndTime,searchingEndTime:e.searchingStartTime&&!e.searchingEndTime?Date.now():e.searchingEndTime}))).forEach(eh),W(ei),t}).finally(()=>{ef()})},this.ensureUserResponseSaved=e=>{let{conversationId:t,message:s,userResponse:n,onUserResponse:r,forceUpsertResponse:o}=e;return this.get().addUserResponse(t,s).then(e=>(o(e),r(e),e)).catch(()=>{if(!n)return;let e={...n,state:"error"};return o(e),e})},this.abortStream=async(e,t)=>{let s=this.get(),n=R.t.getState(),r=s.byId[t];if(!r.state||!["streaming","error","reconnecting"].includes(r.state))return Promise.resolve(t);let o=n.abortControllerById[e];return o&&(o.abort(),n.removeAbortControllerById(e)),c.xU.chatStopConversationInflightResponses({conversationId:e}).then(()=>{let t={...r,responseId:r.inflightResponseId,conversationId:e,state:"closed",partial:!0,thinkingEndTime:r.thinkingStartTime&&!r.thinkingEndTime?Date.now():r.thinkingEndTime,searchingEndTime:r.searchingStartTime&&!r.searchingEndTime?Date.now():r.searchingEndTime};return s.upsertResponse(t),t.responseId}).catch(async e=>{let t=await (0,l.Mt)(e),n={...r,state:"error",thinkingEndTime:r.thinkingStartTime&&!r.thinkingEndTime?Date.now():r.thinkingEndTime,searchingEndTime:r.searchingStartTime&&!r.searchingEndTime?Date.now():r.searchingEndTime};throw s.upsertResponse(n),t})},this.addUserResponse=(e,t,s)=>c.xU.chatAddUserResponse({conversationId:e,body:{message:t,parentResponseId:s}}).then(t=>{let s=this.get(),n={...t,conversationId:e};return s.upsertResponse(n),n})}}async function U(e,t,s,r,i,d,m,u,p,g,f){let I=j.getState(),v=R.t.getState(),y=x.w.getState().bestSubscription,w=s.map(e=>({...e,state:"reconnecting"}));w.forEach(I.upsertResponse);let S=e=>new Promise(t=>setTimeout(t,e));if(t.startsWith("optimistic_conversation_")){(w=w.map(e=>({...e,state:"error"}))).forEach(I.upsertResponse);return}let b={type:"milliseconds_per_token_bucket",subscriptionTier:y,modelId:e,modelMode:(0,o.w0)({isReasoning:r,deepsearchPreset:i}),millisecondsPerTokenList:[]},{log:C,stop:_,resetTime:M}=(0,a.YM)("handleStreamError",b);(0,a.HR)("handleStreamError",{type:"send_query_stream_auto_reconnect_start",subscriptionTier:y,modelId:e,modelMode:(0,o.w0)({isReasoning:r,deepsearchPreset:i})});for(let s=1;s<=10;s++){try{let s=await I.fetchListInflightResponses(t,!0);if(s.length>0&&s[0].responseId&&w[0].parentResponseId){await c.xU.chatReconnectResponseV2Raw({responseId:s[0].responseId}).then(async l=>{var c,S,R,b,x,_,T,P,E,N,k,B,A,z,U,j,D,L;(0,a.HR)("handleStreamError",{type:"send_query_stream_reconnect_start",subscriptionTier:y,modelId:e,modelMode:(0,o.w0)({isReasoning:r,deepsearchPreset:i})}),M();let W=h(l.raw);C();let G=await W.next();if(!(null===(c=G.value)||void 0===c?void 0:c.result)||!(null===(b=G.value)||void 0===b?void 0:null===(R=b.result)||void 0===R?void 0:null===(S=R.response)||void 0===S?void 0:S.modelResponse))throw Error("No initial state received from reconnect");let{title:F,response:q}=G.value.result;if(F){let e=v.byId[t];v.upsertAndCacheConversation({...e,title:F.newTitle})}let V=O({...q.modelResponse,conversationId:t,responseId:w[0].responseId,parentResponseId:w[0].parentResponseId,sender:w[0].sender,state:"streaming",...s[0].createTime&&{createTime:s[0].createTime}});if(((null===(x=q.queryAction)||void 0===x?void 0:x.type)==="aurora"||(null===(_=q.queryAction)||void 0===_?void 0:_.type)==="flux")&&(V.hasImages=!0,p()),(null===(T=q.queryAction)||void 0===T?void 0:T.type)==="x"&&(V.hasSearches=!0),(null===(P=q.followUpSuggestions)||void 0===P?void 0:P.suggestions)&&(V.suggestions=q.followUpSuggestions.suggestions),q.followUpSuggestedMode&&(V.followUpSuggestedMode=q.followUpSuggestedMode),q.finalMetadata&&(q.finalMetadata.followUpSuggestions&&(V.suggestions=q.finalMetadata.followUpSuggestions),q.finalMetadata.disclaimer&&u(q.finalMetadata.disclaimer)),q.cachedImageGenerationResponse&&q.cachedImageGenerationResponse.imageUrl&&(V.generatedImageUrls=V.generatedImageUrls.concat([q.cachedImageGenerationResponse.imageUrl])),q.cardAttachment&&q.cardAttachment.jsonData&&(V.cardAttachmentsJson=V.cardAttachmentsJson.concat([q.cardAttachment.jsonData])),(null===(N=q.modelResponse)||void 0===N?void 0:null===(E=N.steps)||void 0===E?void 0:E.length)&&(V.searchingStartTime=new Date(V.createTime).getTime(),(null===(z=q.modelResponse)||void 0===z?void 0:z.message)&&(V.searchingEndTime=Date.now())),q.bannerMessage&&q.bannerMessage.message&&u(q.bannerMessage.message),q.disclaimer&&q.disclaimer.message&&u(q.disclaimer.message),(null===(k=q.modelResponse)||void 0===k?void 0:k.thinkingTrace)&&(V.thinkingStartTime=new Date(V.createTime).getTime(),q.isThinking||V.thinkingEndTime||(V.thinkingEndTime=Date.now())),w=[V],I.upsertResponse(V),d(w),q.streamingImageGenerationResponse){let{imageId:e,imageUrl:t}=q.streamingImageGenerationResponse;if(e&&t){let s=null!==(U=V.streamingImageById)&&void 0!==U?U:{};q.streamingImageGenerationResponse.progress&&(V.streamingImageById={...s,[e]:{...null!==(j=s[e])&&void 0!==j?j:{},[q.streamingImageGenerationResponse.progress]:q.streamingImageGenerationResponse}}),I.setOneImageIdByUrl(e,t)}}((null===(B=V.webSearchResults)||void 0===B?void 0:B.length)||(null===(A=V.xposts)||void 0===A?void 0:A.length))&&m(V);let[Z,Q]=H(),K=new Date(V.createTime).getTime();for await(let e of W){if(C(),e.error){let t=Error(e.error.message);throw f(t),t}if(!e.result)continue;let{title:s,response:o}=e.result;if(null==s?void 0:s.newTitle){let e=v.byId[t];v.upsertAndCacheConversation({...e,title:s.newTitle})}if(o){if(null===(D=o.modelResponse)||void 0===D?void 0:D.error)throw(0,a.H)("response-store:handleStreamError:modelResponse",o.modelResponse.error),Error(o.modelResponse.error);V={...I.processResponseChunk({currentStreamResponse:V,responseChunk:o,onCitations:()=>m(V),onHasImage:p,onDisclaimer:u,onFollowUpSuggestedMode:e=>{var t;null===n.IW||void 0===n.IW||n.IW.logEvent("follow_up_suggested_mode_button_shown",e.mode,{responseId:V.responseId,followUpSuggestedMode:null!==(t=e.mode)&&void 0!==t?t:"UNKNOWN"})}}),parentResponseId:w[0].parentResponseId},Z(V),w[0]=V,o.isSoftStop&&(V=I.processSoftStop({currentStreamResponse:V,responseChunk:o,startTimeMs:K}),null===n.IW||void 0===n.IW||n.IW.logEvent("generation_time_ms",V.generationTimeMs,{conversationId:t,responseId:V.responseId}),Q(V),w.every(e=>"closed"===e.state)&&(null===n.IW||void 0===n.IW||n.IW.logEvent("finished_query",null===(L=w[0])||void 0===L?void 0:L.responseId,{conversationId:t,isReasoning:r?r.toString():"",deepsearchPreset:i||""}),w.forEach(Q),g(w,w.map(e=>e.responseId))))}}("streaming"===V.state||"reconnecting"===V.state)&&(V={...V,state:"closed",thinkingEndTime:V.thinkingStartTime&&!V.thinkingEndTime?Date.now():V.thinkingEndTime,searchingEndTime:V.searchingStartTime&&!V.searchingEndTime?Date.now():V.searchingEndTime},w[0]=V,Q(V)),g(w,w.map(e=>e.responseId)),(0,a.HR)("handleStreamError",{type:"send_query_stream_auto_reconnect_success",subscriptionTier:y,modelId:e,modelMode:(0,o.w0)({isReasoning:r,deepsearchPreset:i})}),(0,a.HR)("handleStreamError",{type:"send_query_stream_reconnect_success",subscriptionTier:y,modelId:e,modelMode:(0,o.w0)({isReasoning:r,deepsearchPreset:i})})});break}(w=w.map(e=>({...e,state:"error",thinkingEndTime:e.thinkingStartTime&&!e.thinkingEndTime?Date.now():e.thinkingEndTime,searchingEndTime:e.searchingStartTime&&!e.searchingEndTime?Date.now():e.searchingEndTime}))).forEach(I.upsertResponse),(0,a.HR)("handleStreamError",{type:"send_query_stream_auto_reconnect_fail",subscriptionTier:y,modelId:e,modelMode:(0,o.w0)({isReasoning:r,deepsearchPreset:i})});break}catch(n){let t=await (0,l.Mt)(n);if(_(),(0,a.H)("response-store:handleStreamError:retryError",t),(0,l.o7)(t)&&((0,a.HR)("handleStreamError",{type:"send_query_stream_auto_reconnect_error",subscriptionTier:y,modelId:e,modelMode:(0,o.w0)({isReasoning:r,deepsearchPreset:i})}),(0,a.HR)("handleStreamError",{type:"send_query_stream_reconnect_error",subscriptionTier:y,modelId:e,modelMode:(0,o.w0)({isReasoning:r,deepsearchPreset:i})})),10===s)throw(0,a.HR)("handleStreamError",{type:"send_query_stream_auto_reconnect_fail",subscriptionTier:y,modelId:e,modelMode:(0,o.w0)({isReasoning:r,deepsearchPreset:i})}),(w=w.map(e=>({...e,state:"error"}))).forEach(I.upsertResponse),t;await S(2e3),(w=w.map(e=>({...e,state:"reconnecting"}))).forEach(I.upsertResponse)}_()}}let j=(0,d.MT)(z);(0,d.N7)(j,"byId","byConversationId",(e,t)=>{let s=Object.values(e),n=j.getState().byConversationId,r=new Set(y()(s).filter(e=>e!==t[e.responseId]||!!e.state&&"closed"!==e.state).map(e=>e.conversationId).value()),o=s.filter(e=>r.has(e.conversationId)),i=w.Z(e=>e.conversationId,o);return{...n,...y().pick(i,[...r.values()])}}),(0,d.N7)(j,"byId","nodesByConversationId",e=>{let t=j.getState().nodesByConversationId,s=!1,n={};for(let r in e){let o=e[r],i=o.conversationId,a=t[i]||[];a.some(e=>e.responseId===r)||(s||(s=!0,n={...t}),n[i]?n[i]===a&&(n[i]=[...a]):n[i]=[...a],n[i].push({responseId:r,parentResponseId:o.parentResponseId,sender:o.sender}))}return s?n:t});let D=2;function L(e){return{sender:"human",createTime:new Date().toISOString(),manual:!1,partial:!0,shared:!1,isControl:!1,query:"",queryType:"",thinkingTrace:"",webSearchResults:[],xpostIds:[],xposts:[],generatedImageUrls:[],imageAttachments:[],imageEditUris:[],fileAttachments:[],cardAttachmentsJson:[],fileUris:[],fileAttachmentsMetadata:[],state:"optimistic",parentResponseId:"",steps:[],imageEditUri:"",error:"",mediaTypes:[],webpageUrls:[],metadata:{},...e}}function O(e,t,s){let n="default"===t?Date.now():void 0,r=s?Date.now():void 0;return{message:"",createTime:new Date().toISOString(),manual:!1,partial:!0,shared:!1,isControl:!1,query:"",queryType:"",thinkingTrace:"",webSearchResults:[],xpostIds:[],xposts:[],generatedImageUrls:[],imageAttachments:[],imageEditUris:[],fileAttachments:[],cardAttachmentsJson:[],fileUris:[],fileAttachmentsMetadata:[],state:"streaming",steps:[],imageEditUri:"",error:"",mediaTypes:[],webpageUrls:[],metadata:{},deepsearchPreset:t,generatedImageHeight:void 0,generatedImageWidth:void 0,...e,thinkingStartTime:r,searchingStartTime:n}}function H(){let e,t={};return[s=>{if(!e){j.getState().upsertResponse(s),e=setTimeout(()=>{let s=Object.values(t);t={},s.length&&j.getState().appendResponses(s),e=void 0},30);return}t[s.responseId]=s},s=>{s&&(t[s.responseId]=s),clearTimeout(e);let n=Object.values(t);t={},n.length&&j.getState().appendResponses(n),e=void 0}]}function W(e){return e.thinkingStartTime||e.searchingStartTime}function G(e){return t=>(t&&e.forEach(e=>{e.parentResponseId=t.responseId}),e)}},43701:function(e,t,s){s.d(t,{F:function(){return h}});var n=s(29598),r=s(46913),o=s(4108),i=s.n(o),a=s(50536),l=s.n(a),d=s(54596);d.z.object({autoOpenSearchResults:d.z.boolean(),displayUserMessageMarkdown:d.z.boolean(),showFollowUpSuggestions:d.z.boolean(),animateQueryPlaceholder:d.z.boolean(),autoWrapLongLinesCode:d.z.boolean(),browserNotificationsEnabled:d.z.boolean(),selectedSystemPromptId:d.z.string().optional(),showConversationPreviews:d.z.boolean().optional(),hideArtifacts:d.z.boolean().optional(),autoDetectWebpageAttachments:d.z.boolean(),showActiveTabs:d.z.boolean().optional(),disableTypeahead:d.z.boolean().optional(),disableAutoScroll:d.z.boolean().optional()});let c={autoOpenSearchResults:!1,displayUserMessageMarkdown:!1,showFollowUpSuggestions:!0,animateQueryPlaceholder:!0,autoWrapLongLinesCode:!1,browserNotificationsEnabled:!1,selectedSystemPromptId:void 0,showConversationPreviews:!0,hideArtifacts:!1,autoDetectWebpageAttachments:!1,showActiveTabs:!0,disableTypeahead:!1,disableAutoScroll:!1},m={isIncognito:!1,userSettingsPromise:void 0,userSettings:{excludeFromTraining:!1,allowXPersonalization:!0,preferences:c,enableMemory:!0},selectedLanguage:void 0,showAgeVerification:!1,ageVerificationCallback:void 0},u={excludeFromTraining:!0,allowXPersonalization:!1,preferences:c,enableMemory:!1};class p{constructor(e,t){this.set=e,this.get=t,this.isIncognito=m.isIncognito,this.userSettingsPromise=m.userSettingsPromise,this.userSettings=m.userSettings,this.selectedLanguage=m.selectedLanguage,this.showAgeVerification=m.showAgeVerification,this.ageVerificationCallback=m.ageVerificationCallback,this.setIsIncognito=(0,n.f0)(this.set,"isIncognito"),this.setUserSettingsPromise=(0,n.f0)(this.set,"userSettingsPromise"),this.setUserSettings=(0,n.f0)(this.set,"userSettings"),this.setSelectedLanguage=(0,n.f0)(this.set,"selectedLanguage"),this.setShowAgeVerification=(0,n.f0)(this.set,"showAgeVerification"),this.setAgeVerificationCallback=(0,n.f0)(this.set,"setAgeVerificationCallback"),this.initializeGdprUserSettings=()=>r.pJ.settingsGetUserSettings().then(e=>{let t=this.get();(void 0===e.excludeFromTraining||void 0===e.enableMemory)&&t.fetchSetUserSettings(u).catch(console.error)}),this.fetchGetUserSettings=()=>{let e=this.get();if(e.userSettingsPromise)return e.userSettingsPromise;let t=r.pJ.settingsGetUserSettings().then(t=>{let s=l()(t,i());return{...e.userSettings,...s,preferences:g(e.userSettings.preferences,t.preferences)}});return e.setUserSettingsPromise(t),t.then(e.setUserSettings).catch(console.error),t},this.fetchSetUserSettings=e=>{let t=this.get();t.setUserSettings({...t.userSettings,...e});let s=r.pJ.settingsSetUserSettings({body:e}).then(e=>{let t=l()(e,i()),s=this.get(),n=g(s.userSettings.preferences,e.preferences);return{...s.userSettings,...t,preferences:n}});return t.setUserSettingsPromise(s),s.then(t.setUserSettings).catch(e=>{console.error(e)}),s},this.fetchSetPreference=(e,t)=>{let s=this.get();return s.fetchSetUserSettings({...s.userSettings,preferences:{...s.userSettings.preferences,[e]:t}})}}}let h=(0,n.MT)(p);function g(e,t){return d.z.object({autoOpenSearchResults:d.z.boolean().catch(e.autoOpenSearchResults),displayUserMessageMarkdown:d.z.boolean().catch(e.displayUserMessageMarkdown),showFollowUpSuggestions:d.z.boolean().catch(e.showFollowUpSuggestions),animateQueryPlaceholder:d.z.boolean().catch(e.animateQueryPlaceholder),autoWrapLongLinesCode:d.z.boolean().catch(e.autoWrapLongLinesCode),browserNotificationsEnabled:d.z.boolean().catch(e.browserNotificationsEnabled),selectedSystemPromptId:d.z.string().optional().catch(e.selectedSystemPromptId),showConversationPreviews:d.z.boolean().optional().catch(e.showConversationPreviews),hideArtifacts:d.z.boolean().optional().catch(e.hideArtifacts),autoDetectWebpageAttachments:d.z.boolean().catch(e.autoDetectWebpageAttachments),showActiveTabs:d.z.boolean().optional().catch(e.showActiveTabs),disableTypeahead:d.z.boolean().optional().catch(e.disableTypeahead),disableAutoScroll:d.z.boolean().optional().catch(e.disableAutoScroll)}).catch(e).parse(t)}(0,n.tM)(h,"userSettings","user-settings",m.userSettings,function(e){return e&&"object"==typeof e?{excludeFromTraining:m.userSettings.excludeFromTraining,allowXPersonalization:m.userSettings.allowXPersonalization,preferences:{...g(c,e.userSettings),autoOpenSearchResults:!1,disableTypeahead:!1},enableMemory:m.userSettings.enableMemory}:m.userSettings})},53781:function(e,t,s){s.d(t,{w:function(){return o}});var n=s(29598);class r{constructor(e,t){this.set=e,this.get=t,this.hasSubscriptions=!1,this.subscriptions=[],this.bestSubscription="SUBSCRIPTION_TIER_INVALID",this.isPending=!1}}let o=(0,n.MT)(r)},92127:function(e,t,s){s.d(t,{sR0:function(){return g},iNk:function(){return c},CE5:function(){return u},aNP:function(){return h}});var n=s(2899),r=s(62035),o=s(90848);function i(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,o.m6)((0,r.W)(t))}var a=s(4694),l=e=>(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 24 24",...e,children:(0,n.jsx)("path",{d:"m10.828 12 4.95 4.95-1.414 1.415L8 12l6.364-6.364 1.414 1.414z"})}),d=e=>(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 33 33",...e,children:(0,n.jsx)("path",{fill:"currentColor",d:"m13.237 21.04 11.082-8.19c.543-.4 1.32-.244 1.578.38 1.363 3.288.754 7.241-1.957 9.955-2.71 2.714-6.482 3.31-9.93 1.954l-3.765 1.745c5.401 3.697 11.96 2.782 16.059-1.324 3.251-3.255 4.258-7.692 3.317-11.693l.008.009c-1.365-5.878.336-8.227 3.82-13.031q.123-.17.247-.345l-4.585 4.59v-.014L13.234 21.044M10.95 23.031c-3.877-3.707-3.208-9.446.1-12.755 2.446-2.449 6.454-3.448 9.952-1.979L24.76 6.56c-.677-.49-1.545-1.017-2.54-1.387A12.465 12.465 0 0 0 8.675 7.901c-3.519 3.523-4.625 8.94-2.725 13.561 1.42 3.454-.907 5.898-3.251 8.364-.83.874-1.664 1.749-2.335 2.674l10.583-9.466"})});let c=e=>{let{"aria-label":t,className:s,color:r,size:o="medium"}=e,a="number"==typeof o?{height:o,width:o}:void 0;return(0,n.jsx)("span",{className:i("inline-flex items-center justify-center p-0 m-0",{"w-4 h-4":"x-small"===o,"w-5 h-5":"small"===o,"w-6 h-6":"medium"===o,"w-8 h-8":"large"===o,"w-full h-full":"fill"===o},s),"data-namespace":"@xai/icons","data-slot":"icon",style:{color:r,...a},children:(0,n.jsx)(d,{"aria-hidden":!t,"aria-label":t,className:i({"w-4 h-4":"x-small"===o,"w-5 h-5":"small"===o,"w-6 h-6":"medium"===o,"w-8 h-8":"large"===o,"w-full h-full":"fill"===o}),focusable:"false",style:{fill:"currentColor",...a}})})};c.displayName="GrokLogoIcon";var m=e=>(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor",strokeWidth:1.5,viewBox:"0 0 24 24",...e,children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.712 4.33a9 9 0 0 1 1.652 1.306c.51.51.944 1.064 1.306 1.652M16.712 4.33l-3.448 4.138m3.448-4.138a9.01 9.01 0 0 0-9.424 0M19.67 7.288l-4.138 3.448m4.138-3.448a9.01 9.01 0 0 1 0 9.424m-4.138-5.976a3.7 3.7 0 0 0-.88-1.388 3.7 3.7 0 0 0-1.388-.88m2.268 2.268a3.77 3.77 0 0 1 0 2.528m-2.268-4.796a3.77 3.77 0 0 0-2.528 0m4.796 4.796a3.75 3.75 0 0 1-.88 1.388 3.7 3.7 0 0 1-1.388.88m2.268-2.268 4.138 3.448m0 0a9 9 0 0 1-1.306 1.652c-.51.51-1.064.944-1.652 1.306m0 0-3.448-4.138m3.448 4.138a9.01 9.01 0 0 1-9.424 0m5.976-4.138a3.77 3.77 0 0 1-2.528 0m0 0a3.7 3.7 0 0 1-1.388-.88 3.7 3.7 0 0 1-.88-1.388m2.268 2.268L7.288 19.67m0 0a9 9 0 0 1-1.652-1.306 9 9 0 0 1-1.306-1.652m0 0 4.138-3.448M4.33 16.712a9.01 9.01 0 0 1 0-9.424m4.138 5.976a3.77 3.77 0 0 1 0-2.528m0 0c.181-.506.475-.982.88-1.388a3.7 3.7 0 0 1 1.388-.88m-2.268 2.268L4.33 7.288m6.406 1.18L7.288 4.33m0 0a9 9 0 0 0-1.652 1.306A9 9 0 0 0 4.33 7.288"})});let u=e=>{let{"aria-label":t,className:s,color:r,size:o="medium"}=e,a="number"==typeof o?{height:o,width:o}:void 0;return(0,n.jsx)("span",{className:i("inline-flex items-center justify-center p-0 m-0",{"w-4 h-4":"x-small"===o,"w-5 h-5":"small"===o,"w-6 h-6":"medium"===o,"w-8 h-8":"large"===o,"w-full h-full":"fill"===o},s),"data-namespace":"@xai/icons","data-slot":"icon",style:{color:r,...a},children:(0,n.jsx)(m,{"aria-hidden":!t,"aria-label":t,className:i({"w-4 h-4":"x-small"===o,"w-5 h-5":"small"===o,"w-6 h-6":"medium"===o,"w-8 h-8":"large"===o,"w-full h-full":"fill"===o}),focusable:"false",style:{fill:"currentColor",...a}})})};u.displayName="SupportIcon";var p=e=>(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 24 24",...e,children:(0,n.jsx)("path",{d:"M12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10-4.477 10-10 10m0-2a8 8 0 1 0 0-16 8 8 0 0 0 0 16m-1-5h2v2h-2zm0-8h2v6h-2z"})});let h=e=>{let{"aria-label":t,className:s,color:r,size:o="medium"}=e,a="number"==typeof o?{height:o,width:o}:void 0;return(0,n.jsx)("span",{className:i("inline-flex items-center justify-center p-0 m-0",{"w-4 h-4":"x-small"===o,"w-5 h-5":"small"===o,"w-6 h-6":"medium"===o,"w-8 h-8":"large"===o,"w-full h-full":"fill"===o},s),"data-namespace":"@xai/icons","data-slot":"icon",style:{color:r,...a},children:(0,n.jsx)(p,{"aria-hidden":!t,"aria-label":t,className:i({"w-4 h-4":"x-small"===o,"w-5 h-5":"small"===o,"w-6 h-6":"medium"===o,"w-8 h-8":"large"===o,"w-full h-full":"fill"===o}),focusable:"false",style:{fill:"currentColor",...a}})})};h.displayName="WarningIcon";let g=e=>{let{"aria-label":t,className:s,color:r,disabled:o,size:d="medium",type:c="button",...m}=e,u=(0,a.useRef)(null),p=null!=o?!!o:!t,h="number"==typeof d?{height:d,width:d}:void 0;return(0,n.jsx)("button",{...m,type:c,"aria-disabled":o,"aria-hidden":p,"aria-label":t,className:i("inline-flex items-center justify-center border-none bg-transparent hover:bg-muted/50 rounded-full p-0 m-0 appearance-none disabled:opacity-30",{"w-4 h-4":"x-small"===d,"w-5 h-5":"small"===d,"w-6 h-6":"medium"===d,"w-8 h-8":"large"===d,"w-full h-full":"fill"===d},s),"data-namespace":"@xai/icons","data-slot":"icon",disabled:o,ref:u,style:{color:r,...h},children:(0,n.jsx)(l,{className:i({"w-[1.125rem] h-[1.125rem]":"medium"===d,"w-[1.375rem] h-[1.375rem]":"large"===d,"w-3.5 h-3.5":"x-small"===d,"w-4 h-4":"small"===d,"w-full h-full":"fill"===d}),focusable:"false",style:{fill:"currentColor",...h}})})};g.displayName="ArrowLeftIconButton"}}]);